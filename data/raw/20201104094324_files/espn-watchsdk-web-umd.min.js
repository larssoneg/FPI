var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).WatchSDK={})}(this,(function(t){"use strict";
/** @preserve ESPN WatchSDK 3.1.13 */function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(n,!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}function p(t,e,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=h(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function f(t,e,n,i){return(f="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var a,o=h(t,e);if(o){if((a=Object.getOwnPropertyDescriptor(o,e)).set)return a.set.call(i,n),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(i,e)){if(!a.writable)return!1;a.value=n,Object.defineProperty(i,e,a)}else r(i,e,n);return!0})(t,e,n,i)}function v(t,e,n,i,r){if(!f(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function g(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function m(t,e){return t(e={exports:{}},e.exports),e.exports}var b=m((function(t){var e,n;e=y,n=function(){var t=function(){},e="undefined",n=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function r(t,e){var n=t[e];if("function"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(e){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(e,n){for(var r=0;r<i.length;r++){var a=i[r];this[a]=r<e?t:this.methodFactory(a,e,n)}this.log=this.debug}function s(t,n,i){return function(){typeof console!==e&&(o.call(this,n,i),this[t].apply(this,arguments))}}function u(i,o,u){return function(i){return"debug"===i&&(i="log"),typeof console!==e&&("trace"===i&&n?a:void 0!==console[i]?r(console,i):void 0!==console.log?r(console,"log"):t)}(i)||s.apply(this,arguments)}function c(t,n,r){var a,s=this,c="loglevel";function d(){var t;if(typeof window!==e){try{t=window.localStorage[c]}catch(t){}if(typeof t===e)try{var n=window.document.cookie,i=n.indexOf(encodeURIComponent(c)+"=");-1!==i&&(t=/^([^;]+)/.exec(n.slice(i))[1])}catch(t){}return void 0===s.levels[t]&&(t=void 0),t}}t&&(c+=":"+t),s.name=t,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=r||u,s.getLevel=function(){return a},s.setLevel=function(n,r){if("string"==typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(a=n,!1!==r&&function(t){var n=(i[t]||"silent").toUpperCase();if(typeof window!==e){try{return void(window.localStorage[c]=n)}catch(t){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(t){}}}(n),o.call(s,n,t),typeof console===e&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(t){d()||s.setLevel(t,!1)},s.enableAll=function(t){s.setLevel(s.levels.TRACE,t)},s.disableAll=function(t){s.setLevel(s.levels.SILENT,t)};var l=d();null==l&&(l=null==n?"WARN":n),s.setLevel(l,!1)}var d=new c,l={};d.getLogger=function(t){if("string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=l[t];return e||(e=l[t]=new c(t,d.getLevel(),d.methodFactory)),e};var h=typeof window!==e?window.log:void 0;return d.noConflict=function(){return typeof window!==e&&window.log===d&&(window.log=h),d},d.getLoggers=function(){return l},d},t.exports?t.exports=n():e.log=n()})),P=Object.freeze({__proto__:null,default:b,__moduleExports:b}),w=m((function(t,e){
/*!
   * @overview es6-promise - a tiny implementation of Promises/A+.
   * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
   * @license   Licensed under MIT license
   *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
   * @version   v4.2.8+1e68dce6
   */
t.exports=function(){function t(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,i=void 0,r=void 0,a=function(t,e){h[n]=t,h[n+1]=e,2===(n+=2)&&(r?r(p):b())},o="undefined"!=typeof window?window:void 0,s=o||{},u=s.MutationObserver||s.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function l(){var t=setTimeout;return function(){return t(p,1)}}var h=new Array(1e3);function p(){for(var t=0;t<n;t+=2)(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0;n=0}var f,v,g,m,b=void 0;function P(t,e){var n=this,i=new this.constructor(A);void 0===i[I]&&L(i);var r=n._state;if(r){var o=arguments[r-1];a((function(){return U(r,i,o,n._result)}))}else M(n,i,t,e);return i}function w(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(A);return E(e,t),e}c?b=function(){return process.nextTick(p)}:u?(v=0,g=new u(p),m=document.createTextNode(""),g.observe(m,{characterData:!0}),b=function(){m.data=v=++v%2}):d?((f=new MessageChannel).port1.onmessage=p,b=function(){return f.port2.postMessage(0)}):b=void 0===o?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(p)}:l()}catch(t){return l()}}():l();var I=Math.random().toString(36).substring(2);function A(){}var _=void 0,k=1,S=2;function T(e,n,i){n.constructor===e.constructor&&i===P&&n.constructor.resolve===w?function(t,e){e._state===k?O(t,e._result):e._state===S?D(t,e._result):M(e,void 0,(function(e){return E(t,e)}),(function(e){return D(t,e)}))}(e,n):void 0===i?O(e,n):t(i)?function(t,e,n){a((function(t){var i=!1,r=function(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}(n,e,(function(n){i||(i=!0,e!==n?E(t,n):O(t,n))}),(function(e){i||(i=!0,D(t,e))}),t._label);!i&&r&&(i=!0,D(t,r))}),t)}(e,n,i):O(e,n)}function E(t,e){if(t===e)D(t,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=e),null===i||"object"!==r&&"function"!==r)O(t,e);else{var n=void 0;try{n=e.then}catch(e){return void D(t,e)}T(t,e,n)}var i,r}function C(t){t._onerror&&t._onerror(t._result),N(t)}function O(t,e){t._state===_&&(t._result=e,t._state=k,0!==t._subscribers.length&&a(N,t))}function D(t,e){t._state===_&&(t._state=S,t._result=e,a(C,t))}function M(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+k]=n,r[o+S]=i,0===o&&t._state&&a(N,t)}function N(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,r=void 0,a=t._result,o=0;o<e.length;o+=3)i=e[o],r=e[o+n],i?U(n,i,r,a):r(a);t._subscribers.length=0}}function U(e,n,i,r){var a=t(i),o=void 0,s=void 0,u=!0;if(a){try{o=i(r)}catch(t){u=!1,s=t}if(n===o)return void D(n,new TypeError("A promises callback cannot return that same promise."))}else o=r;n._state!==_||(a&&u?E(n,o):!1===u?D(n,s):e===k?O(n,o):e===S&&D(n,o))}var j=0;function L(t){t[I]=j++,t._state=void 0,t._result=void 0,t._subscribers=[]}var R=function(){function t(t,n){this._instanceConstructor=t,this.promise=new t(A),this.promise[I]||L(this.promise),e(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&O(this.promise,this._result))):D(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===_&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===w){var r=void 0,a=void 0,o=!1;try{r=t.then}catch(t){o=!0,a=t}if(r===P&&t._state!==_)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(n===x){var s=new n(A);o?D(s,a):T(s,t,r),this._willSettleAt(s,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(i(t),e)},t.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===_&&(this._remaining--,t===S?D(i,n):this._result[e]=n),0===this._remaining&&O(i,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;M(t,void 0,(function(t){return n._settledAt(k,e,t)}),(function(t){return n._settledAt(S,e,t)}))},t}(),x=function(){function e(t){this[I]=j++,this._result=this._state=void 0,this._subscribers=[],A!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){E(t,e)}),(function(e){D(t,e)}))}catch(e){D(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):this.then(e,e)},e}();return x.prototype.then=P,x.all=function(t){return new R(this,t).promise},x.race=function(t){var n=this;return e(t)?new n((function(e,i){for(var r=t.length,a=0;a<r;a++)n.resolve(t[a]).then(e,i)})):new n((function(t,e){return e(new TypeError("You must pass an array to race."))}))},x.resolve=w,x.reject=function(t){var e=new this(A);return D(e,t),e},x._setScheduler=function(t){r=t},x._setAsap=function(t){a=t},x._asap=a,x.polyfill=function(){var t=void 0;if(void 0!==y)t=y;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=x},x.Promise=x,x}()})),I=function(t){return 200===t.status||201===t.status||202===t.status||204===t.status||0===t.status&&t.responseText&&""!==t.responseText};function A(t,e){return e=e||{},new w((function(n,i){var r=new XMLHttpRequest;for(var a in r.open(e.method||"get",t,!0),e.headers)r.setRequestHeader(a,e.headers[a]);function o(){var t,e=[],n=[],i={};return r.getAllResponseHeaders().replace(/^(.*?):\s*?([\s\S]*?)$/gm,(function(r,a,o){e.push(a=a.toLowerCase()),n.push([a,o]),t=i[a],i[a]=t?"".concat(t,",").concat(o):o})),{ok:2==(r.status/100|0),status:r.status,statusText:r.statusText,url:r.responseURL,clone:o,text:function(){return w.resolve(r.responseText)},json:function(){return w.resolve(r.responseText).then((function(t){try{return JSON.parse(t)}catch(t){return{}}}))},blob:function(){return w.resolve(new Blob([r.response]))},headers:{keys:function(){return e},entries:function(){return n},get:function(t){return i[t.toLowerCase()]},has:function(t){return t.toLowerCase()in i}}}}r.withCredentials="include"===e.credentials,r.onload=function(){n(o())},r.onreadystatechange=function(){try{4===r.readyState&&(I(r)?n(o()):i(o()))}catch(t){r.abort()}},r.onerror=i,r.send(e.body)}))}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var _=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function k(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var S=function(){return(S=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function T(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function E(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function C(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}function O(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(C(arguments[e]));return t}var D=m((function(t,e){var n;t.exports=(n=n||function(t,e){var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var o=n[a>>>2]>>>24-a%4*8&255;e[i+a>>>2]|=o<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)e[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n,i=[],r=function(e){e=e;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(e=18e3*(65535&e)+(e>>16)&i)&i;return r/=4294967296,(r+=.5)*(t.random()>.5?1:-1)}},a=0;a<e;a+=4){var s=r(4294967296*(n||t.random()));n=987654071*s(),i.push(4294967296*s()|0)}return new o.init(i,e)}}),s=i.enc={},u=s.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new o.init(n,e/2)}},c=s.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new o.init(n,e)}},d=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},l=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=d.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,s=r/(4*a),u=(s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0))*a,c=t.min(4*u,r);if(u){for(var d=0;d<u;d+=a)this._doProcessBlock(i,d);var l=i.splice(0,u);n.sigBytes-=c}return new o.init(l,c)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),h=(r.Hasher=l.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new h.HMAC.init(t,n).finalize(e)}}}),i.algo={});return i}(Math),n)})),M=m((function(t,e){var n,i,r;t.exports=(i=(n=r=D).lib.WordArray,n.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],a=0;a<n;a+=3)for(var o=(e[a>>>2]>>>24-a%4*8&255)<<16|(e[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|e[a+2>>>2]>>>24-(a+2)%4*8&255,s=0;s<4&&a+.75*s<n;s++)r.push(i.charAt(o>>>6*(3-s)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(t){var e=t.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var o=n.charAt(64);if(o){var s=t.indexOf(o);-1!==s&&(e=s)}return function(t,e,n){for(var r=[],a=0,o=0;o<e;o++)if(o%4){var s=n[t.charCodeAt(o-1)]<<o%4*2,u=n[t.charCodeAt(o)]>>>6-o%4*2;r[a>>>2]|=(s|u)<<24-a%4*8,a++}return i.create(r,a)}(t,e,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)})),N=m((function(t,e){t.exports=D.enc.Utf8})),U="https://web.archive.org/web/20201104011859/https://streams.adobeprimetime.com/v2",j="live",L="vod",R="accountId",x="applicationId",z="applicationPlatform",H="channel",B="contentType",V="contractType",F="deviceModel",K="hba",G="mobileDevice",J="programmerName",q=function(t){var e=t+":";return{Authorization:"Basic "+M.stringify(N.parse(e)),Accept:"application/json"}},W=function(){function t(t,e,n,i,r){e&&n&&i&&(this.programmer=t,this.applicationId=e,this.identityProvider=n,this.subject=i,this.metadata=r||{},this.serviceUrl=U,this.requestHeaders=q(e),this.heartbeatIntervalId=null,this.messages={})}return t.fetchMetadataKeys=function(t,e){return T(this,void 0,void 0,(function(){var n,i,r,a;return E(this,(function(o){switch(o.label){case 0:n=e+"/metadata",i=q(t),r={method:"GET",headers:i},o.label=1;case 1:return o.trys.push([1,4,,5]),[4,A(n,r)];case 2:return[4,o.sent().json()];case 3:return function(t,e){var n="AdobeCM.metadata."+e;localStorage.setItem(n,JSON.stringify(t))}(o.sent(),t),[2,!0];case 4:return a=o.sent(),console.error("fetchMetadataKeys error: "+a),[2,!1];case 5:return[2]}}))}))},Object.defineProperty(t.prototype,"metadataKeys",{get:function(){return function(t){var e="AdobeCM.metadata."+t,n=[];try{n=JSON.parse(localStorage.getItem(e))||[]}catch(t){}return n}(this.applicationId)},enumerable:!0,configurable:!0}),t.prototype.start=function(){return T(this,void 0,void 0,(function(){var t;return E(this,(function(e){switch(e.label){case 0:return[4,this.createSession()];case 1:return(t=e.sent())?(this.scheduleHeartbeat(),[2,t]):[2,null]}}))}))},t.prototype.startWithSession=function(t){this.sessionId=t,this.scheduleHeartbeat()},t.prototype.stop=function(){this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=null),this.terminateSession()},t.prototype.createSession=function(t){return void 0===t&&(t=[]),T(this,void 0,void 0,(function(){var e,n,i,r,a,o,s,u,c;return E(this,(function(d){switch(d.label){case 0:b.debug("AdobeConcurrencyMonitorV2.createSession"),e=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject,n=S({"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},this.requestHeaders),t.length>0&&(n["X-Terminate"]=t.join(",")),i=this.getMetadata(),r=Object.keys(i).map((function(t){return t+"="+encodeURIComponent(i[t])})).join("&"),a={method:"POST",headers:n,body:r},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,A(e,a)];case 2:if(o=d.sent(),!((s=o.status)>=200&&s<300))throw o;return u=o.headers.get("location").trim(),this.sessionId=u,b.debug("AdobeConcurrencyMonitorV2.createSession sessionId:",u),[2,u];case 3:return c=d.sent(),b.error("AdobeConcurrencyMonitorV2.createSession error: "+c),this.handleError(c,null),[2,null];case 4:return[2]}}))}))},t.prototype.scheduleHeartbeat=function(){var t=this;b.debug("AdobeConcurrencyMonitorV2.scheduleHeartbeat"),this.heartbeatIntervalId=window.setTimeout((function(){t.heartbeat()}),45e3)},t.prototype.heartbeat=function(){var t=this,e=this.sessionId;e&&(b.debug("AdobeConcurrencyMonitorV2.heartbeat",e),A(this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+e,{method:"POST",headers:this.requestHeaders}).then((function(e){var n=e.status;if(!(n>=200&&n<300))throw e;t.scheduleHeartbeat()})).catch((function(e){return t.handleError(e,t.onError)})))},t.prototype.terminateSession=function(){var t=this.sessionId;t&&A(this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+t,{method:"DELETE",headers:this.requestHeaders}).then((function(t){var e=t.status;if(!(e>=200&&e<300))throw t}))},t.prototype.handleError=function(e,n){var i=this;switch(b.debug("AdobeConcurrencyMonitorV2.handleError",e),e.status){case 400:return e.json().then((function(e){if(!!(e.obligations||[]).find((function(t){return"logout"===t.action})))return t.fetchMetadataKeys(i.applicationId,i.serviceUrl).then((function(){var t=i.metadata;if(Object.keys(t).length>=i.metadataKeys.length)return i.start()}))}));case 409:return e.json().then((function(t){var r=(t.associatedAdvice||[]).find((function(t){return"rule-violation"===t.type}));if(r){var a=r.message,o=i.messages[a]||a,s=new Error(o),u=!!(t.obligations||[]).find((function(t){return"logout"===t.action}));if(b.debug("AdobeConcurrencyMonitorV2.handleError",e.status,s,u),!n)throw s;n(s,u)}}));case 410:return e.json().then((function(t){if(!t)return i.start();var r=(t.associatedAdvice||[]).find((function(t){return"remote-termination"===t.type}));if(r){var a=r.message,o=i.messages[a]||a,s=new Error(o),u=!!t.obligations.find((function(t){return"logout"===t.action}));if(b.debug("AdobeConcurrencyMonitorV2.handleError",e.status,s,u),!n)throw s;n(s,u)}}))}},t.prototype.getMetadata=function(){var t=this;return this.metadataKeys.reduce((function(e,n){return e[n]=t.metadata[n],e}),{})},t.prototype.onError=function(t,e){b.debug("AdobeConcurrencyMonitor.onError"),b.debug("error: "+t),b.debug("shouldLogout: "+e)},t}();function Y(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,Y)}function Q(){}Q.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var i=this;function r(){i.off(t,r),e.apply(n,arguments)}return r._=e,this.on(t,r,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var a=0,o=i.length;a<o;a++)i[a].fn!==e&&i[a].fn._!==e&&r.push(i[a]);return r.length?n[t]=r:delete n[t],this}};var X=Q,Z=Q;X.TinyEmitter=Z;var $=function(t){function n(){return e(this,n),l(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"getConfiguration",value:function(t,e){return{}}}]),n}(X),tt="BootstrapManager.bootstrap",et=!1;try{et="caches"in self}catch(t){}var nt={updated:"UPDATED"},it=function(t){function n(){var t;if(e(this,n),(t=l(this,c(n).call(this)))._bootstrap=null,t._cache=null,et)caches.open("watchsdk-cache").then((function(e){t._cache=e,e&&e.match("bootstrap").then((function(t){return t&&t.json()})).then((function(e){e&&null===t._bootstrap&&(t._bootstrap=e)}))}));else{var i=localStorage.getItem(tt);try{var r=JSON.parse(N.stringify(M.parse(i)));t._bootstrap=r}catch(e){try{var a=JSON.parse(i);t._bootstrap=a}catch(t){}}}return t}return u(n,t),i(n,[{key:"update",value:function(t){var e=this;return A(t).then((function(t){return t.json()})).then((function(t){if(b.debug("BootstrapManager.update() ".concat(JSON.stringify(t,null,2))),e._bootstrap=t,e._cache&&e._cache.put("bootstrap",new Response(JSON.stringify(t),{headers:{"Content-Type":"application/json"}})),!et){var n=M.stringify(N.parse(JSON.stringify(t)));localStorage.setItem(tt,n)}e.emit(nt.updated,e._bootstrap)}))}},{key:"getConfiguration",value:function(t,e){var n=this.bootstrap,i=n&&n[t]||{};if(e){var a=Object.keys(i).filter((function(t){return-1!==Object.keys(e).indexOf(t)})).reduce((function(t,e){return s({},t,r({},e,i[e]))}),{});i=s({},e,{},a)}return i}},{key:"bootstrap",get:function(){return this._bootstrap}}]),n}($);it.shared=new it;var rt,at=new function t(n,i,r,a){e(this,t),this.enabled=n,this.serviceUrl=i,this.applicationId=null,this.applications=r,this.messages=a}(!0,"https://web.archive.org/web/20201104011859/https://streams.adobeprimetime.com/v2",{chromecast:{applicationId:"4c6fd925-7d06-4dbd-9edb-720962619882"},appletv:{applicationId:"eebe77ee-3064-4b4a-b89b-fef248a474be"},samsungtv:{applicationId:"0e3d9128-cdf7-4464-9952-55434ead1e8e"},web:{applicationId:"3bfbbbdf-be8e-40be-9540-97a73469ada2"},ps4:{applicationId:"41e7539c-d38f-4c20-856a-8db2de060287"}},{}),ot="https://web.archive.org/web/20201104011859/https://a.espncdn.com/connected-devices/app-configurations/espn-js-sdk-2.0.config.json",st={appletv:"dniqxcl2cnjuzgl04vuek1mm",chromecast:"1q86jvqka85r41w7daunp5ipgb",ps4:"kbjoe0y9awb41guc2nzey04ji",samsungtv:"csrf56z30hke1aozrm00ad50g",web:"uiqlbgzdwuru14v627vdusswb"},ut=function(t){var e=it.shared.getConfiguration("adobeCM",at);if(!1!==e.enabled){var n=e.applications&&e.applications[t],i=e.applicationId||n&&n.applicationId,r=e.serviceUrl;W.fetchMetadataKeys(i,r)}},ct=function(){function t(){e(this,t)}return i(t,null,[{key:"init",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.partner=e,t.platform=n,t.version=i,t.deviceId=t.deviceId||Y(),b.debug(this.toString());var a=r&&r.bootstrapUrl||ot;it.shared.update(a).finally((function(){ut(t.platform)}))}},{key:"toString",value:function(){return"<WatchSDK.Client partner:".concat(t.partner,", platform:").concat(t.platform,", deviceId:").concat(t.deviceId,">")}},{key:"partner",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.partner")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.partner",t)}},{key:"platform",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.platform")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.platform",t)}},{key:"version",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.version")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.version",t)}},{key:"deviceId",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.deviceId")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.deviceId",t)}},{key:"apiKey",get:function(){return it.shared.getConfiguration("shield",{apiKeys:st}).apiKeys[t.platform]||"mbmhfdgflphg14wss50rny3ct"}}]),t}();!function(t){t[t.all=0]="all",t[t.linearPlayback=1]="linearPlayback"}(rt||(rt={}));var dt,lt=rt;!function(t){t.linear="linear",t.event="event"}(dt||(dt={}));var ht,pt=dt;!function(t){t.stitchedPreroll="stitchedPreroll"}(ht||(ht={}));var ft,vt=ht;!function(t){t.live="live",t.onDemand="onDemand"}(ft||(ft={}));var gt,yt=ft;!function(t){t.nielsen="nielsen",t.comscore="comscore",t.conviva="conviva",t.heartbeats="heartbeats"}(gt||(gt={}));var mt,bt=gt;!function(t){t.shortform="shortform",t.longform="longform"}(mt||(mt={}));var Pt,wt=mt;!function(t){t.audio="audio",t.video="video"}(Pt||(Pt={}));var It,At=Pt;!function(t){t.pluto="pluto",t.graphQL="graphQL",t.cfa="cfa"}(It||(It={}));var _t,kt=It;!function(t){t.open="OPEN",t.direct="DIRECT",t.mvpd="MVPD",t.isp="ISP",t.none="NONE"}(_t||(_t={}));var St,Tt=_t;!function(t){t.none="none",t.startSession="startSession",t.bam="bam",t.shield="shield",t.entitlement="entitlement"}(St||(St={}));var Et=St,Ct=function(){function t(t,e,n,i,r,a,o){this.url=t,this.type=e,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=o,this.variant=null}return t.fromObject=function(e){if(!e)return null;var n=e.url,i=e.type,r=e.hasEspnId3Heartbeats,a=e.hasNielsenWatermarks,o=e.hasPassThroughAds,s=e.commercialReplacement,u=e.startSessionUrl;return new t(n,Et[i],r,a,o,s,u)},t}(),Ot=function(){function t(t,e,n,i){this.id=t,this.type=e,this.name=n,this.resource=i}return t.fromObject=function(e){if(!e)return null;var n=pt[e.type];return new t(e.id,n,e.name,e.resource)},t}(),Dt=function(){function t(t){this.url=t}return t.fromObject=function(e){return e&&e.url?new t(e.url):null},t}(),Mt=function(){function t(t){this.name=t}return Object.defineProperty(t.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!0,configurable:!0}),t.fromObject=function(e){return e?new t(e.name):null},t}(),Nt=function(){function t(t,e,n,i,r){this.id=t,this.title=e,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=lt.all,this.images=[],this.type=At.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null}return Object.defineProperty(t.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===pt.linear},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLive",{get:function(){return this.streamType===yt.live},enumerable:!0,configurable:!0}),t.fromObject=function(e){var n=Ct.fromObject(e.source),i=new t(e.id,e.title,e.duration,e.language,n);return i.authenticationTypes=e.authenticationTypes,i.description=e.description,i.images=(e.images||[]).map((function(t){return Dt.fromObject(t)})),i.mrss=e.mrss,i.network=Ot.fromObject(e.network),i.seekInSeconds=e.seekInSeconds,i.streamType=yt[e.streamType],i.supportedMediaCommands=e.supportedMediaCommands,i.tracking=e.tracking,i.references=e.references,i.packages=(e.packages||[]).map((function(t){return Mt.fromObject(t)})),i.type=At[e.type],i.entityType=wt[e.entityType],i.isSyndicatable=e.isSyndicatable,i.brand=e.brand,i},t.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},t}();var Ut,jt=function(){function t(t){var e=function(t){var e=t.split("?")[1],n={};if(e)for(var i=e.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(t);if(this.original=t,this.id=e.videoID||e.playID||e.clip||e.externalId,t.match("sportscenter")){this.gameId=e.playGameID,this.channel=e.playChannel,this.simulcastAiringId=e.simulcastAiringId;var n=parseInt(e.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=e.eventId}this.source=e["x-source"],e.videoID?this.entityType=wt.shortform:this.entityType=wt.longform,this.type=At.video}return t.prototype.toString=function(t){return t==kt.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},t.identifierStringForNetwork=function(t,e){return e==kt.graphQL?"sportscenter://x-callback-url/showWatchStream?playChannel="+t:"natgeo://playVideo?videoID="+t},t}();function Lt(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function Rt(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function xt(t,e,n,i){if(!e)return{};var r,a,o,s=null;t===Ut.natGeo?s=function(t){if(!t)return{};var e={},n=t.id,i=t.title,r=t.duration;return e.c_video_id_code=n,e.c_a_media_airdate="unknown",e.c_a_media_daypart="daytime",e.c_a_media_digitaldate="unknown",e.c_a_media_episode="none",e.c_a_media_feed="natgeo live",e.c_a_media_format="vod",e.c_a_media_genre="none",e.c_a_media_network="natgeo",e.c_a_media_originator="natgeo",e.c_a_media_pass_auth="none",e.c_a_media_pass_mvpd="none",e.c_a_media_rating="none",e.c_a_media_season="none",e.c_a_media_show=i,e.c_a_media_streamtype=Pt.video,e.c_a_media_length=r,e}(e):(r=function(t,e,n){if(!t)return{};var i=t.duration,r=t.id,a=t.league,o=t.name,s=t.network,u=t.program,c=t.sport,d=t.startDateTime,l=t.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=l&&l.trackingId||r,p.program=o,p.title=o,p.clientid="us-600140",e===wt.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(u&&u.code||"")+(c&&c.code||""),d){var f=new Date(d);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=l&&l.nielsenCrossId1||"",p.crossId2=s&&s.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return e===wt.shortform&&(p.accmethod="1",p.length=""+i,p.segA=o,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(e,n,i),a=function(t,e){if(!t)return{};var n=t.id,i=t.duration,r=t.name,a=t.league,o=t.startDateTime,s=t.network,u=t.sport,c=t.status,d=t.tracking,l={};if(e===wt.longform)l.ns_st_cl=0,l.ns_st_ct="vc",!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?(l.ns_st_cl=i,l.ns_st_ct="vc12",l.ns_st_pr="VOD",l.ns_st_ep=r):(l.ns_st_cl=0,l.ns_st_ct="vc13",l.ns_st_pr=r,l.ns_st_ep="*null"),l.c3="WATCHESPNLIVE",l.c6=a&&a.name?a||"No league":u&&u.code||"No Sport";else{l.ns_st_cl=i,l.ns_st_ct="vc11",l.ns_st_pr="VOD",l.ns_st_ep=r;var h=d||{},p=h.sportName,f=h.leagueName;l.c3="vod",l.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(l.ns_st_ti="*null",l.ns_st_ia="*null",l.ns_st_ce="*null",l.ns_st_ci=n,o){var v=new Date(o);l.ns_st_ddt=v.toDateString(),l.ns_st_tdt=v.toDateString()}return l.ns_st_st=s?s.id:"*null",l.ns_st_en="*null",l.ns_st_cn="1",l.ns_st_pn="1",l.ns_st_tp="1",l.ns_st_pu="ESPN",l.ns_st_cu="none",l.ns_st_ad="0",l.ns_st_ge="Sports",l}(e,n),o=function(t,e,n){if(!t)return{};var i=t.name,r=t.id,a=t.airingId,o=t.eventId,s=t.duration,u=t.network,c=t.status,d=i+" - "+r;u&&u.type===pt.linear&&(d=u.id);var l={};return l.contentId=r,a&&(l.airingId=a),o&&(l.eventId=""+o,l.eventName=i),u&&(l.network=u.id),e===wt.shortform?l.assetType="clip":!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?l.assetType="vod":l.assetType="live",l.appBrand=Ut.espn,{assetName:d,duration:s,streamUrl:n&&n.url,custom:l}}(e,n,i),s=function(t,e){if(!t)return{};var n=t.duration,i=t.airingId,r=t.network,a=t.status,o=t.sport,s=t.league,u=t.program,c=t.startDateTime,d=t.tracking,l=t.originalPublishDate,h=t.expirationDate,p=t.lastModifiedDate,f=t.ad,v=t.coverageType,g={};if(g.ContentDuration=n,e===wt.longform){if(g.isFullEpisode="y",i&&(g.AiringID=i),r&&(g.NetworkName=r.id,g.Channel=r.id),a&&(g.VideoType="REPLAY"===a?"replay":"live"),g.Sport=o&&o.name||"Not Applicable",g.SportCode=o&&o.code||"Not Applicable",g.League=s&&s.name||"Not Applicable",u&&u.code&&u.categoryCode?g.ProgramCode=u.categoryCode+u.code:g.ProgramCode="Not Applicable",g.IsStudio=u&&u.isStudio||"Not Applicable",c){var y=new Date(c);g.AirDate=y.toDateString(),g.AirTime=y.toTimeString()}}else if(e===wt.shortform){if(g.isFullEpisode="n",g.VideoType="vod",g.Sport=d&&d.sportName||"Not Applicable",g.League=d&&d.leagueName||"Not Applicable",g.ShowCode=f&&f.bundle||"Not Applicable",d&&d.name&&(g.CMSID=d.name),l){y=new Date(l);g.PublishDate=y.toISOString().substring(0,10),g.PublishTime=y.toISOString().substring(11)}if(h){y=new Date(h);g.ExpirationDate=y.toISOString()}if(p){y=new Date(p);g.DateLastModified=y.toISOString()}v&&(g.VideoTypeDetail=v)}return g}(e,n));var u={};return u[bt.nielsen]=r,u[bt.comscore]=a,u[bt.conviva]=o,u[bt.heartbeats]=s,u}function zt(t,e,n){return t.sort((function(t,e){var n="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2,i="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(t,n){var i=t.network&&t.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=e.indexOf(i),o=e.indexOf(r);return-1===a&&(a=999),-1===o&&(o=999),a<o?-1:a>o?1:0})).sort((function(t,e){var i=t.language===n?0:1,r=e.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(t){t.abc="abc",t.abcNews="abcnews",t.abcNewsLive="abcnewslive",t.abcOtv="abcotv",t.disney="dch",t.disneyJr="djr",t.disneyXD="dxd",t.disneyNow="dnow",t.espn="espn",t.espnFantasy="espnFantasy",t.oscar="oscar",t.freeform="ff",t.foxLatam="foxlatam",t.fxNow="fxnow",t.fx="fx",t.fxm="fxm",t.fxx="fxx",t.natGeoTV="natgeotv",t.natGeo="natgeo",t.natGeoWild="natgeowild",t.natgeoBrasil="natgeobrasil",t.unknown="000"}(Ut||(Ut={}));var Ht="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName }",Bt="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}";var Vt="https://web.archive.org/web/20201104011859/https://watch.graph.api.espn.com/api",Ft="d15c5790-7cb0-4fe1-8782-25f4698d0739",Kt=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Gt="https://web.archive.org/web/20201104011859/https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock",Jt=function(t,e,n,i){t==kt.graphQL?(this.serviceUrl=e||Vt,this.apiKey=n||Ft,this.networkSortOrder=i||Kt):t==kt.cfa&&(this.serviceUrl=e||Gt)},qt=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return Lt(this,void 0,void 0,(function(){return Rt(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return Lt(this,void 0,void 0,(function(){var r,a,o,s,u,c;return Rt(this,(function(d){switch(d.label){case 0:return r=e.map((function(t){return new jt(t)})),a=i.serviceUrl,o=i.apiKey,s=i.networkSortOrder,[4,w.all(r.map((function(e){return t.getPromiseMediaItems(e,a,o,n)})))];case 1:return u=d.sent(),(c=u.filter((function(t){return!(t instanceof Error)&&t instanceof Nt}))).length?[2,zt(c,s,navigator.language)]:[2,null]}}))}))},t.getPromiseMediaItems=function(e,n,i,r){return Lt(this,void 0,void 0,(function(){var a,o,s,u,c,d,l,h,p,f,v,g;return Rt(this,(function(y){switch(y.label){case 0:a=function(t,e,n,i){var r="",a="",o="",s=i||"US";return t.entityType===wt.shortform?(r="VOD",o=Bt,a='id:"'+t.id+'"'):(r="airing",o=Ht,t.id?a='id:"'+t.id+'"':t.channel?(r="airings",a='networks:["'+t.channel+'"],type:LIVE'):t.gameId&&(r="airings",a='eventId:"'+(t.eventId||t.gameId)+'"')),e+"?apiKey="+n+"&query="+("airings"===r?encodeURIComponent("{ "+r+"("+a+',countryCode:"'+s+'",deviceType:SETTOP,tz:"Z") '+o+" }"):encodeURIComponent("{ "+r+"("+a+',deviceType:SETTOP,tz:"Z") '+o+" }"))}(e,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,A(a)];case 2:return[4,y.sent().json()];case 3:if(o=y.sent(),s=o.data.airing,(u=o.data.airings)&&(c=e.simulcastAiringId?function(t){return t.simulcastAiringId===e.simulcastAiringId}:function(){return!0},s=u.filter(c)[0]),d=o.data.VOD,!(l=s||d))throw new Error("No results found.");if(h=function(t,e,n){var i=t.id,r=t.name,a=t.description,o=t.duration,s=t.image,u=t.eventId,c=t.requiresLinearPlayback,d=t.authTypes,l=t.source,h=t.prerollSource,p=t.packages,f=t.language,v=t.mrss,g=t.seekInSeconds,y=t.tracking,m=t.simulcastAiringId,b=t.network,P=t.status,w=t.cerebroId,I=t.syndicatable,A=P&&("LIVE"===P.toUpperCase()||"OVER"===P.toUpperCase())?yt.live:yt.onDemand,_=function(t){switch(t){case"NONE":return Et.none;case"START_SESSION":return Et.startSession;case"BAM":return Et.bam;case"SHIELD":return Et.shield}}(l.authorizationType),k=new Ct(l.url,_,l.hasEspnId3Heartbeats,l.hasNielsenWatermarks,l.hasPassThroughAds,l.commercialReplacement,l.startSessionUrl);n&&n.sourceVariant===vt.stitchedPreroll&&h&&((k=new Ct(h.url,Et.none)).variant=vt.stitchedPreroll);var S=c?lt.linearPlayback:lt.all,T=y&&y.trackingId||i,E=new Nt(i,r,o,f,k);if(E.authenticationTypes=d.map((function(t){switch(t){case"DIRECT":return Tt.direct;case"OPEN":return Tt.open;case"MVPD":return Tt.mvpd;case"ISP":return Tt.isp;default:return Tt.none}})),E.description=a,E.isSyndicatable=I,s&&s.url&&E.images.push(new Dt(s.url)),E.mrss=v,b){var C="linear"===b.type?pt.linear:pt.event;E.network=new Ot(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=A,E.supportedMediaCommands=S,E.brand=E.brand?E.brand:"espn",E.tracking=xt(E.brand,t,e,k),E.references={eventId:u,simulcastAiringId:m,trackingId:T,cerebroId:w},E.type=At.video,E.entityType=e,E.apiSource=kt.graphQL,E.packages=(p||[]).map((function(t){return new Mt(t.name)})),E}(l,e.entityType,r),e.resumeTime&&(h.seekInSeconds=e.resumeTime),!h.source.url){if(p="OVER"===l.status.toUpperCase(),f=l.network&&l.network.type===pt.linear,v=l.network&&l.network.id,p&&f&&v)return[2,t.retryGetMediaItems(v,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),b.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},t.retryGetMediaItems=function(e,n,i,r){return Lt(this,void 0,void 0,(function(){var a,o,s,u;return Rt(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),a=jt.identifierStringForNetwork(e,kt.graphQL),o=new jt(a),[4,t.getPromiseMediaItems(o,n,i,r)];case 1:if((s=c.sent())&&s instanceof Nt==!0)return[2,s];throw new Error("Retry fetchMediaItems failed with "+e);case 2:return u=c.sent(),b.warn("MediaItem is over and retry failed: "+u),[2,null];case 3:return[2]}}))}))},t.defaultConfiguration=new Jt(kt.graphQL),t}();var Wt,Yt=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return Lt(this,void 0,void 0,(function(){return Rt(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return Lt(this,void 0,void 0,(function(){var n,r;return Rt(this,(function(a){switch(a.label){case 0:return n=e.map((function(t){return new jt(t)})),r=i.serviceUrl,[4,w.all(n.map((function(e){return t.getPromiseMediaItem(e,r)})))];case 1:return[2,a.sent().filter((function(t){return!(t instanceof Error)&&t instanceof Nt}))]}}))}))},t.getPromiseMediaItem=function(t,e){return Lt(this,void 0,void 0,(function(){var n,i,r;return Rt(this,(function(a){switch(a.label){case 0:n=e.replace("videoID",t.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,A(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(t){var e=t.id,n=t.title,i=t.description,r=t.duration,a=t.source,o=t.type,s=t.entityType,u=t.streamType,c=t.authenticationTypes,d=t.language,l=t.network,h=t.brand,p=t.images,f=s,v=a.type,g=new Ct(a.url,v),y=new Nt(e,n,r,d,g);return y.authenticationTypes=c.map((function(t){switch(t){case"DIRECT":return Tt.direct;case"OPEN":return Tt.open;case"MVPD":return Tt.mvpd;case"ISP":return Tt.isp;default:return Tt.none}})),y.description=i,l&&(y.network=new Ot(l.id,l.type,l.name,l.resource)),y.streamType=u,y.brand=h,y.tracking=xt(y.brand,t,f,g),y.images=p,y.type=o,y.entityType=f,y.apiSource=kt.cfa,y}(i)];case 4:return r=a.sent(),b.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},t.defaultConfiguration=new Jt(kt.cfa),t}(),Qt=function(){function t(){}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(t,e){return Lt(this,void 0,void 0,(function(){var n,i;return Rt(this,(function(r){switch(r.label){case 0:return n=e||{sourceVariant:null},t[0].match("natgeo")?((i=new Yt).configuration=this.configuration||i.configuration,[4,i.getMediaItems(t,n)]):[3,2];case 1:return[2,r.sent()];case 2:return(i=new qt).configuration=this.configuration||i.configuration,[4,i.getMediaItems(t,n)];case 3:return[2,r.sent()]}}))}))},t}(),Xt=new function t(n){e(this,t),this.intervals=n}({intervals:{DEFAULT:2,ESPN_PLUS:0,ESPN_PLUS_MLB:0,ESPN_PLUS_NHL:0}}),Zt=function(){function t(){e(this,t),this.configuration=Xt}return i(t,[{key:"shouldPreroll",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=this.configuration.intervals.DEFAULT||0,r=(n||[]).filter((function(t){return t in e.configuration.intervals})).map((function(t){return e.configuration.intervals[t]}));0===r.length&&r.push(i);var a=Math.min.apply(Math,g(r));return a>0&&t.prerollCount>=a-1}},{key:"configuration",get:function(){return this._configuration},set:function(t){this._configuration=t}}],[{key:"prerollCount",get:function(){var t=localStorage.getItem("PrerollManager.prerollCount");try{return JSON.parse(t)||0}catch(t){return 0}},set:function(t){localStorage.setItem("PrerollManager.prerollCount",JSON.stringify(t))}}]),t}(),$t=function(t){function n(){return e(this,n),l(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"configuration",get:function(){var t=it.shared.getConfiguration("preRoll",Xt);return b.debug("PrerollManager.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}}],[{key:"prerollCount",get:function(){return Zt.prerollCount},set:function(t){Zt.prerollCount=t}}]),n}(Zt),te=function(t){function n(){return e(this,n),l(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"name",get:function(){return this.title}},{key:"eventId",get:function(){return this.references.eventId}},{key:"trackingId",get:function(){return this.references.trackingId}},{key:"simulcastAiringId",get:function(){return this.references.simulcastAiringId}},{key:"airingId",get:function(){return this.id}},{key:"requiresLinearPlayback",get:function(){return this.supportedMediaCommands===lt.linearPlayback}},{key:"convivaContentMetadata",get:function(){return this.tracking&&this.tracking[bt.conviva]}},{key:"trackingInfo",get:function(){return this.tracking&&this.tracking[bt.heartbeats]}},{key:"nielsenMetadata",get:function(){return this.tracking&&this.tracking[bt.nielsen]}}],[{key:"fromObject",value:function(t){var e=new n(t.id,t.title,t,t.duration,t.language,t.source);if(a(e,Nt.fromObject(t)),e.source){var i=function(t){switch(t){case Et.bam:return"BAM";case Et.none:return"NONE";case Et.shield:return"SHIELD";case Et.startSession:return"START_SESSION";default:return null}}(e.source.type);e.source.authorizationType=i}return e}}]),n}(Nt),ee=function(t){function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt.graphQL;return e(this,n),(t=l(this,c(n).call(this))).prerollManager=new $t,t.apiSource=i,t.configurationKey=i===kt.graphQL?"graphqlapi":null,t}return u(n,t),i(n,[{key:"getMediaItems",value:function(t,e){var i=e||{},r=i.entitlements||[];return this.prerollManager.shouldPreroll(r)&&(i.sourceVariant=vt.stitchedPreroll),p(c(n.prototype),"getMediaItems",this).call(this,t,i).then((function(t){var e=t||[],n=e.filter((function(t){return t.source.variant===vt.stitchedPreroll})).length;return n>0?$t.prerollCount=0:$t.prerollCount+=e.length-n,e.map((function(t){return te.fromObject(t)}))}))}},{key:"configuration",get:function(){var t=it.shared.getConfiguration(this.configurationKey,n.defaultConfiguration);return b.debug("MediaItemAPI.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}}]),n}(qt),ne={device:{advertisingId:"0000-0000-0000-0000-0000",devType:"web"}};!function(t){t.localStorage="LOCAL_STORAGE",t.sessionStorage="SESSION_STORAGE"}(Wt||(Wt={}));var ie,re=function(){function t(t,e,n,i){this.id=t,this.name=e,this.logoUrl=n,this.websiteUrl=i}return t.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},t.fromObject=function(e){return new t(e.id,e.name,e.logoUrl,e.websiteUrl)},t}();!function(t){t.token="token",t.tokenType="tokenType",t.resource="resource",t.requestor="requestor"}(ie||(ie={}));var ae,oe,se=function(){function t(t,e,n,i){void 0===i&&(i={}),this.authenticationType=t,this.authenticatedProvider=e,this.authenticatedIdentity=n,this.customData=i}return t.CustomDataKey=ie,t}(),ue=function(t,e){this.success=t,this.payload=e};!function(t){t.standard="default",t.googleAdManager="gam"}(ae||(ae={})),function(t){t.standard="default",t.prod="prod",t.development="dev"}(oe||(oe={}));var ce=function(){function t(t,e){this.id=t,this.tier=e}return t.prototype.toString=function(){return"<AuthenticatedPackage id:"+this.id+", tier:"+this.tier+">"},t.fromObject=function(e){return new t(e.id,e.tier)},t}();function de(t,e,n){if(!t||!e||!n)return t;var i="</item></channel></rss>",r=-1;return-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:affiliateId>"+e+"</shield:affiliateId>"+t.slice(r)),-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:airingId")&&-1!==t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:airingId>"+n+"</shield:airingId>"+t.slice(r)),t}var le,he=new function(t,e,n,i){this.preauthorizedNetworksEnabled=t,this.preauthorizedNetworks=e,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),pe=(function(){function t(t,e,n,i){void 0===i&&(i={}),this.partner=t,this.platform=e,this.requestorId=n,this.options=i,this.adobePass=null,this.providerDataSource=null,this.configuration=he}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.isAuthenticated")},set:function(t){localStorage.setItem("AdobePassAuthenticator.isAuthenticated",JSON.stringify(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("AdobePassAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedIdentity",t):localStorage.removeItem("AdobePassAuthenticator.authenticatedIdentity")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedPackage",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedPackage");try{return ce.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedPackage",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedPackage")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedProvider");try{return re.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedProvider")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasPreviouslyAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.wasPreviouslyAuthenticated")||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){if(!this.isAuthenticated)return[];var t=localStorage.getItem("AdobePassAuthenticator.preauthorizedResources");try{return JSON.parse(t)}catch(t){return[]}},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this;b.debug("AdobePassAuthenticator.checkAuthentication");var e=this.adobePass;return e?e.checkAuthentication().then((function(n){return t.isAuthenticated=n,n?(localStorage.setItem("AdobePassAuthenticator.wasPreviouslyAuthenticated","true"),t.getPreauthorizedResources().then((function(t){localStorage.setItem("AdobePassAuthenticator.preauthorizedResources",JSON.stringify(t))})),e.getUserMetadata().then((function(e){var n=e.data,i=n.upstreamUserID,r=n.mvpd,a=n.packageId,o=n.tier;return t.authenticatedIdentity=i,(a||o)&&(t.authenticatedPackage=new ce(a,o)),t.providerDataSource?t.providerDataSource.getProvider(r).then((function(e){var n=e.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new re(r,e.name,n,e.websiteUrl),!0})).catch((function(){return t.authenticatedProvider=new re(r,r,null,null),!0})):(t.authenticatedProvider=new re(r,r,null,null),w.resolve(!0))}))):(t.authenticatedIdentity=null,t.authenticatedProvider=null,t.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources"),w.resolve(!1))})).catch((function(){return w.resolve(!1)})):w.resolve(!1)},t.prototype.authenticate=function(){var t=this;if(!this.currentRegistrationCode)return w.reject(new Error("Use getRegistrationCode first."));b.debug("AdobePassAuthenticator.authenticate currentRegistrationCode: "+this.currentRegistrationCode.code);var e=this.currentRegistrationCode.expires;return e&&Date.now()>e?w.reject(new Error("Your activation code has expired.")):new w((function(e,n){t.authenticateTimer_=setTimeout((function(){t.checkAuthentication().then((function(t){e(t)})).catch((function(t){n(t)}))}),5e3)})).then((function(e){return e||t.authenticate()}))},t.prototype.cancelAuthenticate=function(){b.debug("AdobePassAuthenticator.cancelAuthenticate"),this.authenticateTimer_&&clearTimeout(this.authenticateTimer_)},t.prototype.deauthenticate=function(){this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources");var t=this.adobePass;return t?t.logout():w.resolve(!1)},t.prototype.getRegistrationCode=function(){var t=this;b.debug("AdobePassAuthenticator.getRegistrationCode");var e=this.adobePass;return e?e.createRegistrationCode().then((function(e){return t.currentRegistrationCode=e,e?e.code:""})):w.reject(new Error("adobe pass not configured"))},t.prototype.checkAuthorization=function(t){var e=this;if(-1===t.authenticationTypes.indexOf(Tt.mvpd)||!this.isAuthenticated)return w.resolve(new ue(!1,null));var n=t.mrss,i=this.authenticatedPackage&&this.authenticatedPackage.id;i&&(n=de(n,i,t.id));var r=n,a=this.adobePass;return a.authorize(r).then((function(){return a.getShortMediaToken(r)})).then((function(t){var n,i=t.serializedToken,a=((n={})[se.CustomDataKey.token]=i,n[se.CustomDataKey.tokenType]="ADOBEPASS",n[se.CustomDataKey.resource]=r,n[se.CustomDataKey.requestor]=e.requestorId,n),o=new se(Tt.mvpd,e.authenticatedProvider,e.authenticatedIdentity,a);return new ue(!0,o)})).catch((function(t){try{return t.json().then((function(t){var n=e.configuration.adobeAuthErrorRegex,i=new RegExp(n),r=t.message,a=t.details,o=i.test(r),s=i.test(a),u="This channel is not part of your TV package.";return o?s||(u=a):u=r,w.reject(new Error(u))}))}catch(t){return w.reject(new Error("There was an unexpected error."))}}))},t.prototype.getPreauthorizedResources=function(){var t=this.configuration,e=t.preauthorizedNetworksEnabled,n=t.preauthorizedNetworks,i=t.preauthorizeNetworksMapping;if(!1===e){var r=n;return Object.keys(i).forEach((function(t){var e=i[t];-1!==r.indexOf(t)&&-1===r.indexOf(e)&&r.push(e)})),w.resolve(r)}return 0===n.length?w.resolve([]):this.adobePass.preauthorize(n).then((function(t){var e=t.resources.filter((function(t){return!0===t.authorized})).map((function(t){return t.id}));return Object.keys(i).forEach((function(t){var n=i[t];-1!==e.indexOf(t)&&-1===e.indexOf(n)&&e.push(n)})),e}))},t.defaultConfiguration=he}(),m((function(t,e){var n,i,r,a,o,s,u,c;t.exports=(i=(n=c=D).lib,r=i.WordArray,a=i.Hasher,o=n.algo,s=[],u=o.SHA1=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],o=n[3],u=n[4],c=0;c<80;c++){if(c<16)s[c]=0|t[e+c];else{var d=s[c-3]^s[c-8]^s[c-14]^s[c-16];s[c]=d<<1|d>>>31}var l=(i<<5|i>>>27)+u+s[c];l+=c<20?1518500249+(r&a|~r&o):c<40?1859775393+(r^a^o):c<60?(r&a|r&o|a&o)-1894007588:(r^a^o)-899497514,u=o,o=a,a=r<<30|r>>>2,r=i,i=l}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+u|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),n.SHA1=a._createHelper(u),n.HmacSHA1=a._createHmacHelper(u),c.SHA1)})),m((function(t,e){var n,i,r;t.exports=(i=(n=D).lib.Base,r=n.enc.Utf8,void(n.algo.HMAC=i.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=r.parse(e));var n=t.blockSize,i=4*n;e.sigBytes>i&&(e=t.finalize(e)),e.clamp();for(var a=this._oKey=e.clone(),o=this._iKey=e.clone(),s=a.words,u=o.words,c=0;c<n;c++)s[c]^=1549556828,u[c]^=909522486;a.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}})))})),m((function(t,e){t.exports=D.HmacSHA1})),function(){function t(t,e,n,i,r,a,o,s,u){this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a,this.rank=o,this.availability=s,this.accessType=u,this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a||[],this.rank=o,this.availability=s,this.accessType=u}return t.prototype.getPreferredLogoUrl=function(t,e){var n=this.images.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.type}))[0],i=this.images.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.type}))[0]||n;return i?"https://web.archive.org/web/20201104011859/https://s.secure.espncdn.com/stitcher/watch/clients/"+t+"-"+e+"/providers/"+this.adobeId+".png?height=40&imageType="+i:this.images.filter((function(t){return"DESKTOP"===t.type})).map((function(t){return t.href}))[0]||null},t.prototype.toString=function(){return"<Provider id:"+this.id+", name:"+this.name+", adobeId:"+this.adobeId+">"},t}());!function(t){t.mvpd="mvpd",t.isp="isp",t.tve="tve"}(le||(le={}));var fe=le,ve=function(t){this.serviceUrl=t,this.serviceUrl=t};function ge(t,e){var n=t.tier||99,i=e.tier||99;if(n<i)return-1;if(n>i)return 1;var r=t.rank||9999,a=e.rank||9999;if(r<a)return-1;if(r>a)return 1;var o=t.name.toLowerCase(),s=e.name.toLowerCase();return o<s?-1:o>s?1:0}var ye={negativebgcolorImage:"COLOR_NEGATIVE",negativebgbwImage:"BW_NEGATIVE",positivebgcolorImage:"COLOR_POSITIVE",positivebgbwImage:"BW_POSITIVE",desktop:"DESKTOP"};function me(t,e){if(!t)return null;var n=t.id,i=t.name,r=t.websiteUrl,a=t.adobeId,o=t.logos,s=t.accessType,u=function(t){return Object.keys(t).filter((function(e){return ye[e]&&!!t[e]})).map((function(e){return{href:t[e].trim(),type:ye[e]}}))}(o),c=t.countries.filter((function(t){return t.countryCode.toLowerCase()===e.toLowerCase()}))[0],d=c&&c.tier,l=c&&c.rank;return new pe(n,i,a,d,r,u,l,null,s)}function be(t,e){return t.rows.map((function(t){return me(t.data,e)})).sort(ge)}var Pe={};Pe[fe.mvpd]="adobeId",Pe[fe.isp]="ispId",Pe[fe.tve]="id";var we=new ve("https://web.archive.org/web/20201104011859/https://affiliate.api.espn.com/affiliateApi/affiliates?includeProperties=true&rows=1000&apikey=q458c7hcllto16w0wcjytqoxq"),Ie=function(){function t(t){this.locationProvider=t||{getCountryCode:function(){return"us"}},this.applicationId=null,this.configuration=we}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applicationId",{get:function(){return this.applicationId_},set:function(t){this.applicationId_=t},enumerable:!0,configurable:!0}),t.prototype.getProvider=function(t,e,n){return void 0===n&&(n={}),T(this,void 0,void 0,(function(){var i,r,a,o;return E(this,(function(s){switch(s.label){case 0:return i=e||fe.mvpd,r=Pe[i]||"adobeId",n[r]=t,[4,this.getProviders(n)];case 1:if(a=s.sent(),!(o=a[0]))throw new Error("Unable to find provider.");return[2,o]}}))}))},t.prototype.getProviders=function(t){return void 0===t&&(t={}),T(this,void 0,void 0,(function(){var e,n,i,r,a,o;return E(this,(function(s){switch(s.label){case 0:e=this.configuration.serviceUrl,n=-1===e.indexOf("?")?"?":"&",i=this.applicationId,r=function(t){return-1!==["PR","GU","VI"].indexOf(t)?"US":t}(this.locationProvider.getCountryCode().toUpperCase()),i&&(t.application=i),t.country=r,a=Object.keys(t).map((function(e){return e+"="+encodeURIComponent(t[e])})).join("&"),o=""+e+n+a,s.label=1;case 1:return s.trys.push([1,4,,5]),[4,A(o)];case 2:return[4,s.sent().json()];case 3:return[2,be(s.sent(),r)];case 4:return s.sent(),[2,[]];case 5:return[2]}}))}))},t.defaultConfiguration=we,t}(),Ae=(function(){function t(t){this.authenticatedProviderId=null,this.providerDataSource=null,this.partner=t.partner,this.platform=t.platform}Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return!!this.token&&!!this.tokenType},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("TokenAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedIdentity",t):localStorage.removeItem("TokenAuthenticator.authenticatedIdentity")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("TokenAuthenticator.authenticatedProvider");try{return re.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("TokenAuthenticator.authenticatedProvider")},enumerable:!0,configurable:!0}),t.prototype.setToken=function(t,e,n){this.token=t,this.tokenType=e,this.resource=n},t.prototype.checkAuthentication=function(){var t=this,e=this.authenticatedProviderId;if(!e||this.authenticatedProvider&&e===this.authenticatedProvider.id)return w.resolve(this.isAuthenticated);if(!this.providerDataSource)return this.authenticatedProvider=new re(e,e,null,null),w.resolve(this.isAuthenticated);var n,i="ADOBEPASS"===(n=this.tokenType)?fe.mvpd:"DEVICE"===n?fe.isp:null;return this.providerDataSource.getProvider(e,i).then((function(n){var i=n.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new re(e,n.name,i,n.websiteUrl),w.resolve(t.isAuthenticated)})).catch((function(){return t.authenticatedProvider=new re(e,e,null,null),w.resolve(t.isAuthenticated)}))},t.prototype.authenticate=function(t){var e=t.authenticatedProviderId,n=t.authenticatedIdentity,i=t.token,r=t.tokenType;return this.authenticatedProviderId=e,this.authenticatedIdentity=n,this.setToken(i,r,null),this.checkAuthentication()},t.prototype.deauthenticate=function(){return this.authenticatedProvider=null,this.authenticatedIdentity=null,this.token=null,this.tokenType=null,this.resource=null,w.resolve(!0)},t.prototype.checkAuthorization=function(t){var e,n,i="ADOBEPASS"===(n=this.tokenType)?Tt.mvpd:"DEVICE"===n?Tt.isp:"BAM"===n?Tt.direct:null;if(!this.isAuthenticated||-1===t.authenticationTypes.indexOf(i)&&"DEVICE"!==this.tokenType&&"GATEKEEPER"!==this.tokenType)return w.resolve(new ue(!1,null));var r=((e={})[se.CustomDataKey.token]=this.token,e[se.CustomDataKey.tokenType]=this.tokenType,e);this.resource&&(r.resource=this.resource);var a=new se(i,this.authenticatedProvider,this.authenticatedIdentity,r),o=new ue(!0,a);return w.resolve(o)}}(),"watchsdk.web_adobe_pass_authenticator.state"),_e=function(t,e){e.setItem(Ae,JSON.stringify(t))},ke={production:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyZGJmZWM4My03OWE1LTQyNzEtYTVmZC04NTZjYTMxMjRjNjMiLCJuYmYiOjE1NDAyMTI3NjEsImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjEyNzYxfQ.yaK3r4AI2uLVvsyN1GLzqzgzRlxMPtasSaiYYBV0wIstqih5tvjTmeoLmi8Xy9Kp_U7Md-bOffwiyK3srHkpUkhhwXLH2x6RPjmS1tPmhaG7-3LBcHTf2ySPvXhVf7cN4ngldawK4tdtLtsw6rF_JoZE2yaC6XbS2F51nXSFEDDnOQWIHEQRG3aYAj-38P2CLGf7g-Yfhbp5cKXeksHHQ90u3eOO4WH0EAjc9oO47h33U8KMEXxJbvjV5J8Va2G2fQSgLDZ013NBI3kQnE313qgqQh2feQILkyCENpB7g-TVBreAjOaH1fU471htSoGGYepcAXv-UDtpgitDiLy7CQ",staging:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhMmRjNjgyMC1kZGNkLTQ4NGEtOTdlNS0xZjJiZmQzOGI4YzgiLCJuYmYiOjE1NDAyMjIwNTksImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjIyMDU5fQ.YgX4ecGCgLCaZS7uwRQYZ8UR5EwT7GIl-glFbwU122bO1JYZSmbIX8YJSfmYth_scyeg-15BYWNftV9lOcmCe8VwIsQMJMIZKaF8qSIj5OfuTOBpNZNBpDAp5dC3zG7Zp1xLe3z-T0Y18-0BGj2yhGcJxBz4gtLXQ30Bw0LEIJ89nXCQaXFTq9N6zhDzMfkFJNnSNEvEmvcQqB4bFPIqn2is8427oQDU4D0XYvvTtx9eb5hmzKc9MbBG-8KRBA62BqdHomA5UA4kBYJKpe-8B2hO07Adi2bZoo5wP_VLNAnAxANWNXaGQYHMDjHDrHbbvuKHBudHgKxAuKpIdC7UrA"},Se=new function(t,e,n,i){this.preauthorizeNetworksEnabled=t,this.preauthorizeNetworks=e,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),Te="mvpd",Ee="upstreamUserID",Ce="packageId",Oe="tier",De="hba_status",Me={},Ne=function(){function t(e,n,i,r,a){this.partner=e,this.platform=n,this.requestorId=i,this.options=r,this.configuration=Se;var o=r||{},s=o.environment,u=void 0===s?t.Environment.PRODUCTION:s,c=o.errorEventHandlerName,d=void 0===c?"AEErrorHandler":c;this.accessEnabler=null,this.environment=u,this.errorEventHandlerName=d,this.resolveEntitlementLoaded_=null,this.resolveCheckAuthenticationCompletions_=[],this.resolveAuthenticate_=null,this.resolveDeauthenticate_=null,this.resolveAuthorization_=null,this.resolvePreauthorizes_=[],this.resolveAuthenticateMetadataDependencies_={},this.softwareStatements=a||ke,this.delegate=null,this.providerDataSource=null,this.storage=localStorage,this.state_={};try{var l=this.storage.getItem(Ae),h=JSON.parse(l);h.authenticatedProvider&&(h.authenticatedProvider=re.fromObject(h.authenticatedProvider)),h.authenticatedPackage&&(h.authenticatedPackage=ce.fromObject(h.authenticatedPackage)),this.state_=h}catch(t){}this.initialization_=this.initialize(),window.tokenRequestFailed=this.tokenRequestFailed.bind(this)}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===this.state_.isAuthenticated.toString()},set:function(t){this.state_.isAuthenticated=t,_e(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return this.state_.authenticatedIdentity},set:function(t){if(!t)return delete this.state_.authenticatedIdentity,void _e(this.state_.toString,this.storage);this.state_.authenticatedIdentity=t,_e(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedPackage",{get:function(){return this.state_.authenticatedPackage},set:function(t){if(!t)return delete this.state_.authenticatedPackage,void _e(this.state_,this.storage);this.state_.authenticatedPackage=t,_e(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(t){if(!t)return delete this.state_.authenticatedProvider,void _e(this.state_,this.storage);this.state_.authenticatedProvider=t,_e(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasPreviouslyAuthenticated",{get:function(){var t,e;return"true"===(null===(e=null===(t=this.state_)||void 0===t?void 0:t.wasPreviouslyAuthenticated)||void 0===e?void 0:e.toString())||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return this.isAuthenticated?this.state_.preauthorizedResources:[]},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this;return b.debug("AdobePassAuthenticator.checkAuthentication"),this.accessEnabler?new w((function(e){t.resolveCheckAuthenticationCompletions_.push((function(t){e(t)})),t.accessEnabler.checkAuthentication()})):w.reject(null)},t.prototype.authenticate=function(t){var e=this;if(b.debug("AdobePassClient.authenticate"),!this.accessEnabler)return w.reject(null);var n=t&&t.redirectUrl||window.location.href;return new w((function(t){e.resolveAuthenticate_=function(e){t(e)},e.accessEnabler.getAuthentication(n)}))},t.prototype.deauthenticate=function(){var t=this;return b.debug("AdobePassAuthenticator.deauthenticate"),this.accessEnabler?new w((function(e){t.resolveDeauthenticate_=function(t){e(t)},t.accessEnabler.logout()})):w.reject(null)},t.prototype.checkAuthorization=function(t){var e,n=this;if(b.debug("AdobePassClient.checkAuthorization "+t),-1===(null===(e=t.authenticationTypes)||void 0===e?void 0:e.indexOf(Tt.mvpd))||!this.isAuthenticated){var i=new ue(!1,null);return w.resolve(i)}var r=t.mrss,a=this.authenticatedPackage&&this.authenticatedPackage.id;a&&(r=de(r,a,t.id));var o=r;return new w((function(t,e){n.resolveAuthorization_=function(i){var r,a=i.token,o=i.resourceId,s=i.errorId,u=i.message;if(a||!s){var c=((r={})[se.CustomDataKey.token]=M.stringify(N.parse(a)),r[se.CustomDataKey.tokenType]="ADOBEPASS",r[se.CustomDataKey.resource]=o,r),d=new se(Tt.mvpd,n.authenticatedProvider,n.authenticatedIdentity,c),l=new ue(!0,d);t(l)}else e(new Error(u||s))},n.accessEnabler.getAuthorization(o)}))},t.prototype.setProvider=function(t){this.accessEnabler.setSelectedProvider(t)},Object.defineProperty(t.prototype,"isHomeBasedAuth",{get:function(){return this.hbaStatus||!1},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){var t=this,e=this.environment;return function(t,e){var n=window&&window.document;if(!n)return w.reject();if(window.Adobe&&window.Adobe.AccessEnabler){var i=new window.Adobe.AccessEnabler(e);return w.resolve(i)}return new w((function(i,r){var a=n.createElement("script");a.id="ae_js",a.type="text/javascript",a.async=!0,a.src=t,a.addEventListener("load",(function(){var t=new window.Adobe.AccessEnabler(e);i(t)})),a.addEventListener("error",(function(){r()})),n.getElementsByTagName("head")[0].appendChild(a)}))}(Me[e],this.softwareStatements[e]).then((function(e){return t.accessEnabler=e,w.resolve()})).then((function(){return new w((function(e){t.resolveEntitlementLoaded_=e,t.bindAccessEnablerCallbacks()}))}))},t.prototype.bindAccessEnablerCallbacks=function(){window.entitlementLoaded=this.entitlementLoaded.bind(this),window.setAuthenticationStatus=this.setAuthenticationStatus.bind(this),window.setMetadataStatus=this.setMetadataStatus.bind(this),window.displayProviderDialog=this.displayProviderDialog.bind(this),window.setConfig=this.setConfig.bind(this),window.sendTrackingData=this.sendTrackingData.bind(this),window.preauthorizedResources=this.handlePreauthorizedResources.bind(this),window.selectedProvider=this.selectedProvider.bind(this),window.setToken=this.setToken.bind(this),window[this.errorEventHandlerName]=this.handleAccessEnablerError.bind(this)},t.prototype.entitlementLoaded=function(){b.debug("AdobePassAuthenticator.entitlementLoaded"),this.accessEnabler&&(this.accessEnabler.bind("errorEvent",this.errorEventHandlerName),this.accessEnabler.setRequestor(this.requestorId),this.resolveEntitlementLoaded_&&(this.resolveEntitlementLoaded_(!0),this.resolveEntitlementLoaded_=null))},t.prototype.setAuthenticationStatus=function(t,e){var n=this;if(b.debug("AdobePassAuthenticator.setAuthenticationStatus",t,e),this.isAuthenticated=!!t,this.isAuthenticated){this.accessEnabler.getMetadata(Ee);var i=[Ce,Oe,De,Te].map((function(t){return new w((function(e){n.resolveAuthenticateMetadataDependencies_[t]=function(t){e(t)},n.accessEnabler.getMetadata(t)})).catch((function(t){return b.warn(t),null}))}));i.push(this.getPreauthorizedResources_().then((function(t){n.state_.preauthorizedResources=t}))),w.all(i).then((function(){n.resolveCheckAuthenticationCompletions_.forEach((function(t){t(n.isAuthenticated)})),n.resolveCheckAuthenticationCompletions_=[],n.resolveAuthenticate_&&(n.resolveAuthenticate_(n.isAuthenticated),n.resolveAuthenticate_=null)}))}else this.authenticatedIdentity=null,this.authenticatedPackage=null,this.authenticatedProvider=null,this.hbaStatus=null,this.state_.preauthorizedResources=[],this.resolveCheckAuthenticationCompletions_.forEach((function(t){t(n.isAuthenticated)})),this.resolveCheckAuthenticationCompletions_=[],this.resolveDeauthenticate_&&(this.resolveDeauthenticate_(this.isAuthenticated),this.resolveDeauthenticate_=null)},t.prototype.setMetadataStatus=function(t,e,n){var i=this;switch(b.debug("AdobePassAuthenticator.setMetadataStatus",t,n),t){case Te:var r=n;this.providerDataSource?this.providerDataSource.getProvider(r).then((function(e){var a=e.images||[],o=a.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.href}))[0],s=a.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.href}))[0]||o||a.map((function(t){return t.href}))[0];i.authenticatedProvider=new re(r,e.name,s,e.websiteUrl),i.authenticatedProvider.isHomeBasedAuth=i.hbaStatus,i.resolveAuthenticateMetadata_(t,n)})).catch((function(){i.authenticatedProvider=new re(r,r,null,null),i.resolveAuthenticateMetadata_(t,n)})):(this.authenticatedProvider=new re(r,r,null,null),this.resolveAuthenticateMetadata_(t,n));break;case Ee:this.authenticatedIdentity=n,this.resolveAuthenticateMetadata_(t,n);break;case De:this.hbaStatus="true"===n,this.resolveAuthenticateMetadata_(t,n);break;case Ce:case Oe:if(n){var a=this.authenticatedPackage||new ce(null,null);t===Ce?a.id=n:t===Oe&&(a.tier=n),this.authenticatedPackage=a}this.resolveAuthenticateMetadata_(t,n)}},t.prototype.displayProviderDialog=function(t){var e=this;b.debug("AdobePassAuthenticator.displayProviderDialog",t),this.providerDataSource&&this.providerDataSource.getProviders().then((function(t){e.delegate&&e.delegate.selectProvider&&e.delegate.selectProvider(t)}))},t.prototype.setConfig=function(){},t.prototype.sendTrackingData=function(t,e){if("authenticationDetection"===t){var n={success:e[0],mvpd:e[1],guid:e[2],isTokenCached:e[3],deviceType:e[4],clientType:e[5],os:e[6]};b.debug("AdobePassAuthenticator.sendTrackingData",t,n)}},t.prototype.handlePreauthorizedResources=function(t){b.debug("AdobePassAuthenticator.preauthorizedResources",t);var e=this.resolvePreauthorizes_.shift();e&&e(t)},t.prototype.selectedProvider=function(t){var e=t.MVPD,n=t.AEstate_;b.debug("AdobePassAuthenticator.selectedProvider mvpd: "+e+", aeState: "+n)},t.prototype.setToken=function(t,e){b.debug("Requested resource: "+t+" tokenResult: "+e),this.resolveAuthorization_&&(this.resolveAuthorization_({resourceId:t,token:e}),this.resolveAuthorization_=null)},t.prototype.handleAccessEnablerError=function(t){var e=t.errorId,n=t.message;switch(b.debug("AdobePassAuthenticator.handleAccessEnablerError errorId: "+e+", message: "+n),e){case"Z100":b.error("Failure to authorize: "+n);var i=this.configuration.adobeAuthErrorRegex,r=new RegExp(i).test(n)?"This channel is not part of your TV package.":n;this.resolveAuthorization_&&(this.resolveAuthorization_({errorId:e,message:r}),this.resolveAuthorization_=null);break;case"N130":this.checkAuthentication()}},t.prototype.tokenRequestFailed=function(){b.debug("AdobePassAuthenticator.tokenRequestFailed")},t.prototype.resolveAuthenticateMetadata_=function(t,e){var n=this.resolveAuthenticateMetadataDependencies_[t];n&&(n(e),delete this.resolveAuthenticateMetadataDependencies_[t])},t.prototype.getPreauthorizedResources_=function(){var t=this;b.debug("AdobePassAuthenticator.getPreauthorizedResources_");var e=this.configuration,n=e.preauthorizeNetworksEnabled,i=e.preauthorizeNetworks,r=e.preauthorizeNetworksMapping;if(!1===n){var a=i;return Object.keys(r).forEach((function(t){var e=r[t];-1!==a.indexOf(t)&&-1===a.indexOf(e)&&a.push(e)})),w.resolve(a)}if(0===i.length||!0!==this.isAuthenticated)return w.resolve([]);if(!this.accessEnabler)return w.reject(null);var o=function t(e,n){return e.length?O([e.slice(0,n)],t(e.slice(n),n)):[]}(i,5),s=[],u=o.map((function(e){return new w((function(n){s.push((function(t){n(t)})),t.accessEnabler.checkPreauthorizedResources(e)})).catch((function(){return[]}))}));return this.resolvePreauthorizes_=s,w.all(u).then((function(t){return t.reduce((function(t,e){return t.concat(e)}),[])}))},t.defaultConfiguration=Se,t}();Ne.Environment={PRODUCTION:"production",STAGING:"staging"},Ne.EventType={PREAUTHORIZED:"preauthorized",NOT_PREAUTHORIZED:"not_preauthorized"},Me[Ne.Environment.PRODUCTION]="https://web.archive.org/web/20201104011859/https://entitlement.auth.adobe.com/entitlement/v4/AccessEnabler.js",Me[Ne.Environment.STAGING]="https://web.archive.org/web/20201104011859/https://entitlement.auth-staging.adobe.com/entitlement/v4/AccessEnabler.js";var Ue,je=function(t){function n(){return e(this,n),l(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"configuration",get:function(){var t=it.shared.getConfiguration("adobePass",Ne.defaultConfiguration);return b.debug("WebAdobePassAuthenticator.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}}]),n}(Ne);!function(t){t.localStorage="LOCAL_STORAGE",t.sessionStorage="SESSION_STORAGE"}(Ue||(Ue={}));var Le,Re=Ue,xe=function(){function t(t,e,n,i){this.id=t,this.name=e,this.logoUrl=n,this.websiteUrl=i}return t.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},t.fromObject=function(e){return new t(e.id,e.name,e.logoUrl,e.websiteUrl)},t}();!function(t){t.token="token",t.tokenType="tokenType",t.resource="resource"}(Le||(Le={}));var ze=function(){function t(t,e,n,i){void 0===i&&(i={}),this.authenticationType=t,this.authenticatedProvider=e,this.authenticatedIdentity=n,this.customData=i}return t.CustomDataKey=Le,t}(),He=function(t,e){this.success=t,this.payload=e};!function(t){t.standard="default",t.googleAdManager="gam"}(t.AdProvider||(t.AdProvider={})),function(t){t.standard="default",t.prod="prod",t.development="dev"}(t.AdEnvironment||(t.AdEnvironment={}));var Be=function(t){return null===t?null:t?"1":"0"},Ve=function(t,e){return null!=t?t:e},Fe=function(){function e(e,n,i,r,a,o,s,u,c,d,l,h,p,f,v,g,y,m,b,P,w,I,A,_,k,S,T,E,C,O,D,M){void 0===e&&(e="espn"),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a=null),void 0===o&&(o=!1),void 0===s&&(s=null),void 0===u&&(u=null),void 0===c&&(c=!1),void 0===d&&(d=null),void 0===l&&(l=null),void 0===h&&(h=!1),void 0===p&&(p=null),void 0===f&&(f=null),void 0===v&&(v=null),void 0===g&&(g=null),void 0===y&&(y=null),void 0===m&&(m=null),void 0===b&&(b=null),void 0===P&&(P=null),void 0===w&&(w=null),void 0===I&&(I=null),void 0===A&&(A=null),void 0===_&&(_=null),void 0===k&&(k=null),void 0===S&&(S=null),void 0===T&&(T=null),void 0===E&&(E=null),void 0===C&&(C=null),void 0===O&&(O={}),void 0===D&&(D=t.AdEnvironment.standard),void 0===M&&(M=t.AdProvider.standard),this.an=e,this.descriptionUrl=n,this.fcap=i,this.hl=r,this.idType=a,this.isLat=o,this.iu=s,this.msid=u,this.npa=c,this.ppid=d,this.rdid=l,this.tfcd=h,this.url=p,this.vpa=f,this.vpmute=v,this.authenticationProvider=g,this.bundleId=y,this.deviceOS=m,this.deviceType=b,this.isAutoplay=P,this.isMute=w,this.nielsenAppId=I,this.nielsenDeviceGroup=A,this.platform=_,this.stitchingProvider=k,this.swid=S,this.unid=T,this.videoDeliveryMethod=E,this.videoPlayerSize=C,this.userInfo=O,this.adEnvironment=D,this.adProvider=M}return e.prototype.merge=function(e){return e?(this.an=e.an||this.an,this.descriptionUrl=e.descriptionUrl||this.descriptionUrl,this.fcap=e.fcap||this.fcap,this.hl=e.hl||this.hl,this.idType=e.idType||this.idType,this.isLat=Ve(e.isLat,this.isLat),this.iu=e.iu||this.iu,this.msid=e.msid||this.msid,this.npa=Ve(e.npa,this.npa),this.ppid=e.ppid||this.ppid,this.rdid=e.rdid||this.rdid,this.tfcd=Ve(e.tfcd,this.tfcd),this.url=e.url||this.url,this.vpa=Ve(e.vpa,this.vpa),this.vpmute=Ve(e.vpmute,this.vpmute),this.authenticationProvider=e.authenticationProvider||this.authenticationProvider,this.bundleId=e.bundleId||this.bundleId,this.deviceOS=e.deviceOS||this.deviceOS,this.deviceType=e.deviceType||this.deviceType,this.isAutoplay=Ve(e.isAutoplay,this.isAutoplay),this.isMute=Ve(e.isMute,this.isMute),this.nielsenAppId=e.nielsenAppId||this.nielsenAppId,this.nielsenDeviceGroup=e.nielsenDeviceGroup||this.nielsenDeviceGroup,this.platform=e.platform||this.platform,this.stitchingProvider=e.stitchingProvider||this.stitchingProvider,this.swid=e.swid||this.swid,this.unid=e.unid||this.unid,this.videoDeliveryMethod=e.videoDeliveryMethod||this.videoDeliveryMethod,this.videoPlayerSize=e.videoPlayerSize||this.videoPlayerSize,this.userInfo?Object.assign(this.userInfo,e.userInfo):this.userInfo=e.userInfo,this.adEnvironment=e.adEnvironment!==t.AdEnvironment.standard?e.adEnvironment:this.adEnvironment,this.adProvider=e.adProvider!==t.AdProvider.standard?e.adProvider:this.adProvider,this):this},e.prototype.dictionaryForStartSession=function(){var e={};return e["ad.tfcd"]=Be(this.tfcd),e["ad.is_lat"]=Be(this.isLat),e["ad.idtype"]=this.idType,e["ad.rdid"]=this.rdid,e["ad.ppid"]=this.ppid||this.swid,e["ad.description_url"]=this.descriptionUrl,e["ad.hl"]=this.hl,e["ad.npa"]=Be(this.npa),e["ad.msid"]=this.msid,e["ad.an"]=this.an,e["ad.url"]=this.url,e.authp=this.authenticationProvider,e.bundleId=this.bundleId,e.devOS=this.deviceOS,e.devType=this.deviceType,e.fcap=this.fcap,e.isAutoplay=Be(this.isAutoplay),e.isMute=Be(this.isMute),e.nlsnAppID=this.nielsenAppId,e.plt=this.platform,e.swid=this.swid,e.unid=this.unid,e.vps=this.videoPlayerSize,this.adEnvironment!==t.AdEnvironment.standard&&(e.adEnv=this.adEnvironment),this.adProvider!==t.AdProvider.standard&&(e.adProvider=this.adProvider),Object.assign(e,this.userInfo),Object.keys(e).forEach((function(t){return null===e[t]&&delete e[t]})),e},e.prototype.dictionaryForBrightcove=function(){var t={};t.bundleId=this.bundleId,t.devOS=this.deviceOS,t.devType=this.deviceType,t.isAutoplay=Be(this.isAutoplay),t.isMute=Be(this.isMute),t.plt=this.platform,t.swid=this.swid,t.vps=this.videoPlayerSize,t.d_id=this.rdid,t.vdm=this.videoDeliveryMethod||"vod",t.stp=this.stitchingProvider||"brightcove";var e=Object.keys(t).filter((function(e){return null!==t[e]})).map((function(e){return e+"="+t[e]})).join("&"),n={};return n.UMADPARAMiu=this.iu,n.UMADPARAMis_lat=Be(this.isLat),n.UMADPARAMidtype=this.idType,n.UMADPARAMrdid=this.rdid,n.UMADPARAMppid=this.ppid||this.swid,n.UMADPARAMdescription_url=this.descriptionUrl,n.UMADPARAMhl=this.hl,n.UMADPARAMnpa=Be(this.npa),n.UMADPARAMmsid=this.msid,n.UMADPARAMan=this.an,n.UMADPARAMurl=this.url,n.UMADPARAMvpa=Be(this.vpa),n.UMADPARAMvpmute=Be(this.vpmute),n.UMPTPARAMcust_params=e,Object.assign(n,this.userInfo),Object.keys(n).forEach((function(t){return null===n[t]&&delete n[t]})),n},e.prototype.dictionaryForAdEngine=function(){var e={};switch(e.sect=this.iu,e.npa=Be(this.npa),e.lat=Be(this.isLat),e.idtype=this.idType,e.devId=this.rdid,e.ppid=this.ppid||this.swid,e.app=this.an,e.tfcd=Be(this.tfcd),e.devOS=this.deviceOS,e.devType=this.deviceType,e.isAutoplay=Be(this.isAutoplay),e.isMute=Be(this.isMute),e.plt=this.platform,e.swid=this.swid,e.unid=this.unid,e.vps=this.videoPlayerSize,e.bundle=this.msid,e.hl=this.hl,e.UID=this.swid,e.vdm=this.videoDeliveryMethod,e.url=this.url,this.adEnvironment){case t.AdEnvironment.development:e.env="qa";break;case t.AdEnvironment.prod:e.env="prod";break;case t.AdEnvironment.standard:}switch(this.adProvider){case t.AdProvider.googleAdManager:e.ads="google";break;case t.AdProvider.standard:}return Object.assign(e,this.userInfo),Object.keys(e).forEach((function(t){return null===e[t]&&delete e[t]})),e},e.ppidForSwid=function(t){return t},e}(),Ke=function(){function t(){this.partner=null,this.platform=null,this.apiKey=null,this.deviceId=null,this.authenticators={},this.authorizers={},this.playbackSessionFactories={}}return t.prototype.getAuthenticator=function(t){return this.authenticators[t]},t.prototype.setAuthenticator=function(t,e){var n=this;this.convertToArray(e).forEach((function(e){n.authenticators[e.toString()]=t}))},t.prototype.getAuthorizer=function(t){return this.authorizers[t]},t.prototype.setAuthorizer=function(t,e){var n=this;this.convertToArray(e).forEach((function(e){n.authorizers[e.toString()]=t}))},t.prototype.getPlaybackSessionFactory=function(t){return this.playbackSessionFactories[t]},t.prototype.setPlaybackSessionFactory=function(t,e){var n=this;this.convertToArray(e).forEach((function(e){n.playbackSessionFactories[e.toString()]=t}))},t.prototype.checkAuthentication=function(){var t=this,e=Object.keys(this.authenticators).map((function(e){var n=t.authenticators[e];return n.checkAuthentication().then((function(t){return b.debug(e+" authenticator","isAuthenticated: "+t,"authenticatedProvider: "+n.authenticatedProvider),t})).catch((function(){return!1}))}));return w.all(e).then((function(t){return t.every((function(t){return!0===t}))}))},t.prototype.isAuthenticatedForMediaItem=function(t){var e=this;return t.authenticationTypes.length<1||-1!==t.authenticationTypes.indexOf(Tt.none)||t.authenticationTypes.map((function(t){return e.authenticators[t]})).filter((function(t){return t})).some((function(t){return t.isAuthenticated}))},t.prototype.isAuthenticatedWithAuthType=function(t){var e=this.authenticators[t];return!!e&&e.isAuthenticated},t.prototype.authenticateWithAuthType=function(t,e){var n=this.authenticators[t];if(n)return n.authenticate(e)},t.prototype.checkAuthorization=function(t,e){var n=this;if(t.authenticationTypes&&t.authenticationTypes.length<1||-1!==t.authenticationTypes.indexOf(Tt.none)){var i=new xe(t.id,t.title,t.images[0].url,t.source.url),r=new ze(Tt.none,i,t.id,{}),a=new He(!0,r);return w.resolve(a)}var o=[Tt.open,Tt.mvpd,Tt.direct,Tt.isp].filter((function(e){return-1!==t.authenticationTypes.indexOf(e)})),s=o.map((function(t){return n.authorizers[t]})).filter((function(t){return t&&t.checkAuthorization}));return b.debug("mediaItem.authTypes:",o),0===s.length?w.reject(new Error("no authorizer configured to support authTypes: "+t.authenticationTypes)):function t(e,n,i,r){return void 0===r&&(r=[]),i.shift().checkAuthorization(e,n).then((function(a){return a.success?a:i.length<1?r.length>0?w.reject(null):a:t(e,n,i,r)})).catch((function(a){if(i.length>0)return a&&r.push(a),t(e,n,i,r);var o=r[0]||a;if(o)throw o}))}(t,e,s)},t.prototype.initPlaybackSession=function(t,e){var n=this;return!t.source.type&&t.authenticationTypes.length>0?w.reject(new Error("This event is not currently available.")):this.checkAuthorization(t,e).then((function(i){b.debug("AuthenticationManager.initPlaybackSession.checkAuthorization result:",i.success);var r=i.success,a=i.payload;if(!r)throw new Error("Not authorized.");var o=a.authenticationType;if(!o)throw new Error("Not authorized.");var s=n.playbackSessionFactories[o],u=new Fe;return u.authenticationProvider=i.payload.authenticatedProvider&&i.payload.authenticatedProvider.id,u.merge(e),s.initPlaybackSession(t,u,a).then((function(t){return b.debug("AuthenticationManager.initPlaybackSession",t),t}))}))},Object.defineProperty(t.prototype,"authStates",{get:function(){var t=this.authenticators[Tt.mvpd],e=[];return this.authenticators[Tt.isp].isAuthenticated&&e.push("isp"),!0===t.isAuthenticated?e.push("mvpd_login"):!0===t.wasPreviouslyAuthenticated&&e.push("mvpd_previous"),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){var t=this;return Object.keys(this.authenticators).map((function(e){return t.authenticators[e].preauthorizedResources})).reduce((function(t,e){return t.concat(e)}),[]).filter((function(t,e,n){return n.indexOf(t)===e}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"primaryAuthenticatedProvider",{get:function(){var t=this;return[Tt.mvpd,Tt.isp].map((function(e){return t.getAuthenticator(e)})).filter((function(t){return t.isAuthenticated})).map((function(t){return t.authenticatedProvider}))[0]},enumerable:!0,configurable:!0}),t.prototype.convertToArray=function(t){if(!t)return[];var e=[];return Array.isArray(t)?e=t:"string"==typeof t&&e.push(t),e},t}();Ke.AuthenticateOptionsKey={redirectUrl:"redirectUrl"};var Ge,Je=function(t,e,n){this.contentType=t,this.keySystem=e,this.licenseUrl=n},qe=function(){function t(t){this.playbackUrl=t,this.textTracks=[]}return Object.defineProperty(t.prototype,"convivaContentMetadata",{get:function(){var t={authType:null,mvpd:null};this.authenticationType&&(t.authType=this.authenticationType&&this.authenticationType.toLowerCase()||"free",this.authenticatedProvider&&this.authenticationType===Tt.mvpd&&(t.mvpd=this.authenticatedProvider.id));var e=this.mediaItem&&this.mediaItem.tracking[bt.conviva]||{},n={streamUrl:this.playbackUrl,custom:Object.assign(e.custom||{},t)};return Object.assign(e,n)},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"<PlaybackSession playbackUrl:"+this.playbackUrl+", authenticationType:"+this.authenticationType+", authenticatedProvider:"+this.authenticatedProvider+">"},t}(),We=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return k(e,t),e.fromObject=function(t){var e=t;return e.mediaItem=Nt.fromObject(t.mediaItem),e},e}(qe);!function(t){t.none="none",t.fairPlay="fairplay",t.playReady="playready",t.widevine="widevine"}(Ge||(Ge={}));var Ye,Qe=Ge;!function(t){t.none="HLS",t.hlsFairplay="HLS_FAIRPLAY",t.dashPlayReady="DASH_PLAYREADY",t.dashWidevine="DASH_WIDEVINE"}(Ye||(Ye={}));var Xe=Ye,Ze=function(t,e,n){var i=-1===n.indexOf("?")?"?":"&";return n+i+t+"="+encodeURIComponent(e)},$e=function(){function t(){this.drmSupport=Xe.none}return t.prototype.initPlaybackSession=function(t,e,n){var i=e&&e.swid,r=t.source.url;if(t.source.variant===vt.stitchedPreroll){var a=e.dictionaryForBrightcove();Object.keys(a).forEach((function(t){r=Ze(t,a[t].toString(),r)}))}else r=Ze("SWID",i,r);b.debug(r,t);var o=new qe(r);return o.mediaItem=t,o.seekToTime=t.seekInSeconds,o.authenticationType=n.authenticationType,o.authenticatedProvider=n.authenticatedProvider,o.authenticatedIdentity=n.authenticatedIdentity,w.resolve(o)},t}(),tn=function(){function t(t,e,n){void 0===n&&(n={}),this.programmer=t,this.applicationId=e,this.metadata=n}return t.prototype.withSession=function(t){var e=t.authenticationType,n=t.authenticatedIdentity,i=t.authenticatedProvider,r=t.mediaItem;if(e!==Tt.mvpd)return this;var a=n,o=i&&i.id;return this.metadata[R]=a,this.metadata[H]=r.network&&r.network.id,this.metadata[B]=r.streamType===yt.live?j:L,this.metadata[V]="",this.metadata[K]=!!t.authenticatedProvider&&t.authenticatedProvider.isHomeBasedAuth,this.subject=a,this.identityProvider=o,this},t.prototype.withServiceUrl=function(t){return this.serviceUrl=t,this},t.prototype.withMessages=function(t){return this.messages=t,this},t.prototype.build=function(){if(!this.subject||!this.identityProvider)return null;var t=new W(this.programmer,this.applicationId,this.identityProvider,this.subject,this.metadata);return this.serviceUrl&&(t.serviceUrl=this.serviceUrl),this.messages&&(t.messages=this.messages||{}),t},t}(),en=function(){function t(){this.drmSupport=Xe.none,this.factories=[]}return t.prototype.initPlaybackSession=function(t,e,n){var i=this,r=this.drmSupport;return this._getPlaybackSession(t,e,n,r).then((function(t){var e=i.concurrencyMonitorBuilder&&i.concurrencyMonitorBuilder.withSession(t).build();return e?e.createSession().then((function(e){return t.concurrencyMonitorSessionId=e,t})):t}))},t.prototype._getPlaybackSession=function(t,e,n,i){var r=t.source.type,a=this.factories[r];if(!a)throw new Error("Unsupported MediaItem.source.type");return a.drmSupport&&(a.drmSupport=i),a.initPlaybackSession(t,e,n)},t}(),nn=function(){function t(t,e){this.partner=t,this.platform=e}return t.prototype.startSession=function(t,e,n,i,r,a){var o=["partner="+this.partner,"platform="+this.platform,"token="+encodeURIComponent(n),"tokenType="+i,"v=2.0.0","ttl=21600"];if(r){var s=M.stringify(N.parse(r));o.push("resource="+encodeURIComponent(s))}a&&Object.keys(a).forEach((function(t){o.push(t+"="+encodeURIComponent(a[t]))}));var u=/swid=*/g;o.some((function(t){return u.test(t)}))||o.push("swid="+encodeURIComponent(e));return A(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},credentials:"include",body:o.join("&")}).then((function(t){return t.json()})).then((function(t){if(!t.session)throw new Error(t.message||"An unexpected error occurred. ["+t.abbreviation+"]");return t})).catch((function(t){if(t.message)throw new Error(t.message);return t.json().then((function(t){throw new Error(t.message||"An unexpected error occurred. ["+t.abbreviation+"]")}))}))},t}(),rn=function(){function t(t){this.authButler=t,this.drmSupport=Xe.none}return t.prototype.initPlaybackSession=function(t,e,n){var i=t.source.url;t.source.startSessionUrl&&t.source.type===Et.shield&&(i=t.source.startSessionUrl);try{var r=window&&window.location.protocol;r&&"https:"===r&&(i=i.replace(/^http(s?):/,r))}catch(t){}var a=n.customData,o=a.token,s=a.tokenType,u=a.resource,c=void 0===u?t.mrss:u,d=e&&e.swid,l=this.authButler;if(!l)throw new Error("startSession support not configured");return l.startSession(i,d,o,s,c,e.dictionaryForStartSession()).then((function(e){var i=function(t,e){var n=t.playbackUrl,i=new We(n);return i.token=e,i}(e,o);return i.mediaItem=t,i.seekToTime=t.seekInSeconds,i.authenticationType=n.authenticationType,i.authenticatedProvider=n.authenticatedProvider,i.authenticatedIdentity=n.authenticatedIdentity,i}))},t}(),an="ADOBEPASS",on=function(t){if(t instanceof Error)throw t;return t.json&&t.json().then((function(t){var e=t.message||"An unexpected error occurred. ["+t.exception+"]";throw"com.espn.watch.api.AccessDeniedException"===t.exception&&(e="This content is not available for your package or region."),new Error(e)}))},sn="https://web.archive.org/web/20201104011859/https://watch.auth.api.espn.com",un=function(){function t(t){this.serviceUrl=sn,this.apiKey=t}return t.prototype.getAsset=function(t,e,n,i,r,a){var o=this.serviceUrl+"/video/auth/media/"+t+"/asset";return this.getAssetForUrl(o,e,n,i,r,a)},t.prototype.getAssetForUrl=function(t,e,n,i,r,a){var o=a||{};if(e)if(n===an){if(o.adobeToken=e,i){var s=M.stringify(N.parse(i));o.adobeResource=s}}else o.token=e;r&&(o.drmSupport=r);var u={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},credentials:"include",body:Object.keys(o).map((function(t){return t+"="+encodeURIComponent(o[t])})).join("&")},c=-1===t.indexOf("?")?"?":"&";return A(""+t+c+"apikey="+this.apiKey,u).then((function(t){if(!t.ok)throw t;return t.json()})).then((function(t){if(!t.stream){var e=t.message||"An unexpected error occurred.";throw new Error(e)}return t})).catch(on)},t.defaultServiceUrl=sn,t}(),cn=function(){function t(t){this.shieldAPI=t,this.drmSupport=Xe.none}return t.prototype.initPlaybackSession=function(t,e,n){var i=n.customData,r=void 0===i?{}:i,a=r.token,o=r.tokenType,s=r.resource,u=void 0===s?t.mrss:s,c=this.drmSupport||Xe.none,d=e.dictionaryForStartSession(),l=this.shieldAPI;if(!l)throw new Error("shield support not configured");var h=t.source.url;return l.getAssetForUrl(h,a,o,u,c,d).then((function(e){var i=e.stream,r=e.captions,a=e.streamInfo,o=e.gatekeeperToken,s=new We(i);return s.mediaItem=t,s.seekToTime=t.seekInSeconds,s.authenticationType=n.authenticationType,s.authenticatedProvider=n.authenticatedProvider,s.authenticatedIdentity=n.authenticatedIdentity,s.token=o,s.playbackConfig=function(t){if(!t)return null;var e=t.streamType,n=t.licenseAcquisitionUrl,i=t.certificateUrl;switch(e){case"DASH_PLAYREADY":return new Je("application/dash+xml",Ge.playReady,n);case"DASH_WIDEVINE":return new Je("application/dash+xml",Ge.widevine,n);case"HLS_FAIRPLAY":return new Je("application/x-mpegURL",Ge.fairPlay,i);case"HLS":return new Je("application/x-mpegURL",Ge.none);default:return null}}(a),s.textTracks=function(t){if(!t)return[];var e={source:t};return t.endsWith(".vtt")&&(e.contentType="text/vtt"),[e]}(r),s}))},t}(),dn=function(){function t(){this.isAuthenticated=!0,this.authenticatedIdentity=null,this.authenticatedProvider=null,this.preauthorizedResources=this.isAuthenticated?["espn_free"]:[]}return t.prototype.checkAuthentication=function(){return w.resolve(!0)},t.prototype.authenticate=function(){return w.resolve(!0)},t.prototype.deauthenticate=function(){return w.resolve(!0)},t.prototype.checkAuthorization=function(t){var e;if(-1===t.authenticationTypes.indexOf(Tt.open)||!this.isAuthenticated)return w.resolve(new He(!1,null));var n=((e={})[ze.CustomDataKey.token]="IA==",e[ze.CustomDataKey.tokenType]="DEVICE",e),i=new ze(Tt.open,this.authenticatedProvider,this.authenticatedIdentity,n),r=new He(!0,i);return w.resolve(r)},t}(),ln=function(){function t(n,i,r){e(this,t),this.id=n,this.profile=i,this.preferences=r}return i(t,[{key:"toString",value:function(){return"<Fan id:".concat(this.id,">")}},{key:"favoriteSports",get:function(){return this.preferences.filter((function(t){return t.metadata.sportId&&!t.metadata.teamId})).map((function(t){return t.metadata}))}},{key:"favoriteTeams",get:function(){return this.preferences.filter((function(t){return t.metadata.teamInfo})).map((function(t){return t.metadata}))}},{key:"fantasyPreferences",get:function(){return this.preferences.filter((function(t){return 9===t.type.id}))}},{key:"isLeagueManager",get:function(){return this.preferences.some((function(t){var e=t.metadata&&t.metadata.entry&&t.metadata.entry;return e&&!0===e.isLeagueManager}))}}],[{key:"fromJson",value:function(e){if(!e)return null;var n=hn.fromJson(e.profile),i=e.preferences.map((function(t){return vn.fromJson(t)}));return new t(e.id,n,i)}}]),t}(),hn=function(){function t(n,i,r){e(this,t),this.isInsider=n,this.hasNotificationPreferences=i,this.settings=r}return i(t,[{key:"toString",value:function(){return"<FanProfile isInsider:".concat(this.isInsider,", hasNotificationPreferences:").concat(this.hasNotificationPreferences,">")}}],[{key:"fromJson",value:function(e){if(!e)return null;var n=pn.fromJson(e.settings);return new t(e.isInsider,e.hasNotificationPreferences,n)}}]),t}(),pn=function(){function t(n){e(this,t),this.videoAutoStart=n}return i(t,null,[{key:"fromJson",value:function(e){return e?new t(fn.fromJson(e.videoAutoStart)):null}}]),t}(),fn=function(){function t(n){e(this,t),this.value=n}return i(t,null,[{key:"fromJson",value:function(e){return e?new t(e.value):null}}]),t}(),vn=function(){function t(n,i,r){e(this,t),this.id=n,this.metadata=i,this.type=r}return i(t,null,[{key:"fromJson",value:function(e){if(!e)return null;var n=yn.fromJson(e.metaData||e.metadata),i=gn.fromJson(e.type);return new t(e.id,n,i)}}]),t}(),gn=function(){function t(n,i,r){e(this,t),this.id=n,this.name=i,this.code=r}return i(t,null,[{key:"fromJson",value:function(e){return e?new t(e.id,e.name,e.code):null}}]),t}(),yn=function(){function t(n,i,r,a){e(this,t),this.sportId=n,this.teamId=i,this.teamInfo=r,this.entry=a}return i(t,[{key:"uid",get:function(){if(this.teamInfo)return this.teamInfo.uid;var t=null;return this.sportId&&(t="s:".concat(this.sportId),this.teamId&&(t="".concat(t,"~t:").concat(this.teamId))),t}}],[{key:"fromJson",value:function(e){if(!e)return null;var n=null;if(e.teamInfo)n=new Pn(e.teamInfo.uid,e.teamInfo.name,e.teamInfo.fullName,e.teamInfo.logoUrl,e.teamInfo.darkLogoUrl,e.teamInfo.scoreboardLogoUrl,e.teamInfo.scoreboardDarkLogoUrl);else if(e.team){var i=e.team,r=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("default")})).map((function(t){return t.href}))[0],a=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("dark")&&-1===t.rel.indexOf("scoreboard")})).map((function(t){return t.href}))[0],o=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("scoreboard")&&-1===t.rel.indexOf("dark")})).map((function(t){return t.href}))[0],s=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("scoreboard")&&-1!==t.rel.indexOf("dark")})).map((function(t){return t.href}))[0];n=new Pn(i.uid,i.name,i.text,r,a||r,o||r,s||a||r)}var u=mn.fromJson(e.entry);return new t(e.sportId,e.teamId,n,u)}}]),t}(),mn=function(){function t(n){e(this,t),this.groups=n}return i(t,[{key:"isLeagueManager",get:function(){return this.groups.some((function(t){return!0===t.groupManager}))}}],[{key:"fromJson",value:function(e){return e?new t((e.groups||[]).map((function(t){return bn.fromJson(t)}))):null}}]),t}(),bn=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e(this,t),this.groupManager=n}return i(t,null,[{key:"fromJson",value:function(e){return e?new t(e.groupManager):null}}]),t}(),Pn=function t(n,i,r,a,o,s,u){e(this,t),this.uid=n,this.name=i,this.fullName=r,this.logoUrl=a,this.darkLogoUrl=o,this.scoreboardLogoUrl=s,this.scoreboardDarkLogoUrl=u},wn="https://web.archive.org/web/20201104011859/https://fan.api.espn.com/apis/v2/fans",In=function(){function t(){e(this,t),this.serviceUrl=wn}return i(t,[{key:"getFan",value:function(t){var e=ct.platform,n=this.serviceUrl||wn;return A("".concat(n,"/").concat(encodeURIComponent(t),"?prefType=sports&prefType=teams&prefType=fantasy&coreData=logos"),{method:"GET",headers:{"X-Personalization-Source":"espn-watchsdk-js-".concat(e)}}).then((function(t){return t.json()})).then((function(t){return ln.fromJson(t)}))}}]),t}(),An=function(t){function n(){return e(this,n),l(this,c(n).apply(this,arguments))}return u(n,t),i(n,null,[{key:"getFan",value:function(t){var e=it.shared.getConfiguration("fanApi",{serviceUrl:wn}).serviceUrl,n=new In;return n.serviceUrl=e,n.getFan(t)}}]),n}(In);localStorage.getItem("FanManager.anonSwid")||A("https://web.archive.org/web/20201104011859/https://log.espn.com/log?srvc=sz&silent&returnBody=SWID&responseType=JSON").then((function(t){return t.json()})).then((function(t){var e=t.SWID;e&&localStorage.setItem("FanManager.anonSwid",e)}));var _n,kn=function(){function t(){e(this,t)}return i(t,null,[{key:"swid",get:function(){return localStorage.getItem("FanManager.anonSwid")}}]),t}(),Sn=function(){function t(){e(this,t)}return i(t,null,[{key:"update",value:function(){var e=localStorage.getItem("FanManager.swid");return e?An.getFan(e).then((function(t){return localStorage.setItem("FanManager.fan",JSON.stringify(t)),t})):w.resolve(t.fan)}},{key:"swid",get:function(){return localStorage.getItem("FanManager.swid")||kn.swid},set:function(t){if(!t)return localStorage.removeItem("FanManager.swid"),void localStorage.removeItem("FanManager.fan");localStorage.setItem("FanManager.swid",t)}},{key:"fan",get:function(){var t=localStorage.getItem("FanManager.fan");try{return ln.fromJson(JSON.parse(t))}catch(t){return null}}}]),t}(),Tn=function(){function t(){e(this,t)}return i(t,[{key:"getCountryCode",value:function(){}}]),t}(),En=function(t){function n(){return e(this,n),l(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"getCountryCode",value:function(){return"us"}}]),n}(Tn),Cn=function(t){function n(t){return e(this,n),l(this,c(n).call(this,t||new En))}return u(n,t),i(n,[{key:"configuration",get:function(){var t=it.shared.getConfiguration("provider",s({applicationKeyMap:{}},Ie.defaultConfiguration));return b.debug("ESPNAffiliateAPI.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}},{key:"applicationId",get:function(){var t=function(t){return"US"===t||"GU"===t||"PR"===t||"VI"===t}(this.locationProvider.getCountryCode().toUpperCase())&&"web"===ct.platform?"".concat(ct.partner,"_").concat(ct.platform):"".concat(ct.platform),e=this.configuration.applicationKeyMap||{};return e[t]&&(t=e[t]),b.debug("ESPNAffiliateAPI.getApplicationId ".concat(t)),t},set:function(t){v(c(n.prototype),"applicationId",t,this,!0)}}]),n}(Ie),On=function(){function t(){e(this,t)}return i(t,null,[{key:"getBuilder",value:function(){var t,e=it.shared.getConfiguration("adobeCM",at);if(!1===e.enabled)return null;var n=ct.platform,i=e.applications&&e.applications[n],a=e.applicationId||i&&i.applicationId,o=(r(t={},x,a),r(t,z,n),r(t,F,""),r(t,G,"false"),r(t,J,"ESPN"),t);return new tn("ESPN",a,o).withServiceUrl(e.serviceUrl).withMessages(e.messages||{})}}]),t}(),Dn="watchsdk.isp_authenticator.state",Mn=function(t,e){e.setItem(Dn,JSON.stringify(t))},Nn=function(t){var e="true"===t.getItem("ISPAuthenticator.isAuthenticated"),n=t.getItem("ISPAuthenticator.authenticatedIdentity"),i=null;try{i=JSON.parse(t.getItem("ISPAuthenticator.authenticatedProvider"))}catch(t){}var r={isAuthenticated:e,authenticatedIdentity:n,authenticatedProvider:i};return t.removeItem("ISPAuthenticator.isAuthenticated"),t.removeItem("ISPAuthenticator.authenticatedIdentity"),t.removeItem("ISPAuthenticator.authenticatedProvider"),r},Un=new function(t){this.userDataServiceUrl=t}("https://web.archive.org/web/20201104011859/https://broadband.espn.com/espn3/auth/watchespn/user"),jn=function(){function t(t,e,n){switch(this.partner=t,this.platform=e,this.providerDataSource=null,this.configuration=Un,n){case Re.localStorage:this.storage=localStorage;break;case Re.sessionStorage:this.storage=sessionStorage;break;default:this.storage=localStorage}this._state={};try{var i=this.storage.getItem(Dn);i||(i=Nn(this.storage),Mn(this._state,this.storage));var r=JSON.parse(i.toString());r.authenticatedProvider&&(r.authenticatedProvider=xe.fromObject(r.authenticatedProvider)),this._state=r}catch(t){}}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this._configuration},set:function(t){this._configuration=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===this._state.isAuthenticated||!0===this._state.isAuthenticated},set:function(t){this._state.isAuthenticated=t,Mn(this._state,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return this._state.authenticatedIdentity},set:function(t){if(!t)return delete this._state.authenticatedIdentity,void Mn(this._state,this.storage);this._state.authenticatedIdentity=t,Mn(this._state,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){return this._state.authenticatedProvider},set:function(t){if(!t)return delete this._state.authenticatedProvider,void Mn(this._state,this.storage);this._state.authenticatedProvider=t,Mn(this._state,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return this.isAuthenticated?["espn3"]:[]},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this,e=this.configuration.userDataServiceUrl;return A(e+"?partner="+this.partner+"&platform="+this.platform).then((function(t){return t.json()})).then((function(n){var i=n.user&&n.user.authentication&&n.user.authentication.isp;if(i){t.isAuthenticated=!0;var r=i.name;return t.providerDataSource?t.providerDataSource.getProvider(r,fe.isp).then((function(n){var i=n.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new xe(r,n.name,i,e),!0})).catch((function(){return t.authenticatedProvider=new xe(r,r,null,e),!0})):(t.authenticatedProvider=new xe(r,r,null,e),w.resolve(!0))}return!1}))},t.prototype.authenticate=function(){return w.resolve(!0)},t.prototype.deauthenticate=function(){return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,w.resolve(!0)},t.prototype.checkAuthorization=function(t){var e;if(-1===t.authenticationTypes.indexOf(Tt.isp)||!this.isAuthenticated)return w.resolve(new He(!1,null));var n=((e={})[ze.CustomDataKey.token]="IA==",e[ze.CustomDataKey.tokenType]="DEVICE",e),i=new ze(Tt.isp,this.authenticatedProvider,this.authenticatedIdentity,n),r=new He(!0,i);return w.resolve(r)},t.defaultConfiguration=Un,t}(),Ln=function(t){function n(){return e(this,n),l(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"configuration",get:function(){var t=it.shared.getConfiguration("authorization",jn.defaultConfiguration);return b.debug("ISPAuthenticator.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}}]),n}(jn),Rn=function(t){function n(t,i){var r;e(this,n),(r=l(this,c(n).call(this))).partner=ct.partner,r.platform=ct.platform,r.apiKey=ct.apiKey,r.deviceId=ct.deviceId;var a=new Cn(t),o={deviceId:r.deviceId,deviceType:ct.platform},s=new je(r.partner,r.platform,"ESPN",o);s.providerDataSource=a;var u="web"===r.platform?Re.sessionStorage:Re.localStorage,d=new Ln(r.partner,r.platform,u);d.providerDataSource=a;var h=new dn;r.authenticators[Tt.mvpd]=s,r.authenticators[Tt.isp]=d,r.authenticators[Tt.open]=h,r.authorizers[Tt.mvpd]=s,r.authorizers[Tt.isp]=d,r.authorizers[Tt.open]=h;var p=new en;p.concurrencyMonitorBuilder=On.getBuilder();var f=new un,v=function(){var t={apiKey:r.apiKey,serviceUrl:un.defaultServiceUrl},e=it.shared.getConfiguration("shield",t);f.apiKey=e.apiKey,f.serviceUrl=e.serviceUrl};v();var g=new cn(f);p.factories[Et.shield]=g;var y=new nn(r.partner,r.platform),m=new rn(y);p.factories[Et.startSession]=m;var b=new $e;return p.factories[Et.none]=b,r.playbackSessionFactories[Tt.mvpd]=p,r.playbackSessionFactories[Tt.isp]=p,r.playbackSessionFactories[Tt.open]=p,r.playbackSessionFactories[Tt.none]=p,r.drmSupport=i,it.shared.on(nt.updated,(function(){v(),p.concurrencyMonitorBuilder=On.getBuilder()})),r}return u(n,t),i(n,[{key:"initPlaybackSession",value:function(t,e){var i=Sn.swid||kn.swid;(arguments.length<=3?void 0:arguments[3])&&Object.keys(Xe).map((function(t){return Xe[t]})).indexOf(arguments.length<=3?void 0:arguments[3])&&(this.drmSupport=arguments.length<=3?void 0:arguments[3]);var r=new Fe;return r.swid=i,r.platform=this.platform,r.merge(e),p(c(n.prototype),"initPlaybackSession",this).call(this,t,r)}},{key:"drmSupport",set:function(t){var e=this;Object.keys(this.playbackSessionFactories).map((function(t){return e.playbackSessionFactories[t]})).forEach((function(e){"drmSupport"in e&&(e.drmSupport=t)}))}},{key:"advertisingId",get:function(){var t=localStorage.getItem("AuthenticationManager.advertisingId");return t||(t=ne&&ne.device.advertisingId,this.advertisingId=t),t},set:function(t){localStorage.setItem("AuthenticationManager.advertisingId",t)}}]),n}(Ke);!function(t){t.willStartPlaying="atv.player.willStartPlaying",t.didStopPlaying="atv.player.didStopPlaying",t.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",t.playerStateChanged="atv.player.playerStateChanged",t.playerTimeDidChange="atv.player.playerTimeDidChange"}(_n||(_n={}));var xn,zn,Hn,Bn=_n;!function(t){t.priv="PRIV",t.txxx="TXXX"}(xn||(xn={})),function(t){t.heartbeat="com.espn.authnet.heartbeat",t.transition="com.espn.authnet.transition",t.nielsenWatermark="www.nielsen.com"}(zn||(zn={})),function(t){t.program="PROGRAM",t.commercial="COMMERCIAL",t.slate="SLATE"}(Hn||(Hn={}));var Vn,Fn=function(){function t(t,e){this.type=t,this.id=e}return t.prototype.isContent=function(){return this.type!==Hn.slate&&this.type!==Hn.commercial},t}(),Kn=function(t,e,n){this.tag=t,this.owner=e,this.dataValue=n};!function(t){t.start="start",t.playing="playing",t.pause="pause",t.seeking="seeking",t.stalled="stalled",t.stop="stop",t.timedMetadata="timedMetadata",t.currentTime="currentTime"}(Vn||(Vn={}));var Gn,Jn=Vn,qn=function(){function t(t,e){this.certificateUrl=e,this.requests=[],this.bindSecureKeyDelivery(t||atv.secureKeyDelivery||{})}return t.prototype.bindSecureKeyDelivery=function(t){t.fetchCertificate=this.fetchCertificate.bind(this),t.fetchAssetID=this.fetchAssetID.bind(this),t.fetchKeys=this.fetchKeys.bind(this),t.cancelAllRequests=this.cancelAllRequests.bind(this)},t.prototype.fetchCertificate=function(t,e){var n=this;b.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",t);var i=this.certificateUrl;if(i){var r=new XMLHttpRequest;r.open("GET",i),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var t=r.responseDataAsBase64;b.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",t),e.success(t)}else e.failure(r.status);n.requests.splice(n.requests.indexOf(r),1)}},this.requests.push(r),r.send(null)}else e.failure("invalid certificate url")},t.prototype.fetchAssetID=function(t,e){var n=/[?&]c=([^&]+)&*/.exec(t);if(!n||n.length<2)e.failure("Error parsing assetId "+t);else{var i=n[1];b.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",t,i),e.success(i,!1)}},t.prototype.fetchKeys=function(t,e,n){var i=this,r=t.replace("skd://","https://"),a=JSON.stringify({spc:e});b.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",r);var o=new XMLHttpRequest;o.open("POST",r),o.setRequestHeader("Content-Type","application/json"),o.onreadystatechange=function(){if(4===o.readyState){if(200===o.status)try{var t=JSON.parse(o.responseText).ckc;n.success(t)}catch(t){n.failure("invalid JSON")}else n.failure(o.status);i.requests.splice(i.requests.indexOf(o),1)}},this.requests.push(o),o.send(a)},t.prototype.cancelAllRequests=function(){b.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.requests.forEach((function(t){t.abort&&t.abort()})),this.requests=[]},t}(),Wn=function(t){function e(e,n,i){var r=t.call(this)||this;if(!n)throw new Error("bus must be supplied");return r.bus=n,r.secureKeyDelivery=new qn(i),r.bindEventListeners(),r}return k(e,t),e.prototype.bindEventListeners=function(){var t=this;this.bus.on(Bn.willStartPlaying,(function(){atv.player.observeTimedMetadataKeys(),t.emit(Jn.start)})),this.bus.on(Bn.playerStateChanged,(function(e,n){switch(b.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",e,n),e){case atv.player.states.FastForwarding:t.emit(Jn.seeking,n);break;case atv.player.states.Loading:t.emit(Jn.stalled,n);break;case atv.player.states.Paused:t.emit(Jn.pause,n);break;case atv.player.states.Playing:t.emit(Jn.playing,n);break;case atv.player.states.Rewinding:t.emit(Jn.seeking,n)}})),this.bus.on(Bn.onTimedMetadataChanged,(function(e){var n=e.key,i=e.extraAttributes.info,r=e.dataValue,a=r&&N.stringify(M.parse(r))||"";a.replace("\0",""),t.emit(Jn.timedMetadata,new Kn(n,i,a))})),this.bus.on(Bn.didStopPlaying,(function(){t.emit(Jn.stop),t.cleanup()})),this.bus.on(Bn.playerTimeDidChange,(function(e){t.emit(Jn.currentTime,e)}))},Object.defineProperty(e.prototype,"playbackConfig",{set:function(t){if(t){var e=t.licenseUrl;b.debug("AtvlPlayerAdaptor setPlaybackConfig",e,t.protectionSystem),e&&(this.secureKeyDelivery.certificateUrl=e)}},enumerable:!0,configurable:!0}),e.prototype.stop=function(t){var e=t.message;atv.player.stopWithReason("Video Playback Has Stopped",e)},e.prototype.cleanup=function(){this.bus.off(Bn.willStartPlaying),this.bus.off(Bn.onTimedMetadataChanged),this.bus.off(Bn.didStopPlaying)},e}(Z),Yn=function(t){function e(e,n){var i=t.call(this)||this;return e?(i.nativePlayer=e,i.bus=e.getEventBus(),i.constants=n,i.bindEventListeners(),i):i}return k(e,t),e.prototype.bindEventListeners=function(){var t=this;this.bus.subscribe(this.constants.Events.Player.ID3,(function(e){void 0===e&&(e={});var n=e.sample?e.sample.data:e,i=n instanceof Uint8Array?String.fromCharCode.apply(String,O(n)):n,r=["PRIV","TXXX"].find((function(t){return i.includes(t)}))||null,a=Object.keys(zn).map((function(t){return zn[t]})).find((function(t){return i.includes(t)}))||null,o=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,s=new Kn(r,a,o);t.emit(Jn.timedMetadata,s)})),this.alreadyStarted=!1,this.bus.subscribe(this.constants.Events.Player.PLAYING,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),t.alreadyStarted?t.emit(Jn.playing):(t.emit(Jn.start),t.emit(Jn.playing),t.alreadyStarted=!0)})),this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,(function(e){var n=e/1e3;t.emit(Jn.currentTime,n)})),this.bus.subscribe(this.constants.Events.Player.PAUSE,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.PAUSE"),t.emit(Jn.pause)})),this.bus.subscribe(this.constants.Events.Player.SEEKING,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING"),t.emit(Jn.seeking)})),this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),t.emit(Jn.stalled)})),this.bus.subscribe(this.constants.Events.Player.BUFFERING_END,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_END"),t.emit(Jn.playing)})),this.bus.subscribe(this.constants.Events.Player.COMPLETE,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),t.emit(Jn.stop),t.cleanup()}))},e.prototype.stop=function(t){t&&b.warn("BAMTizenPlayerAdaptor.stop",t.message),this.nativePlayer.stop(),this.cleanup()},e.prototype.cleanup=function(){this.alreadyStarted=!1,this.bus.unsubscribe(this.constants.Events.Player.ID3,this),this.bus.unsubscribe(this.constants.Events.Player.PLAYING,this),this.bus.unsubscribe(this.constants.Events.Player.TIME_UPDATE,this),this.bus.unsubscribe(this.constants.Events.Player.PAUSE,this),this.bus.unsubscribe(this.constants.Events.Player.SEEKING,this),this.bus.unsubscribe(this.constants.Events.Player.BUFFERING_START,this),this.bus.unsubscribe(this.constants.Events.Player.COMPLETE,this)},e}(Z),Qn=function(t){function e(e){var n=t.call(this)||this;return e?(n.nativePlayer=e,n.bindEventListeners(),n):n}return k(e,t),e.prototype.bindEventListeners=function(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)},e.prototype.loadCompleteHandler=function(t){b.debug("ChromecastPlayerAdaptor: PLAYER_LOAD_COMPLETE",t),this.emit(Jn.start)},e.prototype.id3Handler=function(t){if(b.debug("ChromecastPlayerAdaptor._id3Handler",t),t.detail&&(t.segmentData=t.detail),t.segmentData){var e=String.fromCharCode.apply(String,O(t.segmentData));b.trace("ChromecastPlayerAdaptor._id3Handler",e);var n=["PRIV","TXXX"].find((function(t){return e.includes(t)}))||null,i=Object.keys(zn).map((function(t){return zn[t]})).find((function(t){return e.includes(t)}))||null,r=i?e.substring(e.lastIndexOf(i)+i.length).trim().replace(/\0/g,""):null,a=new Kn(n,i,r);b.trace("ChromecastPlayerAdaptor._id3Handler","tag:",n,"owner:",i,"dataValue:",r),this.emit(Jn.timedMetadata,a)}},e.prototype.timeUpdateHandler=function(t){var e=t.currentMediaTime;this.emit(Jn.currentTime,e)},e.prototype.playingHandler=function(t){var e=t.currentMediaTime;this.emit(Jn.playing,e)},e.prototype.pauseHandler=function(t){var e=t.currentMediaTime;this.emit(Jn.pause,e)},e.prototype.mediaFinishedHandler=function(t){b.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",t),this.emit(Jn.stop),this.cleanup()},e.prototype.stop=function(t){t&&b.warn("ChromecastPlayerAdaptor.stop",t.message)},e.prototype.cleanup=function(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))},e}(Z),Xn=function(t){function e(e){var n=t.call(this)||this;return n.nativePlayer=e,n.bindEventListeners(),n}return k(e,t),e.prototype.bindEventListeners=function(){var t=this;this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeek=this.onSeek.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeek),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeUpdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.textTracks.onaddtrack=function(e){var n=e.track;n&&"metadata"===n.kind&&n.addEventListener("cuechange",(function(e){var n=e.target;if(n&&"metadata"===n.kind){for(var i=[],r=0;r<n.activeCues.length;r++){var a=n.activeCues[r];i.push(a.value)}i.map((function(e){var n=e.key,i=e.info,r=e.data;r instanceof ArrayBuffer&&(r=String.fromCharCode.apply(null,new Uint8Array(r)));var a=new Kn(n,i,r);b.trace("HTML5PlayerAdaptor timedMetadata",a),t.emit(Jn.timedMetadata,a)}))}}))}):b.error("Native Player wasn't passed to HTML5PlayerAdaptor")},e.prototype.onPlay=function(t){this.emit(Jn.start,t.timeStamp)},e.prototype.onPause=function(){this.emit(Jn.pause)},e.prototype.onSeek=function(){this.emit(Jn.seeking)},e.prototype.onError=function(){this.emit(Jn.stop),this.cleanup()},e.prototype.onCurrentTime=function(t){this.emit(Jn.currentTime,t.timeStamp)},e.prototype.onStalled=function(t){this.emit(Jn.stalled,t.timeStamp)},e.prototype.stop=function(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(Jn.stop),this.cleanup()},e.prototype.cleanup=function(){this.nativePlayer.removeEventListener("play",this.onPlay),this.nativePlayer.removeEventListener("pause",this.onPause),this.nativePlayer.removeEventListener("error",this.onError),this.nativePlayer.removeEventListener("seeking",this.onSeek),this.nativePlayer.removeEventListener("stalled",this.onStalled),this.nativePlayer.removeEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.removeEventListener("ended",this.stop)},e}(Z);!function(t){t.opened="opened",t.playing="playing",t.ended="ended",t.timedMetadata="timedMetadata",t.error="error",t.timeUpdate="timeUpdate",t.stalled="stalled",t.paused="paused",t.seeking="seeking"}(Gn||(Gn={}));var Zn,$n=Gn,ti=function(t){function e(e,n){var i=t.call(this)||this;if(!e)throw new Error("nativePlayer must be supplied");return i.nativePlayer=e,i.bus=n,i.bindEventListeners(),i}return k(e,t),e.prototype.bindEventListeners=function(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on($n.opened,this.onOpened),this.bus.on($n.playing,this.onPlaying),this.bus.on($n.paused,this.onPaused),this.bus.on($n.timedMetadata,this.onTimedMetadata),this.bus.on($n.ended,this.onEnded),this.bus.on($n.error,this.onError),this.bus.on($n.timeUpdate,this.onTimeUpdate),this.bus.on($n.stalled,this.onStalled),this.bus.on($n.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)},e.prototype.onSeeking=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onSeeking",t),this.emit(Jn.seeking,t)},e.prototype.onStalled=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onStalled",t),this.emit(Jn.stalled,t)},e.prototype.onTimeUpdate=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onTimeUpdate",t),this.emit(Jn.currentTime,t)},e.prototype.onError=function(t){b.debug("TrilithiumPlayerAdaptor.onError",t),this.emit(Jn.stop),this.cleanup()},e.prototype.onEnded=function(){this.emit(Jn.stop),this.cleanup()},e.prototype.onTimedMetadata=function(t,e,n){var i=e,r=n.toString(),a=N.stringify(M.parse(n.toString("base64"))),o=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;b.debug("TrilithiumPlayerAdaptor.onTimedMetadata "+i+" "+r+" "+o);var s=new Kn(i,r,o);this.emit(Jn.timedMetadata,s)},e.prototype.onOpened=function(t){t&&(b.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(Jn.start))},e.prototype.onPlaying=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onPlaying",t),this.emit(Jn.playing,t)},e.prototype.onPaused=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onPaused",t),this.emit(Jn.pause,t)},e.prototype.stop=function(t){t&&b.warn("TrilithiumPlayerAdaptor.stop",t.message)},e.prototype.cleanup=function(){this.bus&&(this.bus.off($n.opened),this.bus.off($n.playing),this.bus.off($n.timedMetadata),this.bus.off($n.ended),this.bus.off($n.error),this.bus.off($n.timeUpdate),this.bus.off($n.stalled))},e}(Z),ei=function(){function t(n,i){e(this,t),this.mediaItem=n,this.mediaItemDataSource=i}return i(t,[{key:"start",value:function(){var t=this;this.mediaItem.isLinear&&this.mediaItem.isLive&&(this._intervalId=setInterval((function(){t._checkProgramChange()}),6e4))}},{key:"stop",value:function(){this._intervalId&&clearInterval(this._intervalId)}},{key:"_checkProgramChange",value:function(){var t=this;if(this.mediaItem&&this.mediaItemDataSource){var e=this.mediaItem.network&&this.mediaItem.network.id;if(e){var n=jt.identifierStringForNetwork(e);this.mediaItemDataSource.getMediaItems([n]).then((function(e){var n=e[0];n&&(t.mediaItem.id!==n.id&&t.mediaItem.references.simulcastAiringId!==n.references.simulcastAiringId&&(t.mediaItem=n,t.onProgramChange(n)))}))}}}},{key:"onProgramChange",value:function(t){}}]),t}(),ni=function(t){function n(t,i,r,a){var o;e(this,n);var s=ct.apiKey;(o=l(this,c(n).call(this,t,i))).nielsenTrackingManager=a;var u=new un,d=function(){var t={apiKey:s,serviceUrl:un.defaultServiceUrl},e=it.shared.getConfiguration("shield",t);u.apiKey=e.apiKey,u.serviceUrl=e.serviceUrl};return d(),it.shared.on(nt.updated,d),o.shield=u,o}return u(n,t),n}(function(){function t(n,i){var a=this;e(this,t),r(this,"shield",void 0),r(this,"nielsenTrackingManager",void 0),this.session=We.fromObject(n)||n,this.playerAdaptor=i,this.initConcurrencyMonitor(),this.initProgramChangeMonitor(),this.playerAdaptor.on(Jn.start,(function(){b.debug("PlaybackManager.start"),a.programChangeMonitor.start()})),this.playerAdaptor.on(Jn.stop,(function(){b.debug("PlaybackManager.stop"),a.cleanup()}))}return i(t,[{key:"initConcurrencyMonitor",value:function(){var t,e=this,n=this.session;n.concurrencyMonitorSessionId&&(t=On.getBuilder().withSession(n).build())&&t.startWithSession(n.concurrencyMonitorSessionId),t&&(t.onError=function(t,n){e.playerAdaptor.stop(t),e.onStop(t),n&&e.onDeauthenticate(Tt.mvpd)},this.adobeConcurrencyMonitor=t)}},{key:"initProgramChangeMonitor",value:function(){var t=this,e=new Qt,n=new ei(this.session.mediaItem,e);n.onProgramChange=function(e){var n=t.session.token,i=e.mrss;if(n){var r=t.shield;r?r.getAsset(e.id,n,"GATEKEEPER",i,drmSupport,{}).then((function(n){n&&(t.session.mediaItem=e,t.session.token=n.gatekeeperToken,t.nielsenTrackingManager&&(t.nielsenTrackingManager.mediaItem=e),t.onUpdatedMediaItem(e))})).catch((function(e){t.playerAdaptor.stop(e),t.onStop(e)})):b.warn("shield support not configured")}else b.warn("token missing. skipping program change re-auth.")},this.programChangeMonitor=n}},{key:"cleanup",value:function(){b.debug("PlaybackManager.cleanup"),this.playerAdaptor.off(Jn.start),this.playerAdaptor.off(Jn.stop),this.adobeConcurrencyMonitor&&this.adobeConcurrencyMonitor.stop(),this.programChangeMonitor&&this.programChangeMonitor.stop(),this.nielsenTrackingManager&&this.nielsenTrackingManager.stop()}},{key:"onDeauthenticate",value:function(t){}},{key:"onUpdatedMediaItem",value:function(t){}},{key:"onStop",value:function(t){}}]),t}());!function(t){t[t.all=0]="all",t[t.linearPlayback=1]="linearPlayback"}(Zn||(Zn={}));var ii,ri=Zn;!function(t){t.linear="linear",t.event="event"}(ii||(ii={}));var ai,oi=ii;!function(t){t.stitchedPreroll="stitchedPreroll"}(ai||(ai={}));var si,ui=ai;!function(t){t.live="live",t.onDemand="onDemand"}(si||(si={}));var ci,di=si;!function(t){t.nielsen="nielsen",t.comscore="comscore",t.conviva="conviva",t.heartbeats="heartbeats"}(ci||(ci={}));var li,hi=ci;!function(t){t.shortform="shortform",t.longform="longform"}(li||(li={}));var pi,fi=li;!function(t){t.audio="audio",t.video="video"}(pi||(pi={}));var vi,gi=pi;!function(t){t.pluto="pluto",t.graphQL="graphQL",t.cfa="cfa"}(vi||(vi={}));var yi,mi=vi;!function(t){t.open="OPEN",t.direct="DIRECT",t.mvpd="MVPD",t.isp="ISP",t.none="NONE"}(yi||(yi={}));var bi,Pi=yi;!function(t){t.none="none",t.startSession="startSession",t.bam="bam",t.shield="shield",t.entitlement="entitlement"}(bi||(bi={}));var wi=bi,Ii=function(){function t(t,e,n,i,r,a,o){this.url=t,this.type=e,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=o,this.variant=null}return t.fromObject=function(e){if(!e)return null;var n=e.url,i=e.type,r=e.hasEspnId3Heartbeats,a=e.hasNielsenWatermarks,o=e.hasPassThroughAds,s=e.commercialReplacement,u=e.startSessionUrl;return new t(n,wi[i],r,a,o,s,u)},t}(),Ai=function(){function t(t,e,n,i){this.id=t,this.type=e,this.name=n,this.resource=i}return t.fromObject=function(e){if(!e)return null;var n=oi[e.type];return new t(e.id,n,e.name,e.resource)},t}(),_i=function(){function t(t){this.url=t}return t.fromObject=function(e){return e&&e.url?new t(e.url):null},t}(),ki=function(){function t(t){this.name=t}return Object.defineProperty(t.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!0,configurable:!0}),t.fromObject=function(e){return e?new t(e.name):null},t}(),Si=function(){function t(t,e,n,i,r){this.id=t,this.title=e,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=ri.all,this.images=[],this.type=gi.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null}return Object.defineProperty(t.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===oi.linear},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLive",{get:function(){return this.streamType===di.live},enumerable:!0,configurable:!0}),t.fromObject=function(e){var n=Ii.fromObject(e.source),i=new t(e.id,e.title,e.duration,e.language,n);return i.authenticationTypes=e.authenticationTypes,i.description=e.description,i.images=(e.images||[]).map((function(t){return _i.fromObject(t)})),i.mrss=e.mrss,i.network=Ai.fromObject(e.network),i.seekInSeconds=e.seekInSeconds,i.streamType=di[e.streamType],i.supportedMediaCommands=e.supportedMediaCommands,i.tracking=e.tracking,i.references=e.references,i.packages=(e.packages||[]).map((function(t){return ki.fromObject(t)})),i.type=gi[e.type],i.entityType=fi[e.entityType],i.isSyndicatable=e.isSyndicatable,i.brand=e.brand,i},t.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},t}();var Ti=function(){function t(t){var e=function(t){var e=t.split("?")[1],n={};if(e)for(var i=e.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(t);if(this.original=t,this.id=e.videoID||e.playID||e.clip||e.externalId,t.match("sportscenter")){this.gameId=e.playGameID,this.channel=e.playChannel,this.simulcastAiringId=e.simulcastAiringId;var n=parseInt(e.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=e.eventId}this.source=e["x-source"],e.videoID?this.entityType=fi.shortform:this.entityType=fi.longform,this.type=gi.video}return t.prototype.toString=function(t){return t==mi.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},t.identifierStringForNetwork=function(t,e){return e==mi.graphQL?"sportscenter://x-callback-url/showWatchStream?playChannel="+t:"natgeo://playVideo?videoID="+t},t}();function Ei(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function Ci(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function Oi(t,e,n,i){if(!e)return{};var r,a,o,s=null;t===Ut.natGeo?s=function(t){if(!t)return{};var e={},n=t.id,i=t.title,r=t.duration;return e.c_video_id_code=n,e.c_a_media_airdate="unknown",e.c_a_media_daypart="daytime",e.c_a_media_digitaldate="unknown",e.c_a_media_episode="none",e.c_a_media_feed="natgeo live",e.c_a_media_format="vod",e.c_a_media_genre="none",e.c_a_media_network="natgeo",e.c_a_media_originator="natgeo",e.c_a_media_pass_auth="none",e.c_a_media_pass_mvpd="none",e.c_a_media_rating="none",e.c_a_media_season="none",e.c_a_media_show=i,e.c_a_media_streamtype=pi.video,e.c_a_media_length=r,e}(e):(r=function(t,e,n){if(!t)return{};var i=t.duration,r=t.id,a=t.league,o=t.name,s=t.network,u=t.program,c=t.sport,d=t.startDateTime,l=t.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=l&&l.trackingId||r,p.program=o,p.title=o,p.clientid="us-600140",e===fi.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(u&&u.code||"")+(c&&c.code||""),d){var f=new Date(d);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=l&&l.nielsenCrossId1||"",p.crossId2=s&&s.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return e===fi.shortform&&(p.accmethod="1",p.length=""+i,p.segA=o,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(e,n,i),a=function(t,e){if(!t)return{};var n=t.id,i=t.duration,r=t.name,a=t.league,o=t.startDateTime,s=t.network,u=t.sport,c=t.status,d=t.tracking,l={};if(e===fi.longform)l.ns_st_cl=0,l.ns_st_ct="vc",!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?(l.ns_st_cl=i,l.ns_st_ct="vc12",l.ns_st_pr="VOD",l.ns_st_ep=r):(l.ns_st_cl=0,l.ns_st_ct="vc13",l.ns_st_pr=r,l.ns_st_ep="*null"),l.c3="WATCHESPNLIVE",l.c6=a&&a.name?a||"No league":u&&u.code||"No Sport";else{l.ns_st_cl=i,l.ns_st_ct="vc11",l.ns_st_pr="VOD",l.ns_st_ep=r;var h=d||{},p=h.sportName,f=h.leagueName;l.c3="vod",l.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(l.ns_st_ti="*null",l.ns_st_ia="*null",l.ns_st_ce="*null",l.ns_st_ci=n,o){var v=new Date(o);l.ns_st_ddt=v.toDateString(),l.ns_st_tdt=v.toDateString()}return l.ns_st_st=s?s.id:"*null",l.ns_st_en="*null",l.ns_st_cn="1",l.ns_st_pn="1",l.ns_st_tp="1",l.ns_st_pu="ESPN",l.ns_st_cu="none",l.ns_st_ad="0",l.ns_st_ge="Sports",l}(e,n),o=function(t,e,n){if(!t)return{};var i=t.name,r=t.id,a=t.airingId,o=t.eventId,s=t.duration,u=t.network,c=t.status,d=i+" - "+r;u&&u.type===oi.linear&&(d=u.id);var l={};return l.contentId=r,a&&(l.airingId=a),o&&(l.eventId=""+o,l.eventName=i),u&&(l.network=u.id),e===fi.shortform?l.assetType="clip":!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?l.assetType="vod":l.assetType="live",l.appBrand=Ut.espn,{assetName:d,duration:s,streamUrl:n&&n.url,custom:l}}(e,n,i),s=function(t,e){if(!t)return{};var n=t.duration,i=t.airingId,r=t.network,a=t.status,o=t.sport,s=t.league,u=t.program,c=t.startDateTime,d=t.tracking,l=t.originalPublishDate,h=t.expirationDate,p=t.lastModifiedDate,f=t.ad,v=t.coverageType,g={};if(g.ContentDuration=n,e===fi.longform){if(g.isFullEpisode="y",i&&(g.AiringID=i),r&&(g.NetworkName=r.id,g.Channel=r.id),a&&(g.VideoType="REPLAY"===a?"replay":"live"),g.Sport=o&&o.name||"Not Applicable",g.SportCode=o&&o.code||"Not Applicable",g.League=s&&s.name||"Not Applicable",u&&u.code&&u.categoryCode?g.ProgramCode=u.categoryCode+u.code:g.ProgramCode="Not Applicable",g.IsStudio=u&&u.isStudio||"Not Applicable",c){var y=new Date(c);g.AirDate=y.toDateString(),g.AirTime=y.toTimeString()}}else if(e===fi.shortform){if(g.isFullEpisode="n",g.VideoType="vod",g.Sport=d&&d.sportName||"Not Applicable",g.League=d&&d.leagueName||"Not Applicable",g.ShowCode=f&&f.bundle||"Not Applicable",d&&d.name&&(g.CMSID=d.name),l){y=new Date(l);g.PublishDate=y.toISOString().substring(0,10),g.PublishTime=y.toISOString().substring(11)}if(h){y=new Date(h);g.ExpirationDate=y.toISOString()}if(p){y=new Date(p);g.DateLastModified=y.toISOString()}v&&(g.VideoTypeDetail=v)}return g}(e,n));var u={};return u[hi.nielsen]=r,u[hi.comscore]=a,u[hi.conviva]=o,u[hi.heartbeats]=s,u}function Di(t,e,n){return t.sort((function(t,e){var n="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2,i="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(t,n){var i=t.network&&t.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=e.indexOf(i),o=e.indexOf(r);return-1===a&&(a=999),-1===o&&(o=999),a<o?-1:a>o?1:0})).sort((function(t,e){var i=t.language===n?0:1,r=e.language===n?0:1;return i<r?-1:i<r?1:0}))}var Mi="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName }",Ni="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}";var Ui="https://web.archive.org/web/20201104011859/https://watch.graph.api.espn.com/api",ji="d15c5790-7cb0-4fe1-8782-25f4698d0739",Li=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Ri="https://web.archive.org/web/20201104011859/https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock",xi=function(t,e,n,i){t==mi.graphQL?(this.serviceUrl=e||Ui,this.apiKey=n||ji,this.networkSortOrder=i||Li):t==mi.cfa&&(this.serviceUrl=e||Ri)};!function(){function t(){this.configuration_=t.defaultConfiguration}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return Ei(this,void 0,void 0,(function(){return Ci(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return Ei(this,void 0,void 0,(function(){var r,a,o,s,u,c;return Ci(this,(function(d){switch(d.label){case 0:return r=e.map((function(t){return new Ti(t)})),a=i.serviceUrl,o=i.apiKey,s=i.networkSortOrder,[4,w.all(r.map((function(e){return t.getPromiseMediaItems(e,a,o,n)})))];case 1:return u=d.sent(),(c=u.filter((function(t){return!(t instanceof Error)&&t instanceof Si}))).length?[2,Di(c,s,navigator.language)]:[2,null]}}))}))},t.getPromiseMediaItems=function(e,n,i,r){return Ei(this,void 0,void 0,(function(){var a,o,s,u,c,d,l,h,p,f,v,g;return Ci(this,(function(y){switch(y.label){case 0:a=function(t,e,n,i){var r="",a="",o="",s=i||"US";return t.entityType===fi.shortform?(r="VOD",o=Ni,a='id:"'+t.id+'"'):(r="airing",o=Mi,t.id?a='id:"'+t.id+'"':t.channel?(r="airings",a='networks:["'+t.channel+'"],type:LIVE'):t.gameId&&(r="airings",a='eventId:"'+(t.eventId||t.gameId)+'"')),e+"?apiKey="+n+"&query="+("airings"===r?encodeURIComponent("{ "+r+"("+a+',countryCode:"'+s+'",deviceType:SETTOP,tz:"Z") '+o+" }"):encodeURIComponent("{ "+r+"("+a+',deviceType:SETTOP,tz:"Z") '+o+" }"))}(e,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,A(a)];case 2:return[4,y.sent().json()];case 3:if(o=y.sent(),s=o.data.airing,(u=o.data.airings)&&(c=e.simulcastAiringId?function(t){return t.simulcastAiringId===e.simulcastAiringId}:function(){return!0},s=u.filter(c)[0]),d=o.data.VOD,!(l=s||d))throw new Error("No results found.");if(h=function(t,e,n){var i=t.id,r=t.name,a=t.description,o=t.duration,s=t.image,u=t.eventId,c=t.requiresLinearPlayback,d=t.authTypes,l=t.source,h=t.prerollSource,p=t.packages,f=t.language,v=t.mrss,g=t.seekInSeconds,y=t.tracking,m=t.simulcastAiringId,b=t.network,P=t.status,w=t.cerebroId,I=t.syndicatable,A=P&&("LIVE"===P.toUpperCase()||"OVER"===P.toUpperCase())?di.live:di.onDemand,_=function(t){switch(t){case"NONE":return wi.none;case"START_SESSION":return wi.startSession;case"BAM":return wi.bam;case"SHIELD":return wi.shield}}(l.authorizationType),k=new Ii(l.url,_,l.hasEspnId3Heartbeats,l.hasNielsenWatermarks,l.hasPassThroughAds,l.commercialReplacement,l.startSessionUrl);n&&n.sourceVariant===ui.stitchedPreroll&&h&&((k=new Ii(h.url,wi.none)).variant=ui.stitchedPreroll);var S=c?ri.linearPlayback:ri.all,T=y&&y.trackingId||i,E=new Si(i,r,o,f,k);if(E.authenticationTypes=d.map((function(t){switch(t){case"DIRECT":return Pi.direct;case"OPEN":return Pi.open;case"MVPD":return Pi.mvpd;case"ISP":return Pi.isp;default:return Pi.none}})),E.description=a,E.isSyndicatable=I,s&&s.url&&E.images.push(new _i(s.url)),E.mrss=v,b){var C="linear"===b.type?oi.linear:oi.event;E.network=new Ai(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=A,E.supportedMediaCommands=S,E.brand=E.brand?E.brand:"espn",E.tracking=Oi(E.brand,t,e,k),E.references={eventId:u,simulcastAiringId:m,trackingId:T,cerebroId:w},E.type=gi.video,E.entityType=e,E.apiSource=mi.graphQL,E.packages=(p||[]).map((function(t){return new ki(t.name)})),E}(l,e.entityType,r),e.resumeTime&&(h.seekInSeconds=e.resumeTime),!h.source.url){if(p="OVER"===l.status.toUpperCase(),f=l.network&&l.network.type===oi.linear,v=l.network&&l.network.id,p&&f&&v)return[2,t.retryGetMediaItems(v,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),b.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},t.retryGetMediaItems=function(e,n,i,r){return Ei(this,void 0,void 0,(function(){var a,o,s,u;return Ci(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),a=Ti.identifierStringForNetwork(e,mi.graphQL),o=new Ti(a),[4,t.getPromiseMediaItems(o,n,i,r)];case 1:if((s=c.sent())&&s instanceof Si==!0)return[2,s];throw new Error("Retry fetchMediaItems failed with "+e);case 2:return u=c.sent(),b.warn("MediaItem is over and retry failed: "+u),[2,null];case 3:return[2]}}))}))},t.defaultConfiguration=new xi(mi.graphQL)}();var zi;!function(){function t(){this.configuration_=t.defaultConfiguration}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return Ei(this,void 0,void 0,(function(){return Ci(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return Ei(this,void 0,void 0,(function(){var n,r;return Ci(this,(function(a){switch(a.label){case 0:return n=e.map((function(t){return new Ti(t)})),r=i.serviceUrl,[4,w.all(n.map((function(e){return t.getPromiseMediaItem(e,r)})))];case 1:return[2,a.sent().filter((function(t){return!(t instanceof Error)&&t instanceof Si}))]}}))}))},t.getPromiseMediaItem=function(t,e){return Ei(this,void 0,void 0,(function(){var n,i,r;return Ci(this,(function(a){switch(a.label){case 0:n=e.replace("videoID",t.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,A(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(t){var e=t.id,n=t.title,i=t.description,r=t.duration,a=t.source,o=t.type,s=t.entityType,u=t.streamType,c=t.authenticationTypes,d=t.language,l=t.network,h=t.brand,p=t.images,f=s,v=a.type,g=new Ii(a.url,v),y=new Si(e,n,r,d,g);return y.authenticationTypes=c.map((function(t){switch(t){case"DIRECT":return Pi.direct;case"OPEN":return Pi.open;case"MVPD":return Pi.mvpd;case"ISP":return Pi.isp;default:return Pi.none}})),y.description=i,l&&(y.network=new Ai(l.id,l.type,l.name,l.resource)),y.streamType=u,y.brand=h,y.tracking=Oi(y.brand,t,f,g),y.images=p,y.type=o,y.entityType=f,y.apiSource=mi.cfa,y}(i)];case 4:return r=a.sent(),b.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},t.defaultConfiguration=new xi(mi.cfa)}();!function(t){t.localStorage="LOCAL_STORAGE",t.sessionStorage="SESSION_STORAGE"}(zi||(zi={}));var Hi,Bi=function(){function t(t,e,n,i){this.id=t,this.name=e,this.logoUrl=n,this.websiteUrl=i}return t.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},t.fromObject=function(e){return new t(e.id,e.name,e.logoUrl,e.websiteUrl)},t}();!function(t){t.token="token",t.tokenType="tokenType",t.resource="resource",t.requestor="requestor"}(Hi||(Hi={}));var Vi,Fi,Ki=function(){function t(t,e,n,i){void 0===i&&(i={}),this.authenticationType=t,this.authenticatedProvider=e,this.authenticatedIdentity=n,this.customData=i}return t.CustomDataKey=Hi,t}(),Gi=function(t,e){this.success=t,this.payload=e};!function(t){t.standard="default",t.googleAdManager="gam"}(Vi||(Vi={})),function(t){t.standard="default",t.prod="prod",t.development="dev"}(Fi||(Fi={}));var Ji=function(){function t(t,e){this.id=t,this.tier=e}return t.prototype.toString=function(){return"<AuthenticatedPackage id:"+this.id+", tier:"+this.tier+">"},t.fromObject=function(e){return new t(e.id,e.tier)},t}();var qi,Wi=new function(t,e,n,i){this.preauthorizedNetworksEnabled=t,this.preauthorizedNetworks=e,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),Yi=(function(){function t(t,e,n,i){void 0===i&&(i={}),this.partner=t,this.platform=e,this.requestorId=n,this.options=i,this.adobePass=null,this.providerDataSource=null,this.configuration=Wi}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.isAuthenticated")},set:function(t){localStorage.setItem("AdobePassAuthenticator.isAuthenticated",JSON.stringify(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("AdobePassAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedIdentity",t):localStorage.removeItem("AdobePassAuthenticator.authenticatedIdentity")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedPackage",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedPackage");try{return Ji.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedPackage",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedPackage")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedProvider");try{return Bi.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedProvider")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasPreviouslyAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.wasPreviouslyAuthenticated")||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){if(!this.isAuthenticated)return[];var t=localStorage.getItem("AdobePassAuthenticator.preauthorizedResources");try{return JSON.parse(t)}catch(t){return[]}},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this;b.debug("AdobePassAuthenticator.checkAuthentication");var e=this.adobePass;return e?e.checkAuthentication().then((function(n){return t.isAuthenticated=n,n?(localStorage.setItem("AdobePassAuthenticator.wasPreviouslyAuthenticated","true"),t.getPreauthorizedResources().then((function(t){localStorage.setItem("AdobePassAuthenticator.preauthorizedResources",JSON.stringify(t))})),e.getUserMetadata().then((function(e){var n=e.data,i=n.upstreamUserID,r=n.mvpd,a=n.packageId,o=n.tier;return t.authenticatedIdentity=i,(a||o)&&(t.authenticatedPackage=new Ji(a,o)),t.providerDataSource?t.providerDataSource.getProvider(r).then((function(e){var n=e.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new Bi(r,e.name,n,e.websiteUrl),!0})).catch((function(){return t.authenticatedProvider=new Bi(r,r,null,null),!0})):(t.authenticatedProvider=new Bi(r,r,null,null),w.resolve(!0))}))):(t.authenticatedIdentity=null,t.authenticatedProvider=null,t.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources"),w.resolve(!1))})).catch((function(){return w.resolve(!1)})):w.resolve(!1)},t.prototype.authenticate=function(){var t=this;if(!this.currentRegistrationCode)return w.reject(new Error("Use getRegistrationCode first."));b.debug("AdobePassAuthenticator.authenticate currentRegistrationCode: "+this.currentRegistrationCode.code);var e=this.currentRegistrationCode.expires;return e&&Date.now()>e?w.reject(new Error("Your activation code has expired.")):new w((function(e,n){t.authenticateTimer_=setTimeout((function(){t.checkAuthentication().then((function(t){e(t)})).catch((function(t){n(t)}))}),5e3)})).then((function(e){return e||t.authenticate()}))},t.prototype.cancelAuthenticate=function(){b.debug("AdobePassAuthenticator.cancelAuthenticate"),this.authenticateTimer_&&clearTimeout(this.authenticateTimer_)},t.prototype.deauthenticate=function(){this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources");var t=this.adobePass;return t?t.logout():w.resolve(!1)},t.prototype.getRegistrationCode=function(){var t=this;b.debug("AdobePassAuthenticator.getRegistrationCode");var e=this.adobePass;return e?e.createRegistrationCode().then((function(e){return t.currentRegistrationCode=e,e?e.code:""})):w.reject(new Error("adobe pass not configured"))},t.prototype.checkAuthorization=function(t){var e=this;if(-1===t.authenticationTypes.indexOf(Pi.mvpd)||!this.isAuthenticated)return w.resolve(new Gi(!1,null));var n=t.mrss,i=this.authenticatedPackage&&this.authenticatedPackage.id;i&&(n=function(t,e,n){if(!t||!e||!n)return t;var i="</item></channel></rss>",r=-1;return-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:affiliateId>"+e+"</shield:affiliateId>"+t.slice(r)),-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:airingId")&&-1!==t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:airingId>"+n+"</shield:airingId>"+t.slice(r)),t}(n,i,t.id));var r=n,a=this.adobePass;return a.authorize(r).then((function(){return a.getShortMediaToken(r)})).then((function(t){var n,i=t.serializedToken,a=((n={})[Ki.CustomDataKey.token]=i,n[Ki.CustomDataKey.tokenType]="ADOBEPASS",n[Ki.CustomDataKey.resource]=r,n[Ki.CustomDataKey.requestor]=e.requestorId,n),o=new Ki(Pi.mvpd,e.authenticatedProvider,e.authenticatedIdentity,a);return new Gi(!0,o)})).catch((function(t){try{return t.json().then((function(t){var n=e.configuration.adobeAuthErrorRegex,i=new RegExp(n),r=t.message,a=t.details,o=i.test(r),s=i.test(a),u="This channel is not part of your TV package.";return o?s||(u=a):u=r,w.reject(new Error(u))}))}catch(t){return w.reject(new Error("There was an unexpected error."))}}))},t.prototype.getPreauthorizedResources=function(){var t=this.configuration,e=t.preauthorizedNetworksEnabled,n=t.preauthorizedNetworks,i=t.preauthorizeNetworksMapping;if(!1===e){var r=n;return Object.keys(i).forEach((function(t){var e=i[t];-1!==r.indexOf(t)&&-1===r.indexOf(e)&&r.push(e)})),w.resolve(r)}return 0===n.length?w.resolve([]):this.adobePass.preauthorize(n).then((function(t){var e=t.resources.filter((function(t){return!0===t.authorized})).map((function(t){return t.id}));return Object.keys(i).forEach((function(t){var n=i[t];-1!==e.indexOf(t)&&-1===e.indexOf(n)&&e.push(n)})),e}))},t.defaultConfiguration=Wi}(),function(){function t(t,e,n,i,r,a,o,s){this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a,this.rank=o,this.availability=s,this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a||[],this.rank=o,this.availability=s}return t.prototype.getPreferredLogoUrl=function(t,e){var n=this.images.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.type}))[0],i=this.images.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.type}))[0]||n;return i?"https://web.archive.org/web/20201104011859/https://s.secure.espncdn.com/stitcher/watch/clients/"+t+"-"+e+"/providers/"+this.adobeId+".png?height=40&imageType="+i:this.images.filter((function(t){return"DESKTOP"===t.type})).map((function(t){return t.href}))[0]||null},t.prototype.toString=function(){return"<Provider id:"+this.id+", name:"+this.name+", adobeId:"+this.adobeId+">"},t}());!function(t){t.mvpd="mvpd",t.isp="isp"}(qi||(qi={}));var Qi=qi,Xi=function(t){this.serviceUrl=t,this.serviceUrl=t};function Zi(t,e){var n=t.tier||99,i=e.tier||99;if(n<i)return-1;if(n>i)return 1;var r=t.rank||9999,a=e.rank||9999;if(r<a)return-1;if(r>a)return 1;var o=t.name.toLowerCase(),s=e.name.toLowerCase();return o<s?-1:o>s?1:0}var $i={negativebgcolorImage:"COLOR_NEGATIVE",negativebgbwImage:"BW_NEGATIVE",positivebgcolorImage:"COLOR_POSITIVE",positivebgbwImage:"BW_POSITIVE",desktop:"DESKTOP"};function tr(t,e){if(!t)return null;var n=t.id,i=t.name,r=t.websiteUrl,a=t.adobeId,o=function(t){return Object.keys(t).filter((function(e){return $i[e]&&!!t[e]})).map((function(e){return{href:t[e].trim(),type:$i[e]}}))}(t.logos),s=t.countries.filter((function(t){return t.countryCode.toLowerCase()===e.toLowerCase()}))[0],u=s&&s.tier,c=s&&s.rank;return new Yi(n,i,a,u,r,o,c)}function er(t,e){return t.rows.map((function(t){return tr(t.data,e)})).sort(Zi)}var nr={};nr[Qi.mvpd]="adobeId",nr[Qi.isp]="ispId";var ir,rr=new Xi("https://web.archive.org/web/20201104011859/https://affiliate.api.espn.com/affiliateApi/affiliates?includeProperties=true&rows=1000&apikey=q458c7hcllto16w0wcjytqoxq"),ar=(function(){function t(t){this.locationProvider=t||{getCountryCode:function(){return"us"}},this.applicationId=null,this.configuration=rr}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applicationId",{get:function(){return this.applicationId_},set:function(t){this.applicationId_=t},enumerable:!0,configurable:!0}),t.prototype.getProvider=function(t,e,n){return void 0===n&&(n={}),Ei(this,void 0,void 0,(function(){var i,r,a,o;return Ci(this,(function(s){switch(s.label){case 0:return i=e||Qi.mvpd,r=nr[i]||"adobeId",n[r]=t,[4,this.getProviders(n)];case 1:if(a=s.sent(),!(o=a[0]))throw new Error("Unable to find provider.");return[2,o]}}))}))},t.prototype.getProviders=function(t){return void 0===t&&(t={}),Ei(this,void 0,void 0,(function(){var e,n,i,r,a,o;return Ci(this,(function(s){switch(s.label){case 0:e=this.configuration.serviceUrl,n=-1===e.indexOf("?")?"?":"&",i=this.applicationId,r=function(t){return-1!==["PR","GU","VI"].indexOf(t)?"US":t}(this.locationProvider.getCountryCode().toUpperCase()),i&&(t.application=i),t.country=r,a=Object.keys(t).map((function(e){return e+"="+encodeURIComponent(t[e])})).join("&"),o=""+e+n+a,s.label=1;case 1:return s.trys.push([1,4,,5]),[4,A(o)];case 2:return[4,s.sent().json()];case 3:return[2,er(s.sent(),r)];case 4:return s.sent(),[2,[]];case 5:return[2]}}))}))},t.defaultConfiguration=rr}(),function(){function t(t){this.authenticatedProviderId=null,this.providerDataSource=null,this.partner=t.partner,this.platform=t.platform}return Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return!!this.token&&!!this.tokenType},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("TokenAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedIdentity",t):localStorage.removeItem("TokenAuthenticator.authenticatedIdentity")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("TokenAuthenticator.authenticatedProvider");try{return Bi.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("TokenAuthenticator.authenticatedProvider")},enumerable:!0,configurable:!0}),t.prototype.setToken=function(t,e,n){this.token=t,this.tokenType=e,this.resource=n},t.prototype.checkAuthentication=function(){var t=this,e=this.authenticatedProviderId;if(!e||this.authenticatedProvider&&e===this.authenticatedProvider.id)return w.resolve(this.isAuthenticated);if(!this.providerDataSource)return this.authenticatedProvider=new Bi(e,e,null,null),w.resolve(this.isAuthenticated);var n,i="ADOBEPASS"===(n=this.tokenType)?Qi.mvpd:"DEVICE"===n?Qi.isp:null;return this.providerDataSource.getProvider(e,i).then((function(n){var i=n.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new Bi(e,n.name,i,n.websiteUrl),w.resolve(t.isAuthenticated)})).catch((function(){return t.authenticatedProvider=new Bi(e,e,null,null),w.resolve(t.isAuthenticated)}))},t.prototype.authenticate=function(t){var e=t.authenticatedProviderId,n=t.authenticatedIdentity,i=t.token,r=t.tokenType;return this.authenticatedProviderId=e,this.authenticatedIdentity=n,this.setToken(i,r,null),this.checkAuthentication()},t.prototype.deauthenticate=function(){return this.authenticatedProvider=null,this.authenticatedIdentity=null,this.token=null,this.tokenType=null,this.resource=null,w.resolve(!0)},t.prototype.checkAuthorization=function(t){var e,n,i="ADOBEPASS"===(n=this.tokenType)?Pi.mvpd:"DEVICE"===n?Pi.isp:"BAM"===n?Pi.direct:null;if(!this.isAuthenticated||-1===t.authenticationTypes.indexOf(i)&&"DEVICE"!==this.tokenType&&"GATEKEEPER"!==this.tokenType)return w.resolve(new Gi(!1,null));var r=((e={})[Ki.CustomDataKey.token]=this.token,e[Ki.CustomDataKey.tokenType]=this.tokenType,e);this.resource&&(r.resource=this.resource);var a=new Ki(i,this.authenticatedProvider,this.authenticatedIdentity,r),o=new Gi(!0,a);return w.resolve(o)},t}());function or(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function sr(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}!function(t){t.localStorage="LOCAL_STORAGE",t.sessionStorage="SESSION_STORAGE"}(ir||(ir={}));var ur,cr=function(){function t(t,e,n,i){this.id=t,this.name=e,this.logoUrl=n,this.websiteUrl=i}return t.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},t.fromObject=function(e){return new t(e.id,e.name,e.logoUrl,e.websiteUrl)},t}();!function(t){t.token="token",t.tokenType="tokenType",t.resource="resource",t.requestor="requestor"}(ur||(ur={}));var dr,lr,hr=function(){function t(t,e,n,i){void 0===i&&(i={}),this.authenticationType=t,this.authenticatedProvider=e,this.authenticatedIdentity=n,this.customData=i}return t.CustomDataKey=ur,t}(),pr=function(t,e){this.success=t,this.payload=e};!function(t){t.standard="default",t.googleAdManager="gam"}(dr||(dr={})),function(t){t.standard="default",t.prod="prod",t.development="dev"}(lr||(lr={}));var fr,vr="entitlements",gr=new function(t,e){void 0===e&&(e=vr),this.serviceUrl=t,this.entitlementsPath=e}("https://web.archive.org/web/20201104011859/https://tve.dtci.technology",vr);function yr(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function mr(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function br(t){var e=t.split("."),n=N.stringify(M.parse(e[1]));return JSON.parse(n)}!function(t){t.badToken="badToken",t.other="other"}(fr||(fr={}));var Pr,wr=function(){function t(t,e){void 0===e&&(e="entitlements"),this.serviceUrl=t,this.entitlementsPath=e}return t.prototype.getEntitlements=function(t){return yr(this,void 0,void 0,(function(){var e,n,i,r,a;return mr(this,(function(o){switch(o.label){case 0:e=this.serviceUrl+"/"+this.entitlementsPath,n={user_token:t},i=Object.keys(n).map((function(t){return t+"="+encodeURIComponent(n[t])})).join("&"),r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:i},o.label=1;case 1:return o.trys.push([1,4,,5]),[4,A(e,r)];case 2:return[4,o.sent().json()];case 3:return[2,o.sent()];case 4:return a=o.sent(),console.error("Error retrieving Entitlements from DTCITVEntitlementAPI: "+a),[3,5];case 5:return[2]}}))}))},t.prototype.logout=function(t,e,n){return yr(this,void 0,void 0,(function(){var i,r,a,o,s;return mr(this,(function(u){switch(u.label){case 0:i=this.serviceUrl+"/affiliates/"+t+"/logout",r={user_token:e},n&&(r.redirect_uri=n),a=Object.keys(r).map((function(t){return t+"="+encodeURIComponent(r[t])})).join("&"),o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:a},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,A(i,o)];case 2:return u.sent(),[2,!0];case 3:return s=u.sent(),console.error("Error logging out of affiliate account DTCITVEntitlementAPI: "+s),[2,!1];case 4:return[2]}}))}))},t.prototype.tokenIsValid=function(t){try{var e=br(t);if(!e.exp)return!0;var n=new Date;return!(new Date(e.exp)<n)}catch(t){return!1}},t}();!function(t){t[t.all=0]="all",t[t.linearPlayback=1]="linearPlayback"}(Pr||(Pr={}));var Ir,Ar=Pr;!function(t){t.linear="linear",t.event="event"}(Ir||(Ir={}));var _r,kr=Ir;!function(t){t.stitchedPreroll="stitchedPreroll"}(_r||(_r={}));var Sr,Tr=_r;!function(t){t.live="live",t.onDemand="onDemand"}(Sr||(Sr={}));var Er,Cr=Sr;!function(t){t.nielsen="nielsen",t.comscore="comscore",t.conviva="conviva",t.heartbeats="heartbeats"}(Er||(Er={}));var Or,Dr=Er;!function(t){t.shortform="shortform",t.longform="longform"}(Or||(Or={}));var Mr,Nr=Or;!function(t){t.audio="audio",t.video="video"}(Mr||(Mr={}));var Ur,jr=Mr;!function(t){t.pluto="pluto",t.graphQL="graphQL",t.cfa="cfa"}(Ur||(Ur={}));var Lr,Rr=Ur;!function(t){t.open="OPEN",t.direct="DIRECT",t.mvpd="MVPD",t.isp="ISP",t.none="NONE"}(Lr||(Lr={}));var xr,zr=Lr;!function(t){t.none="none",t.startSession="startSession",t.bam="bam",t.shield="shield",t.entitlement="entitlement"}(xr||(xr={}));var Hr=xr,Br=function(){function t(t,e,n,i,r,a,o){this.url=t,this.type=e,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=o,this.variant=null}return t.fromObject=function(e){if(!e)return null;var n=e.url,i=e.type,r=e.hasEspnId3Heartbeats,a=e.hasNielsenWatermarks,o=e.hasPassThroughAds,s=e.commercialReplacement,u=e.startSessionUrl;return new t(n,Hr[i],r,a,o,s,u)},t}(),Vr=function(){function t(t,e,n,i){this.id=t,this.type=e,this.name=n,this.resource=i}return t.fromObject=function(e){if(!e)return null;var n=kr[e.type];return new t(e.id,n,e.name,e.resource)},t}(),Fr=function(){function t(t){this.url=t}return t.fromObject=function(e){return e&&e.url?new t(e.url):null},t}(),Kr=function(){function t(t){this.name=t}return Object.defineProperty(t.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!0,configurable:!0}),t.fromObject=function(e){return e?new t(e.name):null},t}(),Gr=function(){function t(t,e,n,i,r){this.id=t,this.title=e,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=Ar.all,this.images=[],this.type=jr.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null}return Object.defineProperty(t.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===kr.linear},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLive",{get:function(){return this.streamType===Cr.live},enumerable:!0,configurable:!0}),t.fromObject=function(e){var n=Br.fromObject(e.source),i=new t(e.id,e.title,e.duration,e.language,n);return i.authenticationTypes=e.authenticationTypes,i.description=e.description,i.images=(e.images||[]).map((function(t){return Fr.fromObject(t)})),i.mrss=e.mrss,i.network=Vr.fromObject(e.network),i.seekInSeconds=e.seekInSeconds,i.streamType=Cr[e.streamType],i.supportedMediaCommands=e.supportedMediaCommands,i.tracking=e.tracking,i.references=e.references,i.packages=(e.packages||[]).map((function(t){return Kr.fromObject(t)})),i.type=jr[e.type],i.entityType=Nr[e.entityType],i.isSyndicatable=e.isSyndicatable,i.brand=e.brand,i},t.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},t}();var Jr=function(){function t(t){var e=function(t){var e=t.split("?")[1],n={};if(e)for(var i=e.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(t);if(this.original=t,this.id=e.videoID||e.playID||e.clip||e.externalId,t.match("sportscenter")){this.gameId=e.playGameID,this.channel=e.playChannel,this.simulcastAiringId=e.simulcastAiringId;var n=parseInt(e.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=e.eventId}this.source=e["x-source"],e.videoID?this.entityType=Nr.shortform:this.entityType=Nr.longform,this.type=jr.video}return t.prototype.toString=function(t){return t==Rr.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},t.identifierStringForNetwork=function(t,e){return e==Rr.graphQL?"sportscenter://x-callback-url/showWatchStream?playChannel="+t:"natgeo://playVideo?videoID="+t},t}();function qr(t,e,n,i){if(!e)return{};var r,a,o,s=null;t===Ut.natGeo?s=function(t){if(!t)return{};var e={},n=t.id,i=t.title,r=t.duration;return e.c_video_id_code=n,e.c_a_media_airdate="unknown",e.c_a_media_daypart="daytime",e.c_a_media_digitaldate="unknown",e.c_a_media_episode="none",e.c_a_media_feed="natgeo live",e.c_a_media_format="vod",e.c_a_media_genre="none",e.c_a_media_network="natgeo",e.c_a_media_originator="natgeo",e.c_a_media_pass_auth="none",e.c_a_media_pass_mvpd="none",e.c_a_media_rating="none",e.c_a_media_season="none",e.c_a_media_show=i,e.c_a_media_streamtype=Mr.video,e.c_a_media_length=r,e}(e):(r=function(t,e,n){if(!t)return{};var i=t.duration,r=t.id,a=t.league,o=t.name,s=t.network,u=t.program,c=t.sport,d=t.startDateTime,l=t.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=l&&l.trackingId||r,p.program=o,p.title=o,p.clientid="us-600140",e===Nr.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(u&&u.code||"")+(c&&c.code||""),d){var f=new Date(d);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=l&&l.nielsenCrossId1||"",p.crossId2=s&&s.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return e===Nr.shortform&&(p.accmethod="1",p.length=""+i,p.segA=o,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(e,n,i),a=function(t,e){if(!t)return{};var n=t.id,i=t.duration,r=t.name,a=t.league,o=t.startDateTime,s=t.network,u=t.sport,c=t.status,d=t.tracking,l={};if(e===Nr.longform)l.ns_st_cl=0,l.ns_st_ct="vc",!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?(l.ns_st_cl=i,l.ns_st_ct="vc12",l.ns_st_pr="VOD",l.ns_st_ep=r):(l.ns_st_cl=0,l.ns_st_ct="vc13",l.ns_st_pr=r,l.ns_st_ep="*null"),l.c3="WATCHESPNLIVE",l.c6=a&&a.name?a||"No league":u&&u.code||"No Sport";else{l.ns_st_cl=i,l.ns_st_ct="vc11",l.ns_st_pr="VOD",l.ns_st_ep=r;var h=d||{},p=h.sportName,f=h.leagueName;l.c3="vod",l.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(l.ns_st_ti="*null",l.ns_st_ia="*null",l.ns_st_ce="*null",l.ns_st_ci=n,o){var v=new Date(o);l.ns_st_ddt=v.toDateString(),l.ns_st_tdt=v.toDateString()}return l.ns_st_st=s?s.id:"*null",l.ns_st_en="*null",l.ns_st_cn="1",l.ns_st_pn="1",l.ns_st_tp="1",l.ns_st_pu="ESPN",l.ns_st_cu="none",l.ns_st_ad="0",l.ns_st_ge="Sports",l}(e,n),o=function(t,e,n){if(!t)return{};var i=t.name,r=t.id,a=t.airingId,o=t.eventId,s=t.duration,u=t.network,c=t.status,d=i+" - "+r;u&&u.type===kr.linear&&(d=u.id);var l={};return l.contentId=r,a&&(l.airingId=a),o&&(l.eventId=""+o,l.eventName=i),u&&(l.network=u.id),e===Nr.shortform?l.assetType="clip":!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?l.assetType="vod":l.assetType="live",l.appBrand=Ut.espn,{assetName:d,duration:s,streamUrl:n&&n.url,custom:l}}(e,n,i),s=function(t,e){if(!t)return{};var n=t.duration,i=t.airingId,r=t.network,a=t.status,o=t.sport,s=t.league,u=t.program,c=t.startDateTime,d=t.tracking,l=t.originalPublishDate,h=t.expirationDate,p=t.lastModifiedDate,f=t.ad,v=t.coverageType,g={};if(g.ContentDuration=n,e===Nr.longform){if(g.isFullEpisode="y",i&&(g.AiringID=i),r&&(g.NetworkName=r.id,g.Channel=r.id),a&&(g.VideoType="REPLAY"===a?"replay":"live"),g.Sport=o&&o.name||"Not Applicable",g.SportCode=o&&o.code||"Not Applicable",g.League=s&&s.name||"Not Applicable",u&&u.code&&u.categoryCode?g.ProgramCode=u.categoryCode+u.code:g.ProgramCode="Not Applicable",g.IsStudio=u&&u.isStudio||"Not Applicable",c){var y=new Date(c);g.AirDate=y.toDateString(),g.AirTime=y.toTimeString()}}else if(e===Nr.shortform){if(g.isFullEpisode="n",g.VideoType="vod",g.Sport=d&&d.sportName||"Not Applicable",g.League=d&&d.leagueName||"Not Applicable",g.ShowCode=f&&f.bundle||"Not Applicable",d&&d.name&&(g.CMSID=d.name),l){y=new Date(l);g.PublishDate=y.toISOString().substring(0,10),g.PublishTime=y.toISOString().substring(11)}if(h){y=new Date(h);g.ExpirationDate=y.toISOString()}if(p){y=new Date(p);g.DateLastModified=y.toISOString()}v&&(g.VideoTypeDetail=v)}return g}(e,n));var u={};return u[Dr.nielsen]=r,u[Dr.comscore]=a,u[Dr.conviva]=o,u[Dr.heartbeats]=s,u}function Wr(t,e,n){return t.sort((function(t,e){var n="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2,i="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(t,n){var i=t.network&&t.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=e.indexOf(i),o=e.indexOf(r);return-1===a&&(a=999),-1===o&&(o=999),a<o?-1:a>o?1:0})).sort((function(t,e){var i=t.language===n?0:1,r=e.language===n?0:1;return i<r?-1:i<r?1:0}))}var Yr="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName }",Qr="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}";var Xr="https://web.archive.org/web/20201104011859/https://watch.graph.api.espn.com/api",Zr="d15c5790-7cb0-4fe1-8782-25f4698d0739",$r=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],ta="https://web.archive.org/web/20201104011859/https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock",ea=function(t,e,n,i){t==Rr.graphQL?(this.serviceUrl=e||Xr,this.apiKey=n||Zr,this.networkSortOrder=i||$r):t==Rr.cfa&&(this.serviceUrl=e||ta)},na=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return or(this,void 0,void 0,(function(){return sr(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return or(this,void 0,void 0,(function(){var r,a,o,s,u,c;return sr(this,(function(d){switch(d.label){case 0:return r=e.map((function(t){return new Jr(t)})),a=i.serviceUrl,o=i.apiKey,s=i.networkSortOrder,[4,w.all(r.map((function(e){return t.getPromiseMediaItems(e,a,o,n)})))];case 1:return u=d.sent(),(c=u.filter((function(t){return!(t instanceof Error)&&t instanceof Gr}))).length?[2,Wr(c,s,navigator.language)]:[2,null]}}))}))},t.getPromiseMediaItems=function(e,n,i,r){return or(this,void 0,void 0,(function(){var a,o,s,u,c,d,l,h,p,f,v,g;return sr(this,(function(y){switch(y.label){case 0:a=function(t,e,n,i){var r="",a="",o="",s=i||"US";return t.entityType===Nr.shortform?(r="VOD",o=Qr,a='id:"'+t.id+'"'):(r="airing",o=Yr,t.id?a='id:"'+t.id+'"':t.channel?(r="airings",a='networks:["'+t.channel+'"],type:LIVE'):t.gameId&&(r="airings",a='eventId:"'+(t.eventId||t.gameId)+'"')),e+"?apiKey="+n+"&query="+("airings"===r?encodeURIComponent("{ "+r+"("+a+',countryCode:"'+s+'",deviceType:SETTOP,tz:"Z") '+o+" }"):encodeURIComponent("{ "+r+"("+a+',deviceType:SETTOP,tz:"Z") '+o+" }"))}(e,n,i,r.countryCode),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,A(a)];case 2:return[4,y.sent().json()];case 3:if(o=y.sent(),s=o.data.airing,(u=o.data.airings)&&(c=e.simulcastAiringId?function(t){return t.simulcastAiringId===e.simulcastAiringId}:function(){return!0},s=u.filter(c)[0]),d=o.data.VOD,!(l=s||d))throw new Error("No results found.");if(h=function(t,e,n){var i=t.id,r=t.name,a=t.description,o=t.duration,s=t.image,u=t.eventId,c=t.requiresLinearPlayback,d=t.authTypes,l=t.source,h=t.prerollSource,p=t.packages,f=t.language,v=t.mrss,g=t.seekInSeconds,y=t.tracking,m=t.simulcastAiringId,b=t.network,P=t.status,w=t.cerebroId,I=t.syndicatable,A=P&&("LIVE"===P.toUpperCase()||"OVER"===P.toUpperCase())?Cr.live:Cr.onDemand,_=function(t){switch(t){case"NONE":return Hr.none;case"START_SESSION":return Hr.startSession;case"BAM":return Hr.bam;case"SHIELD":return Hr.shield}}(l.authorizationType),k=new Br(l.url,_,l.hasEspnId3Heartbeats,l.hasNielsenWatermarks,l.hasPassThroughAds,l.commercialReplacement,l.startSessionUrl);n&&n.sourceVariant===Tr.stitchedPreroll&&h&&((k=new Br(h.url,Hr.none)).variant=Tr.stitchedPreroll);var S=c?Ar.linearPlayback:Ar.all,T=y&&y.trackingId||i,E=new Gr(i,r,o,f,k);if(E.authenticationTypes=d.map((function(t){switch(t){case"DIRECT":return zr.direct;case"OPEN":return zr.open;case"MVPD":return zr.mvpd;case"ISP":return zr.isp;default:return zr.none}})),E.description=a,E.isSyndicatable=I,s&&s.url&&E.images.push(new Fr(s.url)),E.mrss=v,b){var C="linear"===b.type?kr.linear:kr.event;E.network=new Vr(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=g,E.streamType=A,E.supportedMediaCommands=S,E.brand=E.brand?E.brand:"espn",E.tracking=qr(E.brand,t,e,k),E.references={eventId:u,simulcastAiringId:m,trackingId:T,cerebroId:w},E.type=jr.video,E.entityType=e,E.apiSource=Rr.graphQL,E.packages=(p||[]).map((function(t){return new Kr(t.name)})),E}(l,e.entityType,r),e.resumeTime&&(h.seekInSeconds=e.resumeTime),!h.source.url){if(p="OVER"===l.status.toUpperCase(),f=l.network&&l.network.type===kr.linear,v=l.network&&l.network.id,p&&f&&v)return[2,t.retryGetMediaItems(v,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return g=y.sent(),b.warn("Failed to retrieve MediaItem from GraphQL: "+g),[2,null];case 5:return[2]}}))}))},t.retryGetMediaItems=function(e,n,i,r){return or(this,void 0,void 0,(function(){var a,o,s,u;return sr(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),a=Jr.identifierStringForNetwork(e,Rr.graphQL),o=new Jr(a),[4,t.getPromiseMediaItems(o,n,i,r)];case 1:if((s=c.sent())&&s instanceof Gr==!0)return[2,s];throw new Error("Retry fetchMediaItems failed with "+e);case 2:return u=c.sent(),b.warn("MediaItem is over and retry failed: "+u),[2,null];case 3:return[2]}}))}))},t.defaultConfiguration=new ea(Rr.graphQL),t}();var ia=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return or(this,void 0,void 0,(function(){return sr(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return or(this,void 0,void 0,(function(){var n,r;return sr(this,(function(a){switch(a.label){case 0:return n=e.map((function(t){return new Jr(t)})),r=i.serviceUrl,[4,w.all(n.map((function(e){return t.getPromiseMediaItem(e,r)})))];case 1:return[2,a.sent().filter((function(t){return!(t instanceof Error)&&t instanceof Gr}))]}}))}))},t.getPromiseMediaItem=function(t,e){return or(this,void 0,void 0,(function(){var n,i,r;return sr(this,(function(a){switch(a.label){case 0:n=e.replace("videoID",t.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,A(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(t){var e=t.id,n=t.title,i=t.description,r=t.duration,a=t.source,o=t.type,s=t.entityType,u=t.streamType,c=t.authenticationTypes,d=t.language,l=t.network,h=t.brand,p=t.images,f=s,v=a.type,g=new Br(a.url,v),y=new Gr(e,n,r,d,g);return y.authenticationTypes=c.map((function(t){switch(t){case"DIRECT":return zr.direct;case"OPEN":return zr.open;case"MVPD":return zr.mvpd;case"ISP":return zr.isp;default:return zr.none}})),y.description=i,l&&(y.network=new Vr(l.id,l.type,l.name,l.resource)),y.streamType=u,y.brand=h,y.tracking=qr(y.brand,t,f,g),y.images=p,y.type=o,y.entityType=f,y.apiSource=Rr.cfa,y}(i)];case 4:return r=a.sent(),b.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},t.defaultConfiguration=new ea(Rr.cfa),t}(),ra=(function(){function t(){}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(t,e){return or(this,void 0,void 0,(function(){var n,i;return sr(this,(function(r){switch(r.label){case 0:return n=e||{sourceVariant:null},t[0].match("natgeo")?((i=new ia).configuration=this.configuration||i.configuration,[4,i.getMediaItems(t,n)]):[3,2];case 1:return[2,r.sent()];case 2:return(i=new na).configuration=this.configuration||i.configuration,[4,i.getMediaItems(t,n)];case 3:return[2,r.sent()]}}))}))}}(),"watchsdk.tve_authenticator.state"),aa=function(t,e){e.setItem(ra,JSON.stringify(t))},oa=function(t){function n(t,i){var r;return e(this,n),(r=l(this,c(n).call(this,t,i))).providerDataSource=new Cn(i),r}return u(n,t),n}(function(){function t(t,e){this.identityTokenProvider=t,this.locationProvider=e,this.authenticationUrl="https://web.archive.org/web/20201104011859/https://www.espn.com/watch/auth",this.edition="espn-nl-nl",this.storage=localStorage,this.tveAPI=new wr(gr.serviceUrl,gr.entitlementsPath),this.delegate=null,this.providerDataSource=null,window.displayProviderDialog=this.displayProviderDialog.bind(this);try{var n=this.storage.getItem(ra),i=JSON.parse(n);this.state_=i||{}}catch(t){}}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return this.state_.isAuthenticated},set:function(t){this.state_.isAuthenticated=t,aa(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){var t,e;return null===(e=null===(t=this.state_.entitlements)||void 0===t?void 0:t.accounts[0])||void 0===e?void 0:e.id},set:function(t){this.state_.authenticatedIdentity=t,aa(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(t){if(!t)return delete this.state_.authenticatedProvider,void aa(this.state_,this.storage);this.state_.authenticatedProvider=t,aa(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"entitlements",{get:function(){return this.state_.entitlements},set:function(t){if(!t)return delete this.state_.entitlements,void aa(this.state_,this.storage);this.state_.entitlements=t,aa(this.state_,this.storage)},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){return or(this,void 0,void 0,(function(){var t,e,n,i=this;return sr(this,(function(r){switch(r.label){case 0:return b.debug("TVEAuthenticator.checkAuthentication"),(t=this.identityTokenProvider.getIdentityToken())?(e=this,[4,this.tveAPI.getEntitlements(t)]):[2,w.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:return e.entitlements=r.sent(),this.entitlements?(n=this.entitlements.accounts[0])?(this.isAuthenticated=!(!t||!n),this.authenticatedProvider=new cr(n.affiliate.id,n.affiliate.name,null,null),this.providerDataSource?[2,this.providerDataSource.getProvider(n.affiliate.id,fe.tve).then((function(t){var e=t&&t.images||[],r=e.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.href}))[0],a=e.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.href}))[0]||r||e.map((function(t){return t.href}))[0];return i.authenticatedProvider=new cr(t.adobeId||n.affiliate.id,n.affiliate.name,a,t.websiteUrl),i.isAuthenticated})).catch((function(){return i.isAuthenticated}))]:[2,w.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,w.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,w.reject(new Error("TVEAuthenticator.NotEntitled"))])}}))}))},t.prototype.authenticate=function(t){var e=this,n=this.providerId,i=this.accessType,r=this.edition,a=t&&t.redirectUrl||window.location.href,o=this.identityTokenProvider.getIdentityToken();return new w((function(t){var s;if(e.resolveAuthenticate_=function(e){t(e)},!n)return e.redirectUrl=a,e.displayProviderDialog(),w.resolve(!1);var u=null===(s=e.locationProvider.getCountryCode())||void 0===s?void 0:s.toLowerCase(),c={mvpd:n,redirectUrl:a,country:u};r&&(c["edition-view"]=r),i&&(c.accessType=i);var d=Object.keys(c).map((function(t){return t+"="+encodeURIComponent(c[t])})).join("&"),l=-1===e.authenticationUrl.indexOf("?")?"?":"&",h=""+e.authenticationUrl+l+d;o&&(h=h+"#oneIdToken="+o),window.location.href=h}))},t.prototype.deauthenticate=function(){var t=this.entitlements.accounts[0].affiliate.id,e=this.identityTokenProvider.getIdentityToken();return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.entitlements=null,e?this.tveAPI.logout(t,e,null).catch((function(){return!0})):w.resolve(!0)},t.prototype.checkAuthorization=function(){return or(this,void 0,void 0,(function(){var t,e,n,i,r,a;return sr(this,(function(o){switch(o.label){case 0:return(t=this.identityTokenProvider.getIdentityToken())?this.isAuthenticated?this.entitlements&&this.tveAPI.tokenIsValid(br(this.entitlements.token))?[3,2]:(e=this,[4,this.tveAPI.getEntitlements(t)]):[2,w.reject(new Error("TVEAuthenticator.AuthenticationRequired"))]:[2,w.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:e.entitlements=o.sent(),o.label=2;case 2:return this.entitlements&&this.tveAPI.tokenIsValid(br(this.entitlements.token))?((a={})[hr.CustomDataKey.token]=this.entitlements.token,a[hr.CustomDataKey.tokenType]="JWT",n=a,i=new hr(zr.mvpd,this.authenticatedProvider,this.authenticatedIdentity,n),r=new pr(!0,i),[2,w.resolve(r)]):[2,w.reject(new Error("TVEAuthenticator.NotEntitled"))]}}))}))},t.prototype.displayProviderDialog=function(){var t=this;b.debug("TVEAuthenticator.displayProviderDialog"),this.providerDataSource&&this.providerDataSource.getProviders().then((function(e){t.delegate&&t.delegate.selectProvider&&t.delegate.selectProvider(e)}))},t.prototype.setProvider=function(t,e){var n=this;b.debug("TVEAuthenticator.setProvider"),this.providerId=t,this.accessType=e,this.authenticate({redirectUrl:this.redirectUrl}).then((function(){n.resolveAuthenticate_&&(n.resolveAuthenticate_(n.isAuthenticated),n.resolveAuthenticate_=null)}))},t.defaultConfiguration=gr,t}()),sa=function(t){function n(){return e(this,n),l(this,c(n).call(this))}return u(n,t),n}(X),ua=function(){function t(n,i){e(this,t),this.playerAdaptor=n,this.mediaItem=i,this._currentContentType=null,this._currentAdId=null,this._lastHeartbeatTime=null,this._initialHeartbeatTimer=null,this._heartbeatTimer=null,this._currentPlayerTime=0,this._initialPlayerTime=null,this._isPlaying=!1,this._handleStart=this._handleStart.bind(this),this.playerAdaptor.on(Jn.start,this._handleStart),this._handlePlaying=this._handlePlaying.bind(this),this.playerAdaptor.on(Jn.playing,this._handlePlaying),this._handlePaused=this._handlePaused.bind(this),this.playerAdaptor.on(Jn.pause,this._handlePaused),this.playerAdaptor.on(Jn.stalled,this._handlePaused),this.playerAdaptor.on(Jn.seeking,this._handlePaused),this._handlePlayerCurrentTime=this._handlePlayerCurrentTime.bind(this),this.playerAdaptor.on(Jn.currentTime,this._handlePlayerCurrentTime),this._handleTimedMetadata=this._handleTimedMetadata.bind(this),this.playerAdaptor.on(Jn.timedMetadata,this._handleTimedMetadata),this._handleStop=this._handleStop.bind(this),this.playerAdaptor.on(Jn.stop,this._handleStop)}return i(t,[{key:"onContentTypeChanged",value:function(t,e,n,i){}},{key:"stop",value:function(){this.playerAdaptor.off(Jn.start),this.playerAdaptor.off(Jn.playing),this.playerAdaptor.off(Jn.pause),this.playerAdaptor.off(Jn.stalled),this.playerAdaptor.off(Jn.seeking),this.playerAdaptor.off(Jn.timedMetadata),this.playerAdaptor.off(Jn.currentTime),this.playerAdaptor.off(Jn.stop)}},{key:"_handleStart",value:function(){if(b.debug("AdBreakMonitor._handleStart"),!0!==this.mediaItem.source.hasEspnId3Heartbeats)return b.debug("AdBreakMonitor._handleStart hasEspnId3Heartbeats !== true, setting currentContentType to content.",this._currentPlayerTime,this._initialPlayerTime,this.mediaItem.source.hasEspnId3Heartbeats),void(this.currentContentType=t.ContentType.content);this._scheduleInitialHeartbeatTimer()}},{key:"_handlePlaying",value:function(){this._isPlaying=!0}},{key:"_handlePaused",value:function(){this._isPlaying=!1}},{key:"_handleTimedMetadata",value:function(t){if(!0===this.mediaItem.source.hasEspnId3Heartbeats&&t.tag===xn.priv&&t.owner===zn.heartbeat){b.debug("AdBreakMonitor._handleTimedMetadata",JSON.stringify(t));var e=function(t){var e;try{e=JSON.parse(t.dataValue)}catch(t){return null}return e.length?e.map((function(t){return new Fn(t.type,t.id)})):null}(t);e&&this._handleHeartbeats(e)}}},{key:"_handlePlayerCurrentTime",value:function(t){var e=Math.floor(t);null===this._initialPlayerTime&&(this._initialPlayerTime=e),this._currentPlayerTime=e}},{key:"_handleStop",value:function(){this._invalidateInitialHeartbeatTimer(),this._invalidateHeartbeatTimer()}},{key:"_handleHeartbeats",value:function(e){b.debug("AdBreakMonitor._handleHeartbeats",JSON.stringify(e)),this._invalidateInitialHeartbeatTimer(),this._lastHeartbeatTime=Date.now();var n=e.every((function(t){return t.isContent}))?t.ContentType.content:t.ContentType.ad;n===t.ContentType.ad&&(this._currentAdId=function(t){return t.find((function(t){return t.type===Hn.commercial&&null!==t.id}))||null}(e)),this.currentContentType=n,this._scheduleHeartbeatTimer()}},{key:"_scheduleInitialHeartbeatTimer",value:function(){var t=this;b.debug("AdBreakMonitor._scheduleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),this._initialHeartbeatTimer=setInterval((function(){t._handleInitialHeartbeatTimer()}),15e3)}},{key:"_invalidateInitialHeartbeatTimer",value:function(){this._initialHeartbeatTimer&&(clearInterval(this._initialHeartbeatTimer),this._initialHeartbeatTimer=null)}},{key:"_handleInitialHeartbeatTimer",value:function(){if(b.debug("AdBreakMonitor._handleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),!1!==this._isPlaying){if(!this.currentContentType){var e=t.ContentType.ad;this._currentAdId="1",this.currentContentType=e}}else this._scheduleInitialHeartbeatTimer()}},{key:"_scheduleHeartbeatTimer",value:function(){var t=this;this._invalidateHeartbeatTimer(),this._heartbeatTimer=setInterval((function(){t._handleHeartbeatTimer()}),1e4)}},{key:"_invalidateHeartbeatTimer",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:"_handleHeartbeatTimer",value:function(){var e=Date.now();if(b.debug("AdBreakMonitor._handleHeartbeatTimer"),!1!==this._isPlaying){if(this._lastHeartbeatTime&&e-this._lastHeartbeatTime>2e4){b.debug("AdBreakMonitor._handleHeartbeatTimer [now - this._lastHeartbeatTime]: ",e-this._lastHeartbeatTime);var n=t.ContentType.ad;this._currentAdId="1",this.currentContentType=n}this._scheduleHeartbeatTimer()}else this._scheduleHeartbeatTimer()}},{key:"currentContentType",get:function(){return this._currentContentType},set:function(t){if(this._currentContentType!==t){var e=this._currentContentType;this._currentContentType=t;var n=this._currentPlayerTime;e||(n=this._initialPlayerTime||0),this.onContentTypeChanged&&this.onContentTypeChanged(t,e,n,this._currentAdId)}}}]),t}();ua.ContentType={ad:"ad",content:"content"};var ca={production:"PROD",testing:"TESTING"},da={};da[ca.production]="https://web.archive.org/web/20201104011859/https://cloudapi.imrworldwide.com/nmapi/v2",da[ca.testing]="https://web.archive.org/web/20201104011859/https://sandbox-cloudapi.imrworldwide.com/nmapi/v2";var la=function(){function t(n,i,r,a,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ca.production;e(this,t);var u=n instanceof t.Configuration||n===Object(n)?n:new t.Configuration(n,i,r,a,o,s);b.debug("NielsenCloudAPIClient.constructor",JSON.stringify(u)),this.configuration=u,this.sessionId=Y()}return i(t,[{key:"sendEvent",value:function(t,e,n,i,r){var a={devInfo:this.devInfo,metadata:{},event:t,position:isNaN(e)||null===e?"".concat(e):"".concat(Math.floor(e)),type:n,utc:"".concat(Date.now())};i&&(a.metadata.content=i.tracking[bt.nielsen]),n===ua.ContentType.ad&&(a.metadata.ad=r);var o="".concat(da[this.env],"/").concat(this.appId,"/").concat(this.sessionId,"/a?b=").concat(encodeURIComponent(JSON.stringify(a)));b.debug("NielsenCloudAPIClient.sendEvent url:",o),b.debug("NielsenCloudAPIClient.sendEvent payload:",JSON.stringify(a)),A(o).then((function(t){b.debug("NielsenCloudAPIClient.sendEvent response.status: ".concat(t.status))})).catch((function(t){b.warn("NielsenCloudAPIClient.sendEvent response.error: ".concat(t&&t.message))}))}},{key:"closeSession",value:function(){this.sendEvent(t.EventType.delete,"","",null,null)}},{key:"configuration",set:function(t){t&&(this.appId=t.appId,this.devInfo={devId:!1===t.isOptOut?t.deviceId:"",apn:t.appName,apv:"".concat(t.appVersion),uoo:"".concat(t.isOptOut)},this.env=t.environment,this._configuration=t)},get:function(){return this._configuration}}]),t}();la.AssetType={content:"content",ad:"ad"},la.EventType={playhead:"playhead",complete:"complete",delete:"delete"},la.Environment=ca,la.Configuration=function t(n,i,r,a,o,s){e(this,t),this.appId=n,this.appName=i,this.appVersion=r,this.deviceId=a,this.isOptOut=o,this.environment=s};var ha=function(){function t(n,i,r){var a=this;e(this,t),this.cloudAPIClient=n,this.playerAdaptor=i;var o=te.fromObject(r)||r;if(o.entityType===wt.airing){this.mediaItem=o,this.currentPlayerTime=null,this.lastContentBeaconTime=null,this._isPlayerPlaying=!1,this.playerAdaptor.on(Jn.playing,(function(t){if(b.debug("NielsenTrackingManager PlayerAdaptorEvent.playing"),t){var e=Math.floor(t);a.currentPlayerTime=e}a.isPlayerPlaying=!0})),this.playerAdaptor.on(Jn.seeking,(function(){b.debug("NielsenTrackingManager PlayerAdaptorEvent.seeking"),a.isPlayerPlaying=!1})),this.playerAdaptor.on(Jn.pause,(function(){b.debug("NielsenTrackingManager PlayerAdaptorEvent.pause"),a.isPlayerPlaying=!1})),this.playerAdaptor.on(Jn.currentTime,(function(t){var e=Math.floor(t);a.currentPlayerTime=e;var n=a.currentContentType;if(n&&a.isPlayerPlaying){var i=e-a.currentContentStartTime;0!==i&&i%10==0&&e!==a.lastContentBeaconTime&&e>a.lastContentBeaconTime&&(a.lastContentBeaconTime=e,b.debug("NielsenTrackingManager PlayerAdaptorEvent.currentTime sending playhead 10 second beacon",e),a._sendPlayheadEvent(n,e))}})),this.playerAdaptor.on(Jn.stop,(function(){a.stop()})),this.currentContentType=null,this.currentContentStartTime=0,this.totalAdTime=0,this.currentAdInfo=null;var s=new ua(i,r);s.onContentTypeChanged=function(t,e,n){if(b.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged from",e,"to",t),e){b.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead before contentType change");var i=a._getPlayheadPosition(e,n,!0);a.cloudAPIClient.sendEvent(la.EventType.playhead,i,e,a.mediaItem,a.currentAdInfo)}b.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead after contentType change");var r=e&&!a.mediaItem.isLive?0:a._getPlayheadPosition(t,n),o=t===ua.ContentType.ad?{assetid:"1",type:0===r?"preroll":"midroll"}:null;a.cloudAPIClient.sendEvent(la.EventType.playhead,r,t,a.mediaItem,o),a.currentContentType=t,a.currentContentStartTime=n,a.currentAdInfo=o,a.lastContentBeaconTime=n},this.adBreakMonitor=s}}return i(t,[{key:"stop",value:function(){this.playerAdaptor.off(Jn.currentTime),this.playerAdaptor.off(Jn.stop),this.adBreakMonitor&&this.adBreakMonitor.stop(),this.mediaItem=null}},{key:"_getPlayheadPosition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.mediaItem.isLive)return Math.floor(Date.now()/1e3);if(t===ua.ContentType.ad){if(n){var i=e-this.currentContentStartTime;return this.totalAdTime+=i,i}return 0}return e-this.totalAdTime}},{key:"_sendPlayheadEventForCurrentPlayerTimeAndContentType",value:function(){var t=this.currentPlayerTime,e=this.currentContentType;e&&t!==this.lastContentBeaconTime&&t>this.lastContentBeaconTime&&(this.lastContentBeaconTime=t,b.debug("NielsenTrackingManager _sendPlayheadEventForCurrentPlayerTimeAndContentType sending playhead beacon",t),this._sendPlayheadEvent(e,t))}},{key:"_sendPlayheadEvent",value:function(t,e){var n=e-this.currentContentStartTime,i=t!==ua.ContentType.ad||this.mediaItem.isLive?this._getPlayheadPosition(t,e):n,r=t===ua.ContentType.ad?this.currentAdInfo:null;this.cloudAPIClient.sendEvent(la.EventType.playhead,i,t,this.mediaItem,r)}},{key:"mediaItem",get:function(){return this._mediaItem},set:function(t){if(this._mediaItem){this._sendPlayheadEventForCurrentPlayerTimeAndContentType();var e=this._getPlayheadPosition(ua.ContentType.content,this.currentPlayerTime);b.debug("NielsenTrackingManager setMediaItem sending complete"),this.cloudAPIClient.sendEvent(la.EventType.complete,e,la.AssetType.content,this._mediaItem)}this._mediaItem=t,this.adBreakMonitor&&(this.adBreakMonitor.mediaItem=t)}},{key:"isPlayerPlaying",get:function(){return this._isPlayerPlaying},set:function(t){t!==this._isPlayerPlaying&&(this._isPlayerPlaying=t,this._sendPlayheadEventForCurrentPlayerTimeAndContentType())}}]),t}();t.AdvertisingInfo=Fe,t.AtvlPlayerAdaptor=Wn,t.AtvlPlayerEvent=Bn,t.AtvlPlayerEventBus=sa,t.AuthenticationManager=Rn,t.AuthenticationType=Tt,t.BAMTizenPlayerAdaptor=Yn,t.ChromecastPlayerAdaptor=Qn,t.Client=ct,t.DRMKeySystem=Qe,t.DRMSupport=Xe,t.DTCITVEntitlementAPI=wr,t.DomesticLocationProvider=En,t.DrmSupport=Xe,t.FanManager=Sn,t.HTML5PlayerAdaptor=Xn,t.LocationProvider=Tn,t.MediaItemAPI=ee,t.MediaItemAuthenticationType=Tt,t.MediaItemSourceType=Et,t.MediaItemTrackingType=bt,t.NielsenCloudAPIClient=la,t.NielsenTrackingManager=ha,t.PlaybackConfig=Je,t.PlaybackManager=ni,t.PlayerEventBus=sa,t.TVEAuthenticator=oa,t.TokenAuthenticator=ar,t.TrilithiumPlayerAdaptor=ti,t.TrilithiumPlayerEvent=$n,t.log=P,t.uuid=Y,Object.defineProperty(t,"__esModule",{value:!0})}));


}
/*
     FILE ARCHIVED ON 01:18:59 Nov 04, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 01:30:08 Jul 18, 2023.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  captures_list: 56.925
  exclusion.robots: 0.071
  exclusion.robots.policy: 0.061
  cdx.remote: 0.058
  esindex: 0.008
  LoadShardBlock: 26.921 (3)
  PetaboxLoader3.datanode: 57.998 (5)
  load_resource: 95.806 (2)
  PetaboxLoader3.resolve: 51.219 (2)
*/