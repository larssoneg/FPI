var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).WatchSDK={})}(this,(function(t){"use strict";
/** @preserve ESPN WatchSDK 3.1.17 */function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(n,!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}function p(t,e,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=h(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function f(t,e,n,i){return(f="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var a,o=h(t,e);if(o){if((a=Object.getOwnPropertyDescriptor(o,e)).set)return a.set.call(i,n),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(i,e)){if(!a.writable)return!1;a.value=n,Object.defineProperty(i,e,a)}else r(i,e,n);return!0})(t,e,n,i)}function v(t,e,n,i,r){if(!f(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function y(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function m(t,e){return t(e={exports:{}},e.exports),e.exports}var b=m((function(t){var e,n;e=g,n=function(){var t=function(){},e="undefined",n=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function r(t,e){var n=t[e];if("function"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(e){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(e,n){for(var r=0;r<i.length;r++){var a=i[r];this[a]=r<e?t:this.methodFactory(a,e,n)}this.log=this.debug}function s(t,n,i){return function(){typeof console!==e&&(o.call(this,n,i),this[t].apply(this,arguments))}}function u(i,o,u){return function(i){return"debug"===i&&(i="log"),typeof console!==e&&("trace"===i&&n?a:void 0!==console[i]?r(console,i):void 0!==console.log?r(console,"log"):t)}(i)||s.apply(this,arguments)}function c(t,n,r){var a,s=this,c="loglevel";function l(){var t;if(typeof window!==e){try{t=window.localStorage[c]}catch(t){}if(typeof t===e)try{var n=window.document.cookie,i=n.indexOf(encodeURIComponent(c)+"=");-1!==i&&(t=/^([^;]+)/.exec(n.slice(i))[1])}catch(t){}return void 0===s.levels[t]&&(t=void 0),t}}t&&(c+=":"+t),s.name=t,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=r||u,s.getLevel=function(){return a},s.setLevel=function(n,r){if("string"==typeof n&&void 0!==s.levels[n.toUpperCase()]&&(n=s.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(a=n,!1!==r&&function(t){var n=(i[t]||"silent").toUpperCase();if(typeof window!==e){try{return void(window.localStorage[c]=n)}catch(t){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(t){}}}(n),o.call(s,n,t),typeof console===e&&n<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(t){l()||s.setLevel(t,!1)},s.enableAll=function(t){s.setLevel(s.levels.TRACE,t)},s.disableAll=function(t){s.setLevel(s.levels.SILENT,t)};var d=l();null==d&&(d=null==n?"WARN":n),s.setLevel(d,!1)}var l=new c,d={};l.getLogger=function(t){if("string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=d[t];return e||(e=d[t]=new c(t,l.getLevel(),l.methodFactory)),e};var h=typeof window!==e?window.log:void 0;return l.noConflict=function(){return typeof window!==e&&window.log===l&&(window.log=h),l},l.getLoggers=function(){return d},l},t.exports?t.exports=n():e.log=n()})),P=Object.freeze({__proto__:null,default:b,__moduleExports:b}),w=m((function(t,e){
/*!
   * @overview es6-promise - a tiny implementation of Promises/A+.
   * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
   * @license   Licensed under MIT license
   *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
   * @version   v4.2.8+1e68dce6
   */
t.exports=function(){function t(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,i=void 0,r=void 0,a=function(t,e){h[n]=t,h[n+1]=e,2===(n+=2)&&(r?r(p):b())},o="undefined"!=typeof window?window:void 0,s=o||{},u=s.MutationObserver||s.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(p,1)}}var h=new Array(1e3);function p(){for(var t=0;t<n;t+=2)(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0;n=0}var f,v,y,m,b=void 0;function P(t,e){var n=this,i=new this.constructor(I);void 0===i[A]&&R(i);var r=n._state;if(r){var o=arguments[r-1];a((function(){return N(r,i,o,n._result)}))}else D(n,i,t,e);return i}function w(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(I);return E(e,t),e}c?b=function(){return process.nextTick(p)}:u?(v=0,y=new u(p),m=document.createTextNode(""),y.observe(m,{characterData:!0}),b=function(){m.data=v=++v%2}):l?((f=new MessageChannel).port1.onmessage=p,b=function(){return f.port2.postMessage(0)}):b=void 0===o?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(p)}:d()}catch(t){return d()}}():d();var A=Math.random().toString(36).substring(2);function I(){}var S=void 0,k=1,T=2;function _(e,n,i){n.constructor===e.constructor&&i===P&&n.constructor.resolve===w?function(t,e){e._state===k?O(t,e._result):e._state===T?M(t,e._result):D(e,void 0,(function(e){return E(t,e)}),(function(e){return M(t,e)}))}(e,n):void 0===i?O(e,n):t(i)?function(t,e,n){a((function(t){var i=!1,r=function(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}(n,e,(function(n){i||(i=!0,e!==n?E(t,n):O(t,n))}),(function(e){i||(i=!0,M(t,e))}),t._label);!i&&r&&(i=!0,M(t,r))}),t)}(e,n,i):O(e,n)}function E(t,e){if(t===e)M(t,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=e),null===i||"object"!==r&&"function"!==r)O(t,e);else{var n=void 0;try{n=e.then}catch(e){return void M(t,e)}_(t,e,n)}var i,r}function C(t){t._onerror&&t._onerror(t._result),U(t)}function O(t,e){t._state===S&&(t._result=e,t._state=k,0!==t._subscribers.length&&a(U,t))}function M(t,e){t._state===S&&(t._state=T,t._result=e,a(C,t))}function D(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+k]=n,r[o+T]=i,0===o&&t._state&&a(U,t)}function U(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,r=void 0,a=t._result,o=0;o<e.length;o+=3)i=e[o],r=e[o+n],i?N(n,i,r,a):r(a);t._subscribers.length=0}}function N(e,n,i,r){var a=t(i),o=void 0,s=void 0,u=!0;if(a){try{o=i(r)}catch(t){u=!1,s=t}if(n===o)return void M(n,new TypeError("A promises callback cannot return that same promise."))}else o=r;n._state!==S||(a&&u?E(n,o):!1===u?M(n,s):e===k?O(n,o):e===T&&M(n,o))}var j=0;function R(t){t[A]=j++,t._state=void 0,t._result=void 0,t._subscribers=[]}var L=function(){function t(t,n){this._instanceConstructor=t,this.promise=new t(I),this.promise[A]||R(this.promise),e(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&O(this.promise,this._result))):M(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===S&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===w){var r=void 0,a=void 0,o=!1;try{r=t.then}catch(t){o=!0,a=t}if(r===P&&t._state!==S)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(n===x){var s=new n(I);o?M(s,a):_(s,t,r),this._willSettleAt(s,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(i(t),e)},t.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===S&&(this._remaining--,t===T?M(i,n):this._result[e]=n),0===this._remaining&&O(i,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;D(t,void 0,(function(t){return n._settledAt(k,e,t)}),(function(t){return n._settledAt(T,e,t)}))},t}(),x=function(){function e(t){this[A]=j++,this._result=this._state=void 0,this._subscribers=[],I!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){E(t,e)}),(function(e){M(t,e)}))}catch(e){M(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):this.then(e,e)},e}();return x.prototype.then=P,x.all=function(t){return new L(this,t).promise},x.race=function(t){var n=this;return e(t)?new n((function(e,i){for(var r=t.length,a=0;a<r;a++)n.resolve(t[a]).then(e,i)})):new n((function(t,e){return e(new TypeError("You must pass an array to race."))}))},x.resolve=w,x.reject=function(t){var e=new this(I);return M(e,t),e},x._setScheduler=function(t){r=t},x._setAsap=function(t){a=t},x._asap=a,x.polyfill=function(){var t=void 0;if(void 0!==g)t=g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=x},x.Promise=x,x}()})),A=function(t){return 200===t.status||201===t.status||202===t.status||204===t.status||0===t.status&&t.responseText&&""!==t.responseText};function I(t,e){return e=e||{},new w((function(n,i){var r=new XMLHttpRequest;for(var a in r.open(e.method||"get",t,!0),e.headers)r.setRequestHeader(a,e.headers[a]);function o(){var t,e=[],n=[],i={};return r.getAllResponseHeaders().replace(/^(.*?):\s*?([\s\S]*?)$/gm,(function(r,a,o){e.push(a=a.toLowerCase()),n.push([a,o]),t=i[a],i[a]=t?"".concat(t,",").concat(o):o})),{ok:2==(r.status/100|0),status:r.status,statusText:r.statusText,url:r.responseURL,clone:o,text:function(){return w.resolve(r.responseText)},json:function(){return w.resolve(r.responseText).then((function(t){try{return JSON.parse(t)}catch(t){return{}}}))},blob:function(){return w.resolve(new Blob([r.response]))},headers:{keys:function(){return e},entries:function(){return n},get:function(t){return i[t.toLowerCase()]},has:function(t){return t.toLowerCase()in i}}}}r.withCredentials="include"===e.credentials,r.onload=function(){n(o())},r.onreadystatechange=function(){try{4===r.readyState&&(A(r)?n(o()):i(o()))}catch(t){r.abort()}},r.onerror=i,r.send(e.body)}))}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */var S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function k(t,e){function n(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var T=function(){return(T=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function _(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){t.done?r(t.value):new n((function(e){e(t.value)})).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function E(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function C(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}function O(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(C(arguments[e]));return t}var M=m((function(t,e){var n;t.exports=(n=n||function(t,e){var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var o=n[a>>>2]>>>24-a%4*8&255;e[i+a>>>2]|=o<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)e[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n,i=[],r=function(e){e=e;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(e=18e3*(65535&e)+(e>>16)&i)&i;return r/=4294967296,(r+=.5)*(t.random()>.5?1:-1)}},a=0;a<e;a+=4){var s=r(4294967296*(n||t.random()));n=987654071*s(),i.push(4294967296*s()|0)}return new o.init(i,e)}}),s=i.enc={},u=s.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new o.init(n,e/2)}},c=s.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new o.init(n,e)}},l=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},d=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,s=r/(4*a),u=(s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0))*a,c=t.min(4*u,r);if(u){for(var l=0;l<u;l+=a)this._doProcessBlock(i,l);var d=i.splice(0,u);n.sigBytes-=c}return new o.init(d,c)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),h=(r.Hasher=d.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new h.HMAC.init(t,n).finalize(e)}}}),i.algo={});return i}(Math),n)})),D=m((function(t,e){var n,i,r;t.exports=(i=(n=r=M).lib.WordArray,n.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],a=0;a<n;a+=3)for(var o=(e[a>>>2]>>>24-a%4*8&255)<<16|(e[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|e[a+2>>>2]>>>24-(a+2)%4*8&255,s=0;s<4&&a+.75*s<n;s++)r.push(i.charAt(o>>>6*(3-s)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(t){var e=t.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var o=n.charAt(64);if(o){var s=t.indexOf(o);-1!==s&&(e=s)}return function(t,e,n){for(var r=[],a=0,o=0;o<e;o++)if(o%4){var s=n[t.charCodeAt(o-1)]<<o%4*2,u=n[t.charCodeAt(o)]>>>6-o%4*2;r[a>>>2]|=(s|u)<<24-a%4*8,a++}return i.create(r,a)}(t,e,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)})),U=m((function(t,e){t.exports=M.enc.Utf8})),N="https://web.archive.org/web/20201110234047/https://streams.adobeprimetime.com/v2",j="applicationId",R="applicationPlatform",L="deviceModel",x="mobileDevice",z="programmerName",H=function(t){var e=t+":";return{Authorization:"Basic "+D.stringify(U.parse(e)),Accept:"application/json"}},B=function(){function t(t,e,n,i,r){e&&n&&i&&(this.programmer=t,this.applicationId=e,this.identityProvider=n,this.subject=i,this.metadata=r||{},this.serviceUrl=N,this.requestHeaders=H(e),this.heartbeatIntervalId=null,this.messages={})}return t.fetchMetadataKeys=function(t,e){return _(this,void 0,void 0,(function(){var n,i,r,a;return E(this,(function(o){switch(o.label){case 0:n=e+"/metadata",i=H(t),r={method:"GET",headers:i},o.label=1;case 1:return o.trys.push([1,4,,5]),[4,I(n,r)];case 2:return[4,o.sent().json()];case 3:return function(t,e){var n="AdobeCM.metadata."+e;localStorage.setItem(n,JSON.stringify(t))}(o.sent(),t),[2,!0];case 4:return a=o.sent(),console.error("fetchMetadataKeys error: "+a),[2,!1];case 5:return[2]}}))}))},Object.defineProperty(t.prototype,"metadataKeys",{get:function(){return function(t){var e="AdobeCM.metadata."+t,n=[];try{n=JSON.parse(localStorage.getItem(e))||[]}catch(t){}return n}(this.applicationId)},enumerable:!0,configurable:!0}),t.prototype.start=function(){return _(this,void 0,void 0,(function(){var t;return E(this,(function(e){switch(e.label){case 0:return[4,this.createSession()];case 1:return(t=e.sent())?(this.scheduleHeartbeat(),[2,t]):[2,null]}}))}))},t.prototype.startWithSession=function(t){this.sessionId=t,this.scheduleHeartbeat()},t.prototype.stop=function(){this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=null),this.terminateSession()},t.prototype.createSession=function(t){return void 0===t&&(t=[]),_(this,void 0,void 0,(function(){var e,n,i,r,a,o,s,u,c;return E(this,(function(l){switch(l.label){case 0:b.debug("AdobeConcurrencyMonitorV2.createSession"),e=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject,n=T({"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},this.requestHeaders),t.length>0&&(n["X-Terminate"]=t.join(",")),i=this.getMetadata(),r=Object.keys(i).map((function(t){return t+"="+encodeURIComponent(i[t])})).join("&"),a={method:"POST",headers:n,body:r},l.label=1;case 1:return l.trys.push([1,3,,4]),[4,I(e,a)];case 2:if(o=l.sent(),!((s=o.status)>=200&&s<300))throw o;return u=o.headers.get("location").trim(),this.sessionId=u,b.debug("AdobeConcurrencyMonitorV2.createSession sessionId:",u),[2,u];case 3:return c=l.sent(),b.error("AdobeConcurrencyMonitorV2.createSession error: "+c),this.handleError(c,null),[2,null];case 4:return[2]}}))}))},t.prototype.scheduleHeartbeat=function(){var t=this;b.debug("AdobeConcurrencyMonitorV2.scheduleHeartbeat"),this.heartbeatIntervalId=window.setTimeout((function(){t.heartbeat()}),45e3)},t.prototype.heartbeat=function(){var t=this,e=this.sessionId;e&&(b.debug("AdobeConcurrencyMonitorV2.heartbeat",e),I(this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+e,{method:"POST",headers:this.requestHeaders}).then((function(e){var n=e.status;if(!(n>=200&&n<300))throw e;t.scheduleHeartbeat()})).catch((function(e){return t.handleError(e,t.onError)})))},t.prototype.terminateSession=function(){var t=this.sessionId;t&&I(this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+t,{method:"DELETE",headers:this.requestHeaders}).then((function(t){var e=t.status;if(!(e>=200&&e<300))throw t}))},t.prototype.handleError=function(e,n){var i=this;switch(b.debug("AdobeConcurrencyMonitorV2.handleError",e),e.status){case 400:return e.json().then((function(e){if(!!(e.obligations||[]).find((function(t){return"logout"===t.action})))return t.fetchMetadataKeys(i.applicationId,i.serviceUrl).then((function(){var t=i.metadata;if(Object.keys(t).length>=i.metadataKeys.length)return i.start()}))}));case 409:return e.json().then((function(t){var r=(t.associatedAdvice||[]).find((function(t){return"rule-violation"===t.type}));if(r){var a=r.message,o=i.messages[a]||a,s=new Error(o),u=!!(t.obligations||[]).find((function(t){return"logout"===t.action}));if(b.debug("AdobeConcurrencyMonitorV2.handleError",e.status,s,u),!n)throw s;n(s,u)}}));case 410:return e.json().then((function(t){if(!t)return i.start();var r=(t.associatedAdvice||[]).find((function(t){return"remote-termination"===t.type}));if(r){var a=r.message,o=i.messages[a]||a,s=new Error(o),u=!!t.obligations.find((function(t){return"logout"===t.action}));if(b.debug("AdobeConcurrencyMonitorV2.handleError",e.status,s,u),!n)throw s;n(s,u)}}))}},t.prototype.getMetadata=function(){var t=this;return this.metadataKeys.reduce((function(e,n){return e[n]=t.metadata[n],e}),{})},t.prototype.onError=function(t,e){b.debug("AdobeConcurrencyMonitor.onError"),b.debug("error: "+t),b.debug("shouldLogout: "+e)},t}();function V(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,V)}function F(){}F.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var i=this;function r(){i.off(t,r),e.apply(n,arguments)}return r._=e,this.on(t,r,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var a=0,o=i.length;a<o;a++)i[a].fn!==e&&i[a].fn._!==e&&r.push(i[a]);return r.length?n[t]=r:delete n[t],this}};var K=F,J=F;K.TinyEmitter=J;var G=function(t){function n(){return e(this,n),d(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"getConfiguration",value:function(t,e){return{}}}]),n}(K),q="BootstrapManager.bootstrap",W=!1;try{W="caches"in self}catch(t){}var Y={updated:"UPDATED"},Q=function(t){function n(){var t;if(e(this,n),(t=d(this,c(n).call(this)))._bootstrap=null,t._cache=null,W)caches.open("watchsdk-cache").then((function(e){t._cache=e,e&&e.match("bootstrap").then((function(t){return t&&t.json()})).then((function(e){e&&null===t._bootstrap&&(t._bootstrap=e)}))}));else{var i=localStorage.getItem(q);try{var r=JSON.parse(U.stringify(D.parse(i)));t._bootstrap=r}catch(e){try{var a=JSON.parse(i);t._bootstrap=a}catch(t){}}}return t}return u(n,t),i(n,[{key:"update",value:function(t){var e=this;return I(t).then((function(t){return t.json()})).then((function(t){if(b.debug("BootstrapManager.update() ".concat(JSON.stringify(t,null,2))),e._bootstrap=t,e._cache&&e._cache.put("bootstrap",new Response(JSON.stringify(t),{headers:{"Content-Type":"application/json"}})),!W){var n=D.stringify(U.parse(JSON.stringify(t)));localStorage.setItem(q,n)}e.emit(Y.updated,e._bootstrap)}))}},{key:"getConfiguration",value:function(t,e){var n=this.bootstrap,i=n&&n[t]||{};if(e){var a=Object.keys(i).filter((function(t){return-1!==Object.keys(e).indexOf(t)})).reduce((function(t,e){return s({},t,r({},e,i[e]))}),{});i=s({},e,{},a)}return i}},{key:"bootstrap",get:function(){return this._bootstrap}}]),n}(G);Q.shared=new Q;var X,Z=new function t(n,i,r,a){e(this,t),this.enabled=n,this.serviceUrl=i,this.applicationId=null,this.applications=r,this.messages=a}(!0,"https://web.archive.org/web/20201110234047/https://streams.adobeprimetime.com/v2",{chromecast:{applicationId:"4c6fd925-7d06-4dbd-9edb-720962619882"},appletv:{applicationId:"eebe77ee-3064-4b4a-b89b-fef248a474be"},samsungtv:{applicationId:"0e3d9128-cdf7-4464-9952-55434ead1e8e"},web:{applicationId:"3bfbbbdf-be8e-40be-9540-97a73469ada2"},ps4:{applicationId:"41e7539c-d38f-4c20-856a-8db2de060287"}},{}),$="https://web.archive.org/web/20201110234047/https://a.espncdn.com/connected-devices/app-configurations/espn-js-sdk-2.0.config.json",tt={appletv:"dniqxcl2cnjuzgl04vuek1mm",chromecast:"1q86jvqka85r41w7daunp5ipgb",ps4:"kbjoe0y9awb41guc2nzey04ji",samsungtv:"csrf56z30hke1aozrm00ad50g",web:"uiqlbgzdwuru14v627vdusswb"},et=function(t){var e=Q.shared.getConfiguration("adobeCM",Z);if(!1!==e.enabled){var n=e.applications&&e.applications[t],i=e.applicationId||n&&n.applicationId,r=e.serviceUrl;B.fetchMetadataKeys(i,r)}},nt=function(){function t(){e(this,t)}return i(t,null,[{key:"init",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.partner=e,t.platform=n,t.version=i,t.deviceId=t.deviceId||V(),b.debug(this.toString());var a=r&&r.bootstrapUrl||$;Q.shared.update(a).finally((function(){et(t.platform)}))}},{key:"toString",value:function(){return"<WatchSDK.Client partner:".concat(t.partner,", platform:").concat(t.platform,", deviceId:").concat(t.deviceId,">")}},{key:"partner",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.partner")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.partner",t)}},{key:"platform",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.platform")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.platform",t)}},{key:"version",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.version")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.version",t)}},{key:"deviceId",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.deviceId")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.deviceId",t)}},{key:"apiKey",get:function(){return Q.shared.getConfiguration("shield",{apiKeys:tt}).apiKeys[t.platform]||"mbmhfdgflphg14wss50rny3ct"}}]),t}();!function(t){t[t.all=0]="all",t[t.linearPlayback=1]="linearPlayback"}(X||(X={}));var it,rt=X;!function(t){t.linear="linear",t.event="event"}(it||(it={}));var at,ot=it;!function(t){t.stitchedPreroll="stitchedPreroll"}(at||(at={}));var st,ut=at;!function(t){t.live="live",t.onDemand="onDemand"}(st||(st={}));var ct,lt=st;!function(t){t.nielsen="nielsen",t.comscore="comscore",t.conviva="conviva",t.heartbeats="heartbeats"}(ct||(ct={}));var dt,ht=ct;!function(t){t.shortform="shortform",t.longform="longform"}(dt||(dt={}));var pt,ft=dt;!function(t){t.audio="audio",t.video="video"}(pt||(pt={}));var vt,yt=pt;!function(t){t.pluto="pluto",t.graphQL="graphQL",t.cfa="cfa"}(vt||(vt={}));var gt,mt=vt;!function(t){t.open="OPEN",t.direct="DIRECT",t.mvpd="MVPD",t.isp="ISP",t.none="NONE"}(gt||(gt={}));var bt,Pt=gt;!function(t){t.none="none",t.startSession="startSession",t.bam="bam",t.shield="shield",t.entitlement="entitlement"}(bt||(bt={}));var wt=bt,At=function(){function t(t,e,n,i,r,a,o){this.url=t,this.type=e,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=o,this.variant=null}return t.fromObject=function(e){if(!e)return null;var n=e.url,i=e.type,r=e.hasEspnId3Heartbeats,a=e.hasNielsenWatermarks,o=e.hasPassThroughAds,s=e.commercialReplacement,u=e.startSessionUrl;return new t(n,wt[i],r,a,o,s,u)},t}(),It=function(){function t(t,e,n,i){this.id=t,this.type=e,this.name=n,this.resource=i}return t.fromObject=function(e){if(!e)return null;var n=ot[e.type];return new t(e.id,n,e.name,e.resource)},t}(),St=function(){function t(t){this.url=t}return t.fromObject=function(e){return e&&e.url?new t(e.url):null},t}(),kt=function(){function t(t){this.name=t}return Object.defineProperty(t.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!0,configurable:!0}),t.fromObject=function(e){return e?new t(e.name):null},t}(),Tt=function(){function t(t,e,n,i,r){this.id=t,this.title=e,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=rt.all,this.images=[],this.type=yt.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null}return Object.defineProperty(t.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===ot.linear},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLive",{get:function(){return this.streamType===lt.live},enumerable:!0,configurable:!0}),t.fromObject=function(e){var n=At.fromObject(e.source),i=new t(e.id,e.title,e.duration,e.language,n);return i.authenticationTypes=e.authenticationTypes,i.description=e.description,i.images=(e.images||[]).map((function(t){return St.fromObject(t)})),i.mrss=e.mrss,i.network=It.fromObject(e.network),i.seekInSeconds=e.seekInSeconds,i.streamType=lt[e.streamType],i.supportedMediaCommands=e.supportedMediaCommands,i.tracking=e.tracking,i.references=e.references,i.packages=(e.packages||[]).map((function(t){return kt.fromObject(t)})),i.type=yt[e.type],i.entityType=ft[e.entityType],i.isSyndicatable=e.isSyndicatable,i.brand=e.brand,i},t.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},t}();var _t,Et=function(){function t(t){var e=function(t){var e=t.split("?")[1],n={};if(e)for(var i=e.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(t);if(this.original=t,this.id=e.videoID||e.playID||e.clip||e.externalId,t.match("sportscenter")){this.gameId=e.playGameID,this.channel=e.playChannel,this.simulcastAiringId=e.simulcastAiringId;var n=parseInt(e.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=e.eventId}this.source=e["x-source"],e.videoID?this.entityType=ft.shortform:this.entityType=ft.longform,this.type=yt.video}return t.prototype.toString=function(t){return t==mt.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},t.identifierStringForNetwork=function(t,e){return e==mt.graphQL?"sportscenter://x-callback-url/showWatchStream?playChannel="+t:"natgeo://playVideo?videoID="+t},t}();function Ct(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function Ot(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function Mt(t,e,n,i){if(!e)return{};var r,a,o,s=null;t===_t.natGeo?s=function(t){if(!t)return{};var e={},n=t.id,i=t.title,r=t.duration;return e.c_video_id_code=n,e.c_a_media_airdate="unknown",e.c_a_media_daypart="daytime",e.c_a_media_digitaldate="unknown",e.c_a_media_episode="none",e.c_a_media_feed="natgeo live",e.c_a_media_format="vod",e.c_a_media_genre="none",e.c_a_media_network="natgeo",e.c_a_media_originator="natgeo",e.c_a_media_pass_auth="none",e.c_a_media_pass_mvpd="none",e.c_a_media_rating="none",e.c_a_media_season="none",e.c_a_media_show=i,e.c_a_media_streamtype=pt.video,e.c_a_media_length=r,e}(e):(r=function(t,e,n){if(!t)return{};var i=t.duration,r=t.id,a=t.league,o=t.name,s=t.network,u=t.program,c=t.sport,l=t.startDateTime,d=t.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=o,p.title=o,p.clientid="us-600140",e===ft.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(u&&u.code||"")+(c&&c.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=s&&s.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return e===ft.shortform&&(p.accmethod="1",p.length=""+i,p.segA=o,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(e,n,i),a=function(t,e){if(!t)return{};var n=t.id,i=t.duration,r=t.name,a=t.league,o=t.startDateTime,s=t.network,u=t.sport,c=t.status,l=t.tracking,d={};if(e===ft.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":u&&u.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,o){var v=new Date(o);d.ns_st_ddt=v.toDateString(),d.ns_st_tdt=v.toDateString()}return d.ns_st_st=s?s.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(e,n),o=function(t,e,n){if(!t)return{};var i=t.name,r=t.id,a=t.airingId,o=t.eventId,s=t.duration,u=t.network,c=t.status,l=i+" - "+r;u&&u.type===ot.linear&&(l=u.id);var d={};return d.contentId=r,a&&(d.airingId=a),o&&(d.eventId=""+o,d.eventName=i),u&&(d.network=u.id),e===ft.shortform?d.assetType="clip":!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?d.assetType="vod":d.assetType="live",d.appBrand=_t.espn,{assetName:l,duration:s,streamUrl:n&&n.url,custom:d}}(e,n,i),s=function(t,e){if(!t)return{};var n=t.duration,i=t.airingId,r=t.network,a=t.status,o=t.sport,s=t.league,u=t.program,c=t.startDateTime,l=t.tracking,d=t.originalPublishDate,h=t.expirationDate,p=t.lastModifiedDate,f=t.ad,v=t.coverageType,y={};if(y.ContentDuration=n,e===ft.longform){if(y.isFullEpisode="y",i&&(y.AiringID=i),r&&(y.NetworkName=r.id,y.Channel=r.id),a&&(y.VideoType="REPLAY"===a?"replay":"live"),y.Sport=o&&o.name||"Not Applicable",y.SportCode=o&&o.code||"Not Applicable",y.League=s&&s.name||"Not Applicable",u&&u.code&&u.categoryCode?y.ProgramCode=u.categoryCode+u.code:y.ProgramCode="Not Applicable",y.IsStudio=u&&u.isStudio||"Not Applicable",c){var g=new Date(c);y.AirDate=g.toDateString(),y.AirTime=g.toTimeString()}}else if(e===ft.shortform){if(y.isFullEpisode="n",y.VideoType="vod",y.Sport=l&&l.sportName||"Not Applicable",y.League=l&&l.leagueName||"Not Applicable",y.ShowCode=f&&f.bundle||"Not Applicable",l&&l.name&&(y.CMSID=l.name),d){g=new Date(d);y.PublishDate=g.toISOString().substring(0,10),y.PublishTime=g.toISOString().substring(11)}if(h){g=new Date(h);y.ExpirationDate=g.toISOString()}if(p){g=new Date(p);y.DateLastModified=g.toISOString()}v&&(y.VideoTypeDetail=v)}return y}(e,n));var u={};return u[ht.nielsen]=r,u[ht.comscore]=a,u[ht.conviva]=o,u[ht.heartbeats]=s,u}function Dt(t,e,n){return t.sort((function(t,e){var n="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2,i="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(t,n){var i=t.network&&t.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=e.indexOf(i),o=e.indexOf(r);return-1===a&&(a=999),-1===o&&(o=999),a<o?-1:a>o?1:0})).sort((function(t,e){var i=t.language===n?0:1,r=e.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(t){t.abc="abc",t.abcNews="abcnews",t.abcNewsLive="abcnewslive",t.abcOtv="abcotv",t.disney="dch",t.disneyJr="djr",t.disneyXD="dxd",t.disneyNow="dnow",t.espn="espn",t.espnFantasy="espnFantasy",t.oscar="oscar",t.freeform="ff",t.foxLatam="foxlatam",t.fxNow="fxnow",t.fx="fx",t.fxm="fxm",t.fxx="fxx",t.natGeoTV="natgeotv",t.natGeo="natgeo",t.natGeoWild="natgeowild",t.natgeoBrasil="natgeobrasil",t.unknown="000"}(_t||(_t={}));var Ut="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName }",Nt="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}";var jt="https://web.archive.org/web/20201110234047/https://watch.graph.api.espn.com/api",Rt="d15c5790-7cb0-4fe1-8782-25f4698d0739",Lt=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],xt="https://web.archive.org/web/20201110234047/https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock",zt=function(t,e,n,i){t==mt.graphQL?(this.serviceUrl=e||jt,this.apiKey=n||Rt,this.networkSortOrder=i||Lt):t==mt.cfa&&(this.serviceUrl=e||xt)},Ht=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return Ct(this,void 0,void 0,(function(){return Ot(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return Ct(this,void 0,void 0,(function(){var r,a,o,s,u,c;return Ot(this,(function(l){switch(l.label){case 0:return r=e.map((function(t){return new Et(t)})),a=i.serviceUrl,o=i.apiKey,s=i.networkSortOrder,[4,w.all(r.map((function(e){return t.getPromiseMediaItems(e,a,o,n)})))];case 1:return u=l.sent(),(c=u.filter((function(t){return!(t instanceof Error)&&t instanceof Tt}))).length?[2,Dt(c,s,navigator.language)]:[2,null]}}))}))},t.getPromiseMediaItems=function(e,n,i,r){return Ct(this,void 0,void 0,(function(){var a,o,s,u,c,l,d,h,p,f,v,y;return Ot(this,(function(g){switch(g.label){case 0:a=function(t,e,n,i){var r="",a="",o="",s=i||"US";return t.entityType===ft.shortform?(r="VOD",o=Nt,a='id:"'+t.id+'"'):(r="airing",o=Ut,t.id?a='id:"'+t.id+'"':t.channel?(r="airings",a='networks:["'+t.channel+'"],type:LIVE'):t.gameId&&(r="airings",a='eventId:"'+(t.eventId||t.gameId)+'"')),e+"?apiKey="+n+"&query="+("airings"===r?encodeURIComponent("{ "+r+"("+a+',countryCode:"'+s+'",deviceType:SETTOP,tz:"Z") '+o+" }"):encodeURIComponent("{ "+r+"("+a+',deviceType:SETTOP,tz:"Z") '+o+" }"))}(e,n,i,r.countryCode),g.label=1;case 1:return g.trys.push([1,4,,5]),[4,I(a)];case 2:return[4,g.sent().json()];case 3:if(o=g.sent(),s=o.data.airing,(u=o.data.airings)&&(c=e.simulcastAiringId?function(t){return t.simulcastAiringId===e.simulcastAiringId}:function(){return!0},s=u.filter(c)[0]),l=o.data.VOD,!(d=s||l))throw new Error("No results found.");if(h=function(t,e,n){var i=t.id,r=t.name,a=t.description,o=t.duration,s=t.image,u=t.eventId,c=t.requiresLinearPlayback,l=t.authTypes,d=t.source,h=t.prerollSource,p=t.packages,f=t.language,v=t.mrss,y=t.seekInSeconds,g=t.tracking,m=t.simulcastAiringId,b=t.network,P=t.status,w=t.cerebroId,A=t.syndicatable,I=P&&("LIVE"===P.toUpperCase()||"OVER"===P.toUpperCase())?lt.live:lt.onDemand,S=function(t){switch(t){case"NONE":return wt.none;case"START_SESSION":return wt.startSession;case"BAM":return wt.bam;case"SHIELD":return wt.shield}}(d.authorizationType),k=new At(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===ut.stitchedPreroll&&h&&((k=new At(h.url,wt.none)).variant=ut.stitchedPreroll);var T=c?rt.linearPlayback:rt.all,_=g&&g.trackingId||i,E=new Tt(i,r,o,f,k);if(E.authenticationTypes=l.map((function(t){switch(t){case"DIRECT":return Pt.direct;case"OPEN":return Pt.open;case"MVPD":return Pt.mvpd;case"ISP":return Pt.isp;default:return Pt.none}})),E.description=a,E.isSyndicatable=A,s&&s.url&&E.images.push(new St(s.url)),E.mrss=v,b){var C="linear"===b.type?ot.linear:ot.event;E.network=new It(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=y,E.streamType=I,E.supportedMediaCommands=T,E.brand=E.brand?E.brand:"espn",E.tracking=Mt(E.brand,t,e,k),E.references={eventId:u,simulcastAiringId:m,trackingId:_,cerebroId:w},E.type=yt.video,E.entityType=e,E.apiSource=mt.graphQL,E.packages=(p||[]).map((function(t){return new kt(t.name)})),E}(d,e.entityType,r),e.resumeTime&&(h.seekInSeconds=e.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===ot.linear,v=d.network&&d.network.id,p&&f&&v)return[2,t.retryGetMediaItems(v,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return y=g.sent(),b.warn("Failed to retrieve MediaItem from GraphQL: "+y),[2,null];case 5:return[2]}}))}))},t.retryGetMediaItems=function(e,n,i,r){return Ct(this,void 0,void 0,(function(){var a,o,s,u;return Ot(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),a=Et.identifierStringForNetwork(e,mt.graphQL),o=new Et(a),[4,t.getPromiseMediaItems(o,n,i,r)];case 1:if((s=c.sent())&&s instanceof Tt==!0)return[2,s];throw new Error("Retry fetchMediaItems failed with "+e);case 2:return u=c.sent(),b.warn("MediaItem is over and retry failed: "+u),[2,null];case 3:return[2]}}))}))},t.defaultConfiguration=new zt(mt.graphQL),t}();var Bt,Vt=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return Ct(this,void 0,void 0,(function(){return Ot(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return Ct(this,void 0,void 0,(function(){var n,r;return Ot(this,(function(a){switch(a.label){case 0:return n=e.map((function(t){return new Et(t)})),r=i.serviceUrl,[4,w.all(n.map((function(e){return t.getPromiseMediaItem(e,r)})))];case 1:return[2,a.sent().filter((function(t){return!(t instanceof Error)&&t instanceof Tt}))]}}))}))},t.getPromiseMediaItem=function(t,e){return Ct(this,void 0,void 0,(function(){var n,i,r;return Ot(this,(function(a){switch(a.label){case 0:n=e.replace("videoID",t.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,I(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(t){var e=t.id,n=t.title,i=t.description,r=t.duration,a=t.source,o=t.type,s=t.entityType,u=t.streamType,c=t.authenticationTypes,l=t.language,d=t.network,h=t.brand,p=t.images,f=s,v=a.type,y=new At(a.url,v),g=new Tt(e,n,r,l,y);return g.authenticationTypes=c.map((function(t){switch(t){case"DIRECT":return Pt.direct;case"OPEN":return Pt.open;case"MVPD":return Pt.mvpd;case"ISP":return Pt.isp;default:return Pt.none}})),g.description=i,d&&(g.network=new It(d.id,d.type,d.name,d.resource)),g.streamType=u,g.brand=h,g.tracking=Mt(g.brand,t,f,y),g.images=p,g.type=o,g.entityType=f,g.apiSource=mt.cfa,g}(i)];case 4:return r=a.sent(),b.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},t.defaultConfiguration=new zt(mt.cfa),t}(),Ft=function(){function t(){}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(t,e){return Ct(this,void 0,void 0,(function(){var n,i;return Ot(this,(function(r){switch(r.label){case 0:return n=e||{sourceVariant:null},t[0].match("natgeo")?((i=new Vt).configuration=this.configuration||i.configuration,[4,i.getMediaItems(t,n)]):[3,2];case 1:return[2,r.sent()];case 2:return(i=new Ht).configuration=this.configuration||i.configuration,[4,i.getMediaItems(t,n)];case 3:return[2,r.sent()]}}))}))},t}(),Kt=new function t(n){e(this,t),this.intervals=n}({intervals:{DEFAULT:2,ESPN_PLUS:0,ESPN_PLUS_MLB:0,ESPN_PLUS_NHL:0}}),Jt=function(){function t(){e(this,t),this.configuration=Kt}return i(t,[{key:"shouldPreroll",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=this.configuration.intervals.DEFAULT||0,r=(n||[]).filter((function(t){return t in e.configuration.intervals})).map((function(t){return e.configuration.intervals[t]}));0===r.length&&r.push(i);var a=Math.min.apply(Math,y(r));return a>0&&t.prerollCount>=a-1}},{key:"configuration",get:function(){return this._configuration},set:function(t){this._configuration=t}}],[{key:"prerollCount",get:function(){var t=localStorage.getItem("PrerollManager.prerollCount");try{return JSON.parse(t)||0}catch(t){return 0}},set:function(t){localStorage.setItem("PrerollManager.prerollCount",JSON.stringify(t))}}]),t}(),Gt=function(t){function n(){return e(this,n),d(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"configuration",get:function(){var t=Q.shared.getConfiguration("preRoll",Kt);return b.debug("PrerollManager.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}}],[{key:"prerollCount",get:function(){return Jt.prerollCount},set:function(t){Jt.prerollCount=t}}]),n}(Jt),qt=function(t){function n(){return e(this,n),d(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"name",get:function(){return this.title}},{key:"eventId",get:function(){return this.references.eventId}},{key:"trackingId",get:function(){return this.references.trackingId}},{key:"simulcastAiringId",get:function(){return this.references.simulcastAiringId}},{key:"airingId",get:function(){return this.id}},{key:"requiresLinearPlayback",get:function(){return this.supportedMediaCommands===rt.linearPlayback}},{key:"convivaContentMetadata",get:function(){return this.tracking&&this.tracking[ht.conviva]}},{key:"trackingInfo",get:function(){return this.tracking&&this.tracking[ht.heartbeats]}},{key:"nielsenMetadata",get:function(){return this.tracking&&this.tracking[ht.nielsen]}}],[{key:"fromObject",value:function(t){var e=new n(t.id,t.title,t,t.duration,t.language,t.source);if(a(e,Tt.fromObject(t)),e.source){var i=function(t){switch(t){case wt.bam:return"BAM";case wt.none:return"NONE";case wt.shield:return"SHIELD";case wt.startSession:return"START_SESSION";default:return null}}(e.source.type);e.source.authorizationType=i}return e}}]),n}(Tt),Wt=function(t){function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mt.graphQL;return e(this,n),(t=d(this,c(n).call(this))).prerollManager=new Gt,t.apiSource=i,t.configurationKey=i===mt.graphQL?"graphqlapi":null,t}return u(n,t),i(n,[{key:"getMediaItems",value:function(t,e){var i=e||{},r=i.entitlements||[];return this.prerollManager.shouldPreroll(r)&&(i.sourceVariant=ut.stitchedPreroll),p(c(n.prototype),"getMediaItems",this).call(this,t,i).then((function(t){var e=t||[],n=e.filter((function(t){return t.source.variant===ut.stitchedPreroll})).length;return n>0?Gt.prerollCount=0:Gt.prerollCount+=e.length-n,e.map((function(t){return qt.fromObject(t)}))}))}},{key:"configuration",get:function(){var t=Q.shared.getConfiguration(this.configurationKey,n.defaultConfiguration);return b.debug("MediaItemAPI.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}}]),n}(Ht),Yt={device:{advertisingId:"0000-0000-0000-0000-0000",devType:"web"}};!function(t){t.localStorage="LOCAL_STORAGE",t.sessionStorage="SESSION_STORAGE"}(Bt||(Bt={}));var Qt,Xt=function(){function t(t,e,n,i){this.id=t,this.name=e,this.logoUrl=n,this.websiteUrl=i}return t.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},t.fromObject=function(e){return new t(e.id,e.name,e.logoUrl,e.websiteUrl)},t}();!function(t){t.token="token",t.tokenType="tokenType",t.resource="resource",t.requestor="requestor"}(Qt||(Qt={}));var Zt,$t,te=function(){function t(t,e,n,i){void 0===i&&(i={}),this.authenticationType=t,this.authenticatedProvider=e,this.authenticatedIdentity=n,this.customData=i}return t.CustomDataKey=Qt,t}(),ee=function(t,e){this.success=t,this.payload=e};!function(t){t.standard="default",t.googleAdManager="gam"}(Zt||(Zt={})),function(t){t.standard="default",t.prod="prod",t.development="dev"}($t||($t={}));var ne=function(){function t(t,e){this.id=t,this.tier=e}return t.prototype.toString=function(){return"<AuthenticatedPackage id:"+this.id+", tier:"+this.tier+">"},t.fromObject=function(e){return new t(e.id,e.tier)},t}();function ie(t,e,n){if(!t||!e||!n)return t;var i="</item></channel></rss>",r=-1;return-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:affiliateId>"+e+"</shield:affiliateId>"+t.slice(r)),-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:airingId")&&-1!==t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:airingId>"+n+"</shield:airingId>"+t.slice(r)),t}var re,ae=new function(t,e,n,i){this.preauthorizedNetworksEnabled=t,this.preauthorizedNetworks=e,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),oe=(function(){function t(t,e,n,i){void 0===i&&(i={}),this.partner=t,this.platform=e,this.requestorId=n,this.options=i,this.adobePass=null,this.providerDataSource=null,this.configuration=ae}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.isAuthenticated")},set:function(t){localStorage.setItem("AdobePassAuthenticator.isAuthenticated",JSON.stringify(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("AdobePassAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedIdentity",t):localStorage.removeItem("AdobePassAuthenticator.authenticatedIdentity")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedPackage",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedPackage");try{return ne.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedPackage",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedPackage")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedProvider");try{return Xt.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedProvider")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasPreviouslyAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.wasPreviouslyAuthenticated")||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){if(!this.isAuthenticated)return[];var t=localStorage.getItem("AdobePassAuthenticator.preauthorizedResources");try{return JSON.parse(t)}catch(t){return[]}},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this;b.debug("AdobePassAuthenticator.checkAuthentication");var e=this.adobePass;return e?e.checkAuthentication().then((function(n){return t.isAuthenticated=n,n?(localStorage.setItem("AdobePassAuthenticator.wasPreviouslyAuthenticated","true"),t.getPreauthorizedResources().then((function(t){localStorage.setItem("AdobePassAuthenticator.preauthorizedResources",JSON.stringify(t))})),e.getUserMetadata().then((function(e){var n=e.data,i=n.upstreamUserID,r=n.mvpd,a=n.packageId,o=n.tier;return t.authenticatedIdentity=i,(a||o)&&(t.authenticatedPackage=new ne(a,o)),t.providerDataSource?t.providerDataSource.getProvider(r).then((function(e){var n=e.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new Xt(r,e.name,n,e.websiteUrl),!0})).catch((function(){return t.authenticatedProvider=new Xt(r,r,null,null),!0})):(t.authenticatedProvider=new Xt(r,r,null,null),w.resolve(!0))}))):(t.authenticatedIdentity=null,t.authenticatedProvider=null,t.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources"),w.resolve(!1))})).catch((function(){return w.resolve(!1)})):w.resolve(!1)},t.prototype.authenticate=function(){var t=this;if(!this.currentRegistrationCode)return w.reject(new Error("Use getRegistrationCode first."));b.debug("AdobePassAuthenticator.authenticate currentRegistrationCode: "+this.currentRegistrationCode.code);var e=this.currentRegistrationCode.expires;return e&&Date.now()>e?w.reject(new Error("Your activation code has expired.")):new w((function(e,n){t.authenticateTimer_=setTimeout((function(){t.checkAuthentication().then((function(t){e(t)})).catch((function(t){n(t)}))}),5e3)})).then((function(e){return e||t.authenticate()}))},t.prototype.cancelAuthenticate=function(){b.debug("AdobePassAuthenticator.cancelAuthenticate"),this.authenticateTimer_&&clearTimeout(this.authenticateTimer_)},t.prototype.deauthenticate=function(){this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources");var t=this.adobePass;return t?t.logout():w.resolve(!1)},t.prototype.getRegistrationCode=function(){var t=this;b.debug("AdobePassAuthenticator.getRegistrationCode");var e=this.adobePass;return e?e.createRegistrationCode().then((function(e){return t.currentRegistrationCode=e,e?e.code:""})):w.reject(new Error("adobe pass not configured"))},t.prototype.checkAuthorization=function(t){var e=this;if(-1===t.authenticationTypes.indexOf(Pt.mvpd)||!this.isAuthenticated)return w.resolve(new ee(!1,null));var n=t.mrss,i=this.authenticatedPackage&&this.authenticatedPackage.id;i&&(n=ie(n,i,t.id));var r=n,a=this.adobePass;return a.authorize(r).then((function(){return a.getShortMediaToken(r)})).then((function(t){var n,i=t.serializedToken,a=((n={})[te.CustomDataKey.token]=i,n[te.CustomDataKey.tokenType]="ADOBEPASS",n[te.CustomDataKey.resource]=r,n[te.CustomDataKey.requestor]=e.requestorId,n),o=new te(Pt.mvpd,e.authenticatedProvider,e.authenticatedIdentity,a);return new ee(!0,o)})).catch((function(t){try{return t.json().then((function(t){var n=e.configuration.adobeAuthErrorRegex,i=new RegExp(n),r=t.message,a=t.details,o=i.test(r),s=i.test(a),u="This channel is not part of your TV package.";return o?s||(u=a):u=r,w.reject(new Error(u))}))}catch(t){return w.reject(new Error("There was an unexpected error."))}}))},t.prototype.getPreauthorizedResources=function(){var t=this.configuration,e=t.preauthorizedNetworksEnabled,n=t.preauthorizedNetworks,i=t.preauthorizeNetworksMapping;if(!1===e){var r=n;return Object.keys(i).forEach((function(t){var e=i[t];-1!==r.indexOf(t)&&-1===r.indexOf(e)&&r.push(e)})),w.resolve(r)}return 0===n.length?w.resolve([]):this.adobePass.preauthorize(n).then((function(t){var e=t.resources.filter((function(t){return!0===t.authorized})).map((function(t){return t.id}));return Object.keys(i).forEach((function(t){var n=i[t];-1!==e.indexOf(t)&&-1===e.indexOf(n)&&e.push(n)})),e}))},t.defaultConfiguration=ae}(),m((function(t,e){var n,i,r,a,o,s,u,c;t.exports=(i=(n=c=M).lib,r=i.WordArray,a=i.Hasher,o=n.algo,s=[],u=o.SHA1=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],o=n[3],u=n[4],c=0;c<80;c++){if(c<16)s[c]=0|t[e+c];else{var l=s[c-3]^s[c-8]^s[c-14]^s[c-16];s[c]=l<<1|l>>>31}var d=(i<<5|i>>>27)+u+s[c];d+=c<20?1518500249+(r&a|~r&o):c<40?1859775393+(r^a^o):c<60?(r&a|r&o|a&o)-1894007588:(r^a^o)-899497514,u=o,o=a,a=r<<30|r>>>2,r=i,i=d}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+u|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),n.SHA1=a._createHelper(u),n.HmacSHA1=a._createHmacHelper(u),c.SHA1)})),m((function(t,e){var n,i,r;t.exports=(i=(n=M).lib.Base,r=n.enc.Utf8,void(n.algo.HMAC=i.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=r.parse(e));var n=t.blockSize,i=4*n;e.sigBytes>i&&(e=t.finalize(e)),e.clamp();for(var a=this._oKey=e.clone(),o=this._iKey=e.clone(),s=a.words,u=o.words,c=0;c<n;c++)s[c]^=1549556828,u[c]^=909522486;a.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}})))})),m((function(t,e){t.exports=M.HmacSHA1})),function(){function t(t,e,n,i,r,a,o,s,u){this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a,this.rank=o,this.availability=s,this.accessType=u,this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a||[],this.rank=o,this.availability=s,this.accessType=u}return t.prototype.getPreferredLogoUrl=function(t,e){var n=this.images.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.type}))[0],i=this.images.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.type}))[0]||n;return i?"https://web.archive.org/web/20201110234047/https://s.secure.espncdn.com/stitcher/watch/clients/"+t+"-"+e+"/providers/"+this.adobeId+".png?height=40&imageType="+i:this.images.filter((function(t){return"DESKTOP"===t.type})).map((function(t){return t.href}))[0]||null},t.prototype.toString=function(){return"<Provider id:"+this.id+", name:"+this.name+", adobeId:"+this.adobeId+">"},t}());!function(t){t.mvpd="mvpd",t.isp="isp",t.tve="tve"}(re||(re={}));var se=re,ue=function(t){this.serviceUrl=t,this.serviceUrl=t};function ce(t,e){var n=t.tier||99,i=e.tier||99;if(n<i)return-1;if(n>i)return 1;var r=t.rank||9999,a=e.rank||9999;if(r<a)return-1;if(r>a)return 1;var o=t.name.toLowerCase(),s=e.name.toLowerCase();return o<s?-1:o>s?1:0}var le={negativebgcolorImage:"COLOR_NEGATIVE",negativebgbwImage:"BW_NEGATIVE",positivebgcolorImage:"COLOR_POSITIVE",positivebgbwImage:"BW_POSITIVE",desktop:"DESKTOP"};function de(t,e){if(!t)return null;var n=t.id,i=t.name,r=t.websiteUrl,a=t.adobeId,o=t.logos,s=t.accessType,u=function(t){return Object.keys(t).filter((function(e){return le[e]&&!!t[e]})).map((function(e){return{href:t[e].trim(),type:le[e]}}))}(o),c=t.countries.filter((function(t){return t.countryCode.toLowerCase()===e.toLowerCase()}))[0],l=c&&c.tier,d=c&&c.rank;return new oe(n,i,a,l,r,u,d,null,s)}function he(t,e){return t.rows?t.rows.map((function(t){return de(t.data,e)})).sort(ce):[de(t,e)]}var pe={};pe[se.mvpd]="adobeId",pe[se.isp]="ispId",pe[se.tve]="id";var fe=new ue("https://web.archive.org/web/20201110234047/https://affiliate.api.espn.com/affiliateApi/affiliates?includeProperties=true&rows=1000&apikey=q458c7hcllto16w0wcjytqoxq"),ve=function(){function t(t){this.locationProvider=t||{getCountryCode:function(){return"us"}},this.applicationId=null,this.configuration=fe}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applicationId",{get:function(){return this.applicationId_},set:function(t){this.applicationId_=t},enumerable:!0,configurable:!0}),t.prototype.getProvider=function(t,e,n){return void 0===n&&(n={}),_(this,void 0,void 0,(function(){var i,r,a,o;return E(this,(function(s){switch(s.label){case 0:return i=e||se.mvpd,r=pe[i]||"adobeId",n[r]=t,[4,this.getProviders(n)];case 1:if(a=s.sent(),!(o=a[0]))throw new Error("Unable to find provider.");return[2,o]}}))}))},t.prototype.getProviders=function(t){return void 0===t&&(t={}),_(this,void 0,void 0,(function(){var e,n,i,r,a,o,s;return E(this,(function(u){switch(u.label){case 0:e=this.configuration.serviceUrl,n=-1===e.indexOf("?")?"?":"&",i=this.applicationId,r=function(t){return-1!==["PR","GU","VI"].indexOf(t)?"US":t}(this.locationProvider.getCountryCode().toUpperCase()),t.country=r,i&&(t.application=i),a=Object.keys(t).map((function(e){if("id"!==e)return e+"="+encodeURIComponent(t[e])})).join("&"),o=""+e+n+a,t.id&&(s=e.split("?"),o=s[0]+"/"+t.id+"?"+s[1]),u.label=1;case 1:return u.trys.push([1,4,,5]),[4,I(o)];case 2:return[4,u.sent().json()];case 3:return[2,he(u.sent(),r)];case 4:return u.sent(),[2,[]];case 5:return[2]}}))}))},t.defaultConfiguration=fe,t}(),ye=(function(){function t(t){this.authenticatedProviderId=null,this.providerDataSource=null,this.partner=t.partner,this.platform=t.platform}Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return!!this.token&&!!this.tokenType},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("TokenAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedIdentity",t):localStorage.removeItem("TokenAuthenticator.authenticatedIdentity")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("TokenAuthenticator.authenticatedProvider");try{return Xt.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("TokenAuthenticator.authenticatedProvider")},enumerable:!0,configurable:!0}),t.prototype.setToken=function(t,e,n){this.token=t,this.tokenType=e,this.resource=n},t.prototype.checkAuthentication=function(){var t=this,e=this.authenticatedProviderId;if(!e||this.authenticatedProvider&&e===this.authenticatedProvider.id)return w.resolve(this.isAuthenticated);if(!this.providerDataSource)return this.authenticatedProvider=new Xt(e,e,null,null),w.resolve(this.isAuthenticated);var n,i="ADOBEPASS"===(n=this.tokenType)?se.mvpd:"DEVICE"===n?se.isp:null;return this.providerDataSource.getProvider(e,i).then((function(n){var i=n.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new Xt(e,n.name,i,n.websiteUrl),w.resolve(t.isAuthenticated)})).catch((function(){return t.authenticatedProvider=new Xt(e,e,null,null),w.resolve(t.isAuthenticated)}))},t.prototype.authenticate=function(t){var e=t.authenticatedProviderId,n=t.authenticatedIdentity,i=t.token,r=t.tokenType;return this.authenticatedProviderId=e,this.authenticatedIdentity=n,this.setToken(i,r,null),this.checkAuthentication()},t.prototype.deauthenticate=function(){return this.authenticatedProvider=null,this.authenticatedIdentity=null,this.token=null,this.tokenType=null,this.resource=null,w.resolve(!0)},t.prototype.checkAuthorization=function(t){var e,n,i="ADOBEPASS"===(n=this.tokenType)?Pt.mvpd:"DEVICE"===n?Pt.isp:"BAM"===n?Pt.direct:null;if(!this.isAuthenticated||-1===t.authenticationTypes.indexOf(i)&&"DEVICE"!==this.tokenType&&"GATEKEEPER"!==this.tokenType)return w.resolve(new ee(!1,null));var r=((e={})[te.CustomDataKey.token]=this.token,e[te.CustomDataKey.tokenType]=this.tokenType,e);this.resource&&(r.resource=this.resource);var a=new te(i,this.authenticatedProvider,this.authenticatedIdentity,r),o=new ee(!0,a);return w.resolve(o)}}(),"watchsdk.web_adobe_pass_authenticator.state"),ge=function(t,e){e.setItem(ye,JSON.stringify(t))},me={production:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyZGJmZWM4My03OWE1LTQyNzEtYTVmZC04NTZjYTMxMjRjNjMiLCJuYmYiOjE1NDAyMTI3NjEsImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjEyNzYxfQ.yaK3r4AI2uLVvsyN1GLzqzgzRlxMPtasSaiYYBV0wIstqih5tvjTmeoLmi8Xy9Kp_U7Md-bOffwiyK3srHkpUkhhwXLH2x6RPjmS1tPmhaG7-3LBcHTf2ySPvXhVf7cN4ngldawK4tdtLtsw6rF_JoZE2yaC6XbS2F51nXSFEDDnOQWIHEQRG3aYAj-38P2CLGf7g-Yfhbp5cKXeksHHQ90u3eOO4WH0EAjc9oO47h33U8KMEXxJbvjV5J8Va2G2fQSgLDZ013NBI3kQnE313qgqQh2feQILkyCENpB7g-TVBreAjOaH1fU471htSoGGYepcAXv-UDtpgitDiLy7CQ",staging:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhMmRjNjgyMC1kZGNkLTQ4NGEtOTdlNS0xZjJiZmQzOGI4YzgiLCJuYmYiOjE1NDAyMjIwNTksImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjIyMDU5fQ.YgX4ecGCgLCaZS7uwRQYZ8UR5EwT7GIl-glFbwU122bO1JYZSmbIX8YJSfmYth_scyeg-15BYWNftV9lOcmCe8VwIsQMJMIZKaF8qSIj5OfuTOBpNZNBpDAp5dC3zG7Zp1xLe3z-T0Y18-0BGj2yhGcJxBz4gtLXQ30Bw0LEIJ89nXCQaXFTq9N6zhDzMfkFJNnSNEvEmvcQqB4bFPIqn2is8427oQDU4D0XYvvTtx9eb5hmzKc9MbBG-8KRBA62BqdHomA5UA4kBYJKpe-8B2hO07Adi2bZoo5wP_VLNAnAxANWNXaGQYHMDjHDrHbbvuKHBudHgKxAuKpIdC7UrA"},be=new function(t,e,n,i){this.preauthorizeNetworksEnabled=t,this.preauthorizeNetworks=e,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),Pe="mvpd",we="upstreamUserID",Ae="packageId",Ie="tier",Se="hba_status",ke={},Te=function(){function t(e,n,i,r,a){this.partner=e,this.platform=n,this.requestorId=i,this.options=r,this.configuration=be;var o=r||{},s=o.environment,u=void 0===s?t.Environment.PRODUCTION:s,c=o.errorEventHandlerName,l=void 0===c?"AEErrorHandler":c;this.accessEnabler=null,this.environment=u,this.errorEventHandlerName=l,this.resolveEntitlementLoaded_=null,this.resolveCheckAuthenticationCompletions_=[],this.resolveAuthenticate_=null,this.resolveDeauthenticate_=null,this.resolveAuthorization_=null,this.resolvePreauthorizes_=[],this.resolveAuthenticateMetadataDependencies_={},this.softwareStatements=a||me,this.delegate=null,this.providerDataSource=null,this.storage=localStorage,this.state_={};try{var d=this.storage.getItem(ye),h=JSON.parse(d);h.authenticatedProvider&&(h.authenticatedProvider=Xt.fromObject(h.authenticatedProvider)),h.authenticatedPackage&&(h.authenticatedPackage=ne.fromObject(h.authenticatedPackage)),this.state_=h}catch(t){}this.initialization_=this.initialize(),window.tokenRequestFailed=this.tokenRequestFailed.bind(this)}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===this.state_.isAuthenticated.toString()},set:function(t){this.state_.isAuthenticated=t,ge(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return this.state_.authenticatedIdentity},set:function(t){if(!t)return delete this.state_.authenticatedIdentity,void ge(this.state_.toString,this.storage);this.state_.authenticatedIdentity=t,ge(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedPackage",{get:function(){return this.state_.authenticatedPackage},set:function(t){if(!t)return delete this.state_.authenticatedPackage,void ge(this.state_,this.storage);this.state_.authenticatedPackage=t,ge(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(t){if(!t)return delete this.state_.authenticatedProvider,void ge(this.state_,this.storage);this.state_.authenticatedProvider=t,ge(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasPreviouslyAuthenticated",{get:function(){var t,e;return"true"===(null===(e=null===(t=this.state_)||void 0===t?void 0:t.wasPreviouslyAuthenticated)||void 0===e?void 0:e.toString())||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return this.isAuthenticated?this.state_.preauthorizedResources:[]},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this;return b.debug("AdobePassAuthenticator.checkAuthentication"),this.accessEnabler?new w((function(e){t.resolveCheckAuthenticationCompletions_.push((function(t){e(t)})),t.accessEnabler.checkAuthentication()})):w.reject(null)},t.prototype.authenticate=function(t){var e=this;if(b.debug("AdobePassClient.authenticate"),!this.accessEnabler)return w.reject(null);var n=t&&t.redirectUrl||window.location.href;return new w((function(t){e.resolveAuthenticate_=function(e){t(e)},e.accessEnabler.getAuthentication(n)}))},t.prototype.deauthenticate=function(){var t=this;return b.debug("AdobePassAuthenticator.deauthenticate"),this.accessEnabler?new w((function(e){t.resolveDeauthenticate_=function(t){e(t)},t.accessEnabler.logout()})):w.reject(null)},t.prototype.checkAuthorization=function(t){var e,n=this;if(b.debug("AdobePassClient.checkAuthorization "+t),-1===(null===(e=t.authenticationTypes)||void 0===e?void 0:e.indexOf(Pt.mvpd))||!this.isAuthenticated){var i=new ee(!1,null);return w.resolve(i)}var r=t.mrss,a=this.authenticatedPackage&&this.authenticatedPackage.id;a&&(r=ie(r,a,t.id));var o=r;return new w((function(t,e){n.resolveAuthorization_=function(i){var r,a=i.token,o=i.resourceId,s=i.errorId,u=i.message;if(a||!s){var c=((r={})[te.CustomDataKey.token]=D.stringify(U.parse(a)),r[te.CustomDataKey.tokenType]="ADOBEPASS",r[te.CustomDataKey.resource]=o,r),l=new te(Pt.mvpd,n.authenticatedProvider,n.authenticatedIdentity,c),d=new ee(!0,l);t(d)}else e(new Error(u||s))},n.accessEnabler.getAuthorization(o)}))},t.prototype.setProvider=function(t){this.accessEnabler.setSelectedProvider(t)},Object.defineProperty(t.prototype,"isHomeBasedAuth",{get:function(){return this.hbaStatus||!1},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){var t=this,e=this.environment;return function(t,e){var n=window&&window.document;if(!n)return w.reject();if(window.Adobe&&window.Adobe.AccessEnabler){var i=new window.Adobe.AccessEnabler(e);return w.resolve(i)}return new w((function(i,r){var a=n.createElement("script");a.id="ae_js",a.type="text/javascript",a.async=!0,a.src=t,a.addEventListener("load",(function(){var t=new window.Adobe.AccessEnabler(e);i(t)})),a.addEventListener("error",(function(){r()})),n.getElementsByTagName("head")[0].appendChild(a)}))}(ke[e],this.softwareStatements[e]).then((function(e){return t.accessEnabler=e,w.resolve()})).then((function(){return new w((function(e){t.resolveEntitlementLoaded_=e,t.bindAccessEnablerCallbacks()}))}))},t.prototype.bindAccessEnablerCallbacks=function(){window.entitlementLoaded=this.entitlementLoaded.bind(this),window.setAuthenticationStatus=this.setAuthenticationStatus.bind(this),window.setMetadataStatus=this.setMetadataStatus.bind(this),window.displayProviderDialog=this.displayProviderDialog.bind(this),window.setConfig=this.setConfig.bind(this),window.sendTrackingData=this.sendTrackingData.bind(this),window.preauthorizedResources=this.handlePreauthorizedResources.bind(this),window.selectedProvider=this.selectedProvider.bind(this),window.setToken=this.setToken.bind(this),window[this.errorEventHandlerName]=this.handleAccessEnablerError.bind(this)},t.prototype.entitlementLoaded=function(){b.debug("AdobePassAuthenticator.entitlementLoaded"),this.accessEnabler&&(this.accessEnabler.bind("errorEvent",this.errorEventHandlerName),this.accessEnabler.setRequestor(this.requestorId),this.resolveEntitlementLoaded_&&(this.resolveEntitlementLoaded_(!0),this.resolveEntitlementLoaded_=null))},t.prototype.setAuthenticationStatus=function(t,e){var n=this;if(b.debug("AdobePassAuthenticator.setAuthenticationStatus",t,e),this.isAuthenticated=!!t,this.isAuthenticated){this.accessEnabler.getMetadata(we);var i=[Ae,Ie,Se,Pe].map((function(t){return new w((function(e){n.resolveAuthenticateMetadataDependencies_[t]=function(t){e(t)},n.accessEnabler.getMetadata(t)})).catch((function(t){return b.warn(t),null}))}));i.push(this.getPreauthorizedResources_().then((function(t){n.state_.preauthorizedResources=t}))),w.all(i).then((function(){n.resolveCheckAuthenticationCompletions_.forEach((function(t){t(n.isAuthenticated)})),n.resolveCheckAuthenticationCompletions_=[],n.resolveAuthenticate_&&(n.resolveAuthenticate_(n.isAuthenticated),n.resolveAuthenticate_=null)}))}else this.authenticatedIdentity=null,this.authenticatedPackage=null,this.authenticatedProvider=null,this.hbaStatus=null,this.state_.preauthorizedResources=[],this.resolveCheckAuthenticationCompletions_.forEach((function(t){t(n.isAuthenticated)})),this.resolveCheckAuthenticationCompletions_=[],this.resolveDeauthenticate_&&(this.resolveDeauthenticate_(this.isAuthenticated),this.resolveDeauthenticate_=null)},t.prototype.setMetadataStatus=function(t,e,n){var i=this;switch(b.debug("AdobePassAuthenticator.setMetadataStatus",t,n),t){case Pe:var r=n;this.providerDataSource?this.providerDataSource.getProvider(r).then((function(e){var a=e.images||[],o=a.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.href}))[0],s=a.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.href}))[0]||o||a.map((function(t){return t.href}))[0];i.authenticatedProvider=new Xt(r,e.name,s,e.websiteUrl),i.authenticatedProvider.isHomeBasedAuth=i.hbaStatus,i.resolveAuthenticateMetadata_(t,n)})).catch((function(){i.authenticatedProvider=new Xt(r,r,null,null),i.resolveAuthenticateMetadata_(t,n)})):(this.authenticatedProvider=new Xt(r,r,null,null),this.resolveAuthenticateMetadata_(t,n));break;case we:this.authenticatedIdentity=n,this.resolveAuthenticateMetadata_(t,n);break;case Se:this.hbaStatus="true"===n,this.resolveAuthenticateMetadata_(t,n);break;case Ae:case Ie:if(n){var a=this.authenticatedPackage||new ne(null,null);t===Ae?a.id=n:t===Ie&&(a.tier=n),this.authenticatedPackage=a}this.resolveAuthenticateMetadata_(t,n)}},t.prototype.displayProviderDialog=function(t){var e=this;b.debug("AdobePassAuthenticator.displayProviderDialog",t),this.providerDataSource&&this.providerDataSource.getProviders().then((function(t){e.delegate&&e.delegate.selectProvider&&e.delegate.selectProvider(t)}))},t.prototype.setConfig=function(){},t.prototype.sendTrackingData=function(t,e){if("authenticationDetection"===t){var n={success:e[0],mvpd:e[1],guid:e[2],isTokenCached:e[3],deviceType:e[4],clientType:e[5],os:e[6]};b.debug("AdobePassAuthenticator.sendTrackingData",t,n)}},t.prototype.handlePreauthorizedResources=function(t){b.debug("AdobePassAuthenticator.preauthorizedResources",t);var e=this.resolvePreauthorizes_.shift();e&&e(t)},t.prototype.selectedProvider=function(t){var e=t.MVPD,n=t.AEstate_;b.debug("AdobePassAuthenticator.selectedProvider mvpd: "+e+", aeState: "+n)},t.prototype.setToken=function(t,e){b.debug("Requested resource: "+t+" tokenResult: "+e),this.resolveAuthorization_&&(this.resolveAuthorization_({resourceId:t,token:e}),this.resolveAuthorization_=null)},t.prototype.handleAccessEnablerError=function(t){var e=t.errorId,n=t.message;switch(b.debug("AdobePassAuthenticator.handleAccessEnablerError errorId: "+e+", message: "+n),e){case"Z100":b.error("Failure to authorize: "+n);var i=this.configuration.adobeAuthErrorRegex,r=new RegExp(i).test(n)?"This channel is not part of your TV package.":n;this.resolveAuthorization_&&(this.resolveAuthorization_({errorId:e,message:r}),this.resolveAuthorization_=null);break;case"N130":this.checkAuthentication()}},t.prototype.tokenRequestFailed=function(){b.debug("AdobePassAuthenticator.tokenRequestFailed")},t.prototype.resolveAuthenticateMetadata_=function(t,e){var n=this.resolveAuthenticateMetadataDependencies_[t];n&&(n(e),delete this.resolveAuthenticateMetadataDependencies_[t])},t.prototype.getPreauthorizedResources_=function(){var t=this;b.debug("AdobePassAuthenticator.getPreauthorizedResources_");var e=this.configuration,n=e.preauthorizeNetworksEnabled,i=e.preauthorizeNetworks,r=e.preauthorizeNetworksMapping;if(!1===n){var a=i;return Object.keys(r).forEach((function(t){var e=r[t];-1!==a.indexOf(t)&&-1===a.indexOf(e)&&a.push(e)})),w.resolve(a)}if(0===i.length||!0!==this.isAuthenticated)return w.resolve([]);if(!this.accessEnabler)return w.reject(null);var o=function t(e,n){return e.length?O([e.slice(0,n)],t(e.slice(n),n)):[]}(i,5),s=[],u=o.map((function(e){return new w((function(n){s.push((function(t){n(t)})),t.accessEnabler.checkPreauthorizedResources(e)})).catch((function(){return[]}))}));return this.resolvePreauthorizes_=s,w.all(u).then((function(t){return t.reduce((function(t,e){return t.concat(e)}),[])}))},t.defaultConfiguration=be,t}();Te.Environment={PRODUCTION:"production",STAGING:"staging"},Te.EventType={PREAUTHORIZED:"preauthorized",NOT_PREAUTHORIZED:"not_preauthorized"},ke[Te.Environment.PRODUCTION]="https://web.archive.org/web/20201110234047/https://entitlement.auth.adobe.com/entitlement/v4/AccessEnabler.js",ke[Te.Environment.STAGING]="https://web.archive.org/web/20201110234047/https://entitlement.auth-staging.adobe.com/entitlement/v4/AccessEnabler.js";var _e,Ee=function(t){function n(){return e(this,n),d(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"configuration",get:function(){var t=Q.shared.getConfiguration("adobePass",Te.defaultConfiguration);return b.debug("WebAdobePassAuthenticator.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}}]),n}(Te);!function(t){t.localStorage="LOCAL_STORAGE",t.sessionStorage="SESSION_STORAGE"}(_e||(_e={}));var Ce,Oe=_e,Me=function(){function t(t,e,n,i){this.id=t,this.name=e,this.logoUrl=n,this.websiteUrl=i}return t.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},t.fromObject=function(e){return new t(e.id,e.name,e.logoUrl,e.websiteUrl)},t}();!function(t){t.token="token",t.tokenType="tokenType",t.resource="resource"}(Ce||(Ce={}));var De=function(){function t(t,e,n,i){void 0===i&&(i={}),this.authenticationType=t,this.authenticatedProvider=e,this.authenticatedIdentity=n,this.customData=i}return t.CustomDataKey=Ce,t}(),Ue=function(t,e){this.success=t,this.payload=e};!function(t){t.standard="default",t.googleAdManager="gam"}(t.AdProvider||(t.AdProvider={})),function(t){t.standard="default",t.prod="prod",t.development="dev"}(t.AdEnvironment||(t.AdEnvironment={}));var Ne=function(t){return null===t?null:t?"1":"0"},je=function(t,e){return null!=t?t:e},Re=function(){function e(e,n,i,r,a,o,s,u,c,l,d,h,p,f,v,y,g,m,b,P,w,A,I,S,k,T,_,E,C,O,M,D){void 0===e&&(e="espn"),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a=null),void 0===o&&(o=!1),void 0===s&&(s=null),void 0===u&&(u=null),void 0===c&&(c=!1),void 0===l&&(l=null),void 0===d&&(d=null),void 0===h&&(h=!1),void 0===p&&(p=null),void 0===f&&(f=null),void 0===v&&(v=null),void 0===y&&(y=null),void 0===g&&(g=null),void 0===m&&(m=null),void 0===b&&(b=null),void 0===P&&(P=null),void 0===w&&(w=null),void 0===A&&(A=null),void 0===I&&(I=null),void 0===S&&(S=null),void 0===k&&(k=null),void 0===T&&(T=null),void 0===_&&(_=null),void 0===E&&(E=null),void 0===C&&(C=null),void 0===O&&(O={}),void 0===M&&(M=t.AdEnvironment.standard),void 0===D&&(D=t.AdProvider.standard),this.an=e,this.descriptionUrl=n,this.fcap=i,this.hl=r,this.idType=a,this.isLat=o,this.iu=s,this.msid=u,this.npa=c,this.ppid=l,this.rdid=d,this.tfcd=h,this.url=p,this.vpa=f,this.vpmute=v,this.authenticationProvider=y,this.bundleId=g,this.deviceOS=m,this.deviceType=b,this.isAutoplay=P,this.isMute=w,this.nielsenAppId=A,this.nielsenDeviceGroup=I,this.platform=S,this.stitchingProvider=k,this.swid=T,this.unid=_,this.videoDeliveryMethod=E,this.videoPlayerSize=C,this.userInfo=O,this.adEnvironment=M,this.adProvider=D}return e.prototype.merge=function(e){return e?(this.an=e.an||this.an,this.descriptionUrl=e.descriptionUrl||this.descriptionUrl,this.fcap=e.fcap||this.fcap,this.hl=e.hl||this.hl,this.idType=e.idType||this.idType,this.isLat=je(e.isLat,this.isLat),this.iu=e.iu||this.iu,this.msid=e.msid||this.msid,this.npa=je(e.npa,this.npa),this.ppid=e.ppid||this.ppid,this.rdid=e.rdid||this.rdid,this.tfcd=je(e.tfcd,this.tfcd),this.url=e.url||this.url,this.vpa=je(e.vpa,this.vpa),this.vpmute=je(e.vpmute,this.vpmute),this.authenticationProvider=e.authenticationProvider||this.authenticationProvider,this.bundleId=e.bundleId||this.bundleId,this.deviceOS=e.deviceOS||this.deviceOS,this.deviceType=e.deviceType||this.deviceType,this.isAutoplay=je(e.isAutoplay,this.isAutoplay),this.isMute=je(e.isMute,this.isMute),this.nielsenAppId=e.nielsenAppId||this.nielsenAppId,this.nielsenDeviceGroup=e.nielsenDeviceGroup||this.nielsenDeviceGroup,this.platform=e.platform||this.platform,this.stitchingProvider=e.stitchingProvider||this.stitchingProvider,this.swid=e.swid||this.swid,this.unid=e.unid||this.unid,this.videoDeliveryMethod=e.videoDeliveryMethod||this.videoDeliveryMethod,this.videoPlayerSize=e.videoPlayerSize||this.videoPlayerSize,this.userInfo?Object.assign(this.userInfo,e.userInfo):this.userInfo=e.userInfo,this.adEnvironment=e.adEnvironment!==t.AdEnvironment.standard?e.adEnvironment:this.adEnvironment,this.adProvider=e.adProvider!==t.AdProvider.standard?e.adProvider:this.adProvider,this):this},e.prototype.dictionaryForStartSession=function(){var e={};return e["ad.tfcd"]=Ne(this.tfcd),e["ad.is_lat"]=Ne(this.isLat),e["ad.idtype"]=this.idType,e["ad.rdid"]=this.rdid,e["ad.ppid"]=this.ppid||this.swid,e["ad.description_url"]=this.descriptionUrl,e["ad.hl"]=this.hl,e["ad.npa"]=Ne(this.npa),e["ad.msid"]=this.msid,e["ad.an"]=this.an,e["ad.url"]=this.url,e.authp=this.authenticationProvider,e.bundleId=this.bundleId,e.devOS=this.deviceOS,e.devType=this.deviceType,e.fcap=this.fcap,e.isAutoplay=Ne(this.isAutoplay),e.isMute=Ne(this.isMute),e.nlsnAppID=this.nielsenAppId,e.plt=this.platform,e.swid=this.swid,e.unid=this.unid,e.vps=this.videoPlayerSize,this.adEnvironment!==t.AdEnvironment.standard&&(e.adEnv=this.adEnvironment),this.adProvider!==t.AdProvider.standard&&(e.adProvider=this.adProvider),Object.assign(e,this.userInfo),Object.keys(e).forEach((function(t){return null===e[t]&&delete e[t]})),e},e.prototype.dictionaryForBrightcove=function(){var t={};t.bundleId=this.bundleId,t.devOS=this.deviceOS,t.devType=this.deviceType,t.isAutoplay=Ne(this.isAutoplay),t.isMute=Ne(this.isMute),t.plt=this.platform,t.swid=this.swid,t.vps=this.videoPlayerSize,t.d_id=this.rdid,t.vdm=this.videoDeliveryMethod||"vod",t.stp=this.stitchingProvider||"brightcove";var e=Object.keys(t).filter((function(e){return null!==t[e]})).map((function(e){return e+"="+t[e]})).join("&"),n={};return n.UMADPARAMiu=this.iu,n.UMADPARAMis_lat=Ne(this.isLat),n.UMADPARAMidtype=this.idType,n.UMADPARAMrdid=this.rdid,n.UMADPARAMppid=this.ppid||this.swid,n.UMADPARAMdescription_url=this.descriptionUrl,n.UMADPARAMhl=this.hl,n.UMADPARAMnpa=Ne(this.npa),n.UMADPARAMmsid=this.msid,n.UMADPARAMan=this.an,n.UMADPARAMurl=this.url,n.UMADPARAMvpa=Ne(this.vpa),n.UMADPARAMvpmute=Ne(this.vpmute),n.UMPTPARAMcust_params=e,Object.assign(n,this.userInfo),Object.keys(n).forEach((function(t){return null===n[t]&&delete n[t]})),n},e.prototype.dictionaryForAdEngine=function(){var e={};switch(e.sect=this.iu,e.npa=Ne(this.npa),e.lat=Ne(this.isLat),e.idtype=this.idType,e.devId=this.rdid,e.ppid=this.ppid||this.swid,e.app=this.an,e.tfcd=Ne(this.tfcd),e.devOS=this.deviceOS,e.devType=this.deviceType,e.isAutoplay=Ne(this.isAutoplay),e.isMute=Ne(this.isMute),e.plt=this.platform,e.swid=this.swid,e.unid=this.unid,e.vps=this.videoPlayerSize,e.bundle=this.msid,e.hl=this.hl,e.UID=this.swid,e.vdm=this.videoDeliveryMethod,e.url=this.url,this.adEnvironment){case t.AdEnvironment.development:e.env="qa";break;case t.AdEnvironment.prod:e.env="prod";break;case t.AdEnvironment.standard:}switch(this.adProvider){case t.AdProvider.googleAdManager:e.ads="google";break;case t.AdProvider.standard:}return Object.assign(e,this.userInfo),Object.keys(e).forEach((function(t){return null===e[t]&&delete e[t]})),e},e.ppidForSwid=function(t){return t},e}(),Le=function(){function t(){this.partner=null,this.platform=null,this.apiKey=null,this.deviceId=null,this.authenticators={},this.authorizers={},this.playbackSessionFactories={}}return t.prototype.getAuthenticator=function(t){return this.authenticators[t]},t.prototype.setAuthenticator=function(t,e){var n=this;this.convertToArray(e).forEach((function(e){n.authenticators[e.toString()]=t}))},t.prototype.getAuthorizer=function(t){return this.authorizers[t]},t.prototype.setAuthorizer=function(t,e){var n=this;this.convertToArray(e).forEach((function(e){n.authorizers[e.toString()]=t}))},t.prototype.getPlaybackSessionFactory=function(t){return this.playbackSessionFactories[t]},t.prototype.setPlaybackSessionFactory=function(t,e){var n=this;this.convertToArray(e).forEach((function(e){n.playbackSessionFactories[e.toString()]=t}))},t.prototype.checkAuthentication=function(){var t=this,e=Object.keys(this.authenticators).map((function(e){var n=t.authenticators[e];return n.checkAuthentication().then((function(t){return b.debug(e+" authenticator","isAuthenticated: "+t,"authenticatedProvider: "+n.authenticatedProvider),t})).catch((function(){return!1}))}));return w.all(e).then((function(t){return t.every((function(t){return!0===t}))}))},t.prototype.isAuthenticatedForMediaItem=function(t){var e=this;return t.authenticationTypes.length<1||-1!==t.authenticationTypes.indexOf(Pt.none)||t.authenticationTypes.map((function(t){return e.authenticators[t]})).filter((function(t){return t})).some((function(t){return t.isAuthenticated}))},t.prototype.isAuthenticatedWithAuthType=function(t){var e=this.authenticators[t];return!!e&&e.isAuthenticated},t.prototype.authenticateWithAuthType=function(t,e){var n=this.authenticators[t];if(n)return n.authenticate(e)},t.prototype.checkAuthorization=function(t,e){var n=this;if(t.authenticationTypes&&t.authenticationTypes.length<1||-1!==t.authenticationTypes.indexOf(Pt.none)){var i=new Me(t.id,t.title,t.images[0].url,t.source.url),r=new De(Pt.none,i,t.id,{}),a=new Ue(!0,r);return w.resolve(a)}var o=[Pt.open,Pt.mvpd,Pt.direct,Pt.isp].filter((function(e){return-1!==t.authenticationTypes.indexOf(e)})),s=o.map((function(t){return n.authorizers[t]})).filter((function(t){return t&&t.checkAuthorization}));return b.debug("mediaItem.authTypes:",o),0===s.length?w.reject(new Error("no authorizer configured to support authTypes: "+t.authenticationTypes)):function t(e,n,i,r){return void 0===r&&(r=[]),i.shift().checkAuthorization(e,n).then((function(a){return a.success?a:i.length<1?r.length>0?w.reject(null):a:t(e,n,i,r)})).catch((function(a){if(i.length>0)return a&&r.push(a),t(e,n,i,r);var o=r[0]||a;if(o)throw o}))}(t,e,s)},t.prototype.initPlaybackSession=function(t,e){var n=this;return!t.source.type&&t.authenticationTypes.length>0?w.reject(new Error("This event is not currently available.")):this.checkAuthorization(t,e).then((function(i){b.debug("AuthenticationManager.initPlaybackSession.checkAuthorization result:",i.success);var r=i.success,a=i.payload;if(!r)throw new Error("Not authorized.");var o=a.authenticationType;if(!o)throw new Error("Not authorized.");var s=n.playbackSessionFactories[o],u=new Re;return u.authenticationProvider=i.payload.authenticatedProvider&&i.payload.authenticatedProvider.id,u.merge(e),s.initPlaybackSession(t,u,a).then((function(t){return b.debug("AuthenticationManager.initPlaybackSession",t),t}))}))},Object.defineProperty(t.prototype,"authStates",{get:function(){var t=this.authenticators[Pt.mvpd],e=[];return this.authenticators[Pt.isp].isAuthenticated&&e.push("isp"),!0===t.isAuthenticated?e.push("mvpd_login"):!0===t.wasPreviouslyAuthenticated&&e.push("mvpd_previous"),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){var t=this;return Object.keys(this.authenticators).map((function(e){return t.authenticators[e].preauthorizedResources})).reduce((function(t,e){return t.concat(e)}),[]).filter((function(t,e,n){return n.indexOf(t)===e}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"primaryAuthenticatedProvider",{get:function(){var t=this;return[Pt.mvpd,Pt.isp].map((function(e){return t.getAuthenticator(e)})).filter((function(t){return t.isAuthenticated})).map((function(t){return t.authenticatedProvider}))[0]},enumerable:!0,configurable:!0}),t.prototype.convertToArray=function(t){if(!t)return[];var e=[];return Array.isArray(t)?e=t:"string"==typeof t&&e.push(t),e},t}();Le.AuthenticateOptionsKey={redirectUrl:"redirectUrl"};var xe,ze=function(t,e,n){this.contentType=t,this.keySystem=e,this.licenseUrl=n},He=function(){function t(t){this.playbackUrl=t,this.textTracks=[]}return Object.defineProperty(t.prototype,"convivaContentMetadata",{get:function(){var t={accessType:null,mvpd:null};this.authenticationType&&(t.accessType=this.authenticationType&&this.authenticationType.toLowerCase()||"free",this.authenticatedProvider&&this.authenticationType===Pt.mvpd&&(t.mvpd=this.authenticatedProvider.id));var e=this.mediaItem&&this.mediaItem.tracking[ht.conviva]||{},n={streamUrl:this.playbackUrl,custom:Object.assign(e.custom||{},t)};return Object.assign(e,n)},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"<PlaybackSession playbackUrl:"+this.playbackUrl+", authenticationType:"+this.authenticationType+", authenticatedProvider:"+this.authenticatedProvider+">"},t}();!function(t){t.none="none",t.fairPlay="fairplay",t.playReady="playready",t.widevine="widevine"}(xe||(xe={}));var Be,Ve=xe;!function(t){t.none="HLS",t.hlsFairplay="HLS_FAIRPLAY",t.dashPlayReady="DASH_PLAYREADY",t.dashWidevine="DASH_WIDEVINE"}(Be||(Be={}));var Fe=Be,Ke=function(t,e,n){var i=-1===n.indexOf("?")?"?":"&";return n+i+t+"="+encodeURIComponent(e)},Je=function(){function t(){}return t.prototype.initPlaybackSession=function(t,e,n){var i=e&&e.swid,r=t.source.url;if(t.source.variant===ut.stitchedPreroll){var a=e.dictionaryForBrightcove();Object.keys(a).forEach((function(t){r=Ke(t,a[t].toString(),r)}))}else r=Ke("SWID",i,r);b.debug(r,t);var o=new He(r);return o.mediaItem=t,o.seekToTime=t.seekInSeconds,o.authenticationType=n.authenticationType,o.authenticatedProvider=n.authenticatedProvider,o.authenticatedIdentity=n.authenticatedIdentity,w.resolve(o)},t}(),Ge=function(){return(Ge=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function qe(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function We(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var Ye="https://web.archive.org/web/20201110234047/https://streams.adobeprimetime.com/v2",Qe="live",Xe="vod",Ze="accountId",$e="channel",tn="contentType",en="contractType",nn="hba",rn="ship",an="region",on=function(t){var e=t+":";return{Authorization:"Basic "+D.stringify(U.parse(e)),Accept:"application/json"}},sn=function(){function t(t,e,n,i,r){e&&n&&i&&(this.programmer=t,this.applicationId=e,this.identityProvider=encodeURIComponent(n),this.subject=encodeURIComponent(i),this.metadata=r||{},this.serviceUrl=Ye,this.requestHeaders=on(e),this.heartbeatIntervalId=null,this.messages={})}return t.fetchMetadataKeys=function(t,e){return qe(this,void 0,void 0,(function(){var n,i,r,a;return We(this,(function(o){switch(o.label){case 0:n=e+"/metadata",i=on(t),r={method:"GET",headers:i},o.label=1;case 1:return o.trys.push([1,4,,5]),[4,I(n,r)];case 2:return[4,o.sent().json()];case 3:return function(t,e){var n="AdobeCM.metadata."+e;localStorage.setItem(n,JSON.stringify(t))}(o.sent(),t),[2,!0];case 4:return a=o.sent(),console.error("fetchMetadataKeys error: "+a),[2,!1];case 5:return[2]}}))}))},Object.defineProperty(t.prototype,"metadataKeys",{get:function(){return function(t){var e="AdobeCM.metadata."+t,n=[];try{n=JSON.parse(localStorage.getItem(e))||[]}catch(t){}return n}(this.applicationId)},enumerable:!0,configurable:!0}),t.prototype.start=function(){return qe(this,void 0,void 0,(function(){var t;return We(this,(function(e){switch(e.label){case 0:return[4,this.createSession()];case 1:return(t=e.sent())?(this.scheduleHeartbeat(),[2,t]):[2,null]}}))}))},t.prototype.startWithSession=function(t){this.sessionId=t,this.scheduleHeartbeat()},t.prototype.stop=function(){this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=null),this.terminateSession()},t.prototype.createSession=function(t){return void 0===t&&(t=[]),qe(this,void 0,void 0,(function(){var e,n,i,r,a,o,s,u,c;return We(this,(function(l){switch(l.label){case 0:b.debug("AdobeConcurrencyMonitorV2.createSession"),e=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject,n=Ge({"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},this.requestHeaders),t.length>0&&(n["X-Terminate"]=t.join(",")),i=this.getMetadata(),r=Object.keys(i).map((function(t){return t+"="+encodeURIComponent(i[t])})).join("&"),a={method:"POST",headers:n,body:r},l.label=1;case 1:return l.trys.push([1,3,,5]),[4,I(e,a)];case 2:if(o=l.sent(),!((s=o.status)>=200&&s<300))throw o;return u=o.headers.get("location").trim(),this.sessionId=u,b.debug("AdobeConcurrencyMonitorV2.createSession sessionId:",u),[2,u];case 3:return c=l.sent(),b.error("AdobeConcurrencyMonitorV2.createSession error: "+c),[4,this.handleError(c,null)];case 4:return[2,l.sent()];case 5:return[2]}}))}))},t.prototype.scheduleHeartbeat=function(){var t=this;b.debug("AdobeConcurrencyMonitorV2.scheduleHeartbeat"),this.heartbeatIntervalId=window.setTimeout((function(){t.heartbeat()}),45e3)},t.prototype.heartbeat=function(){var t=this,e=this.sessionId;e&&(b.debug("AdobeConcurrencyMonitorV2.heartbeat",e),I(this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+e,{method:"POST",headers:this.requestHeaders}).then((function(e){var n=e.status;if(!(n>=200&&n<300))throw e;t.scheduleHeartbeat()})).catch((function(e){return t.handleError(e,t.onError)})))},t.prototype.terminateSession=function(){var t=this.sessionId;t&&I(this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+t,{method:"DELETE",headers:this.requestHeaders}).then((function(t){var e=t.status;if(!(e>=200&&e<300))throw t}))},t.prototype.handleError=function(e,n){var i=this;switch(b.debug("AdobeConcurrencyMonitorV2.handleError",e),e.status){case 400:return e.json().then((function(e){if(!!(e.obligations||[]).find((function(t){return"logout"===t.action||"refresh"===t.action})))return t.fetchMetadataKeys(i.applicationId,i.serviceUrl).then((function(){var t=i.metadata;if(Object.keys(t).length>=i.metadataKeys.length)return i.start()}))}));case 409:return e.json().then((function(t){var r=(t.associatedAdvice||[]).find((function(t){return"rule-violation"===t.type}));if(r){var a=r.message,o=i.messages[a]||a,s=new Error(o),u=!!(t.obligations||[]).find((function(t){return"logout"===t.action}));if(b.debug("AdobeConcurrencyMonitorV2.handleError",e.status,s,u),!n)throw s;n(s,u)}}));case 410:return e.json().then((function(t){if(!t)return i.start();var r=(t.associatedAdvice||[]).find((function(t){return"remote-termination"===t.type}));if(r){var a=r.message,o=i.messages[a]||a,s=new Error(o),u=!!t.obligations.find((function(t){return"logout"===t.action}));if(b.debug("AdobeConcurrencyMonitorV2.handleError",e.status,s,u),!n)throw s;n(s,u)}}))}},t.prototype.getMetadata=function(){var t=this;return this.metadataKeys.reduce((function(e,n){return e[n]=t.metadata[n],e}),{})},t.prototype.onError=function(t,e){b.debug("AdobeConcurrencyMonitor.onError"),b.debug("error: "+t),b.debug("shouldLogout: "+e)},t}(),un=m((function(t,e){var n;t.exports=(n=M,function(t){var e=n,i=e.lib,r=i.WordArray,a=i.Hasher,o=e.algo,s=[],u=[];!function(){function e(e){for(var n=t.sqrt(e),i=2;i<=n;i++)if(!(e%i))return!1;return!0}function n(t){return 4294967296*(t-(0|t))|0}for(var i=2,r=0;r<64;)e(i)&&(r<8&&(s[r]=n(t.pow(i,.5))),u[r]=n(t.pow(i,1/3)),r++),i++}();var c=[],l=o.SHA256=a.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5],d=n[6],h=n[7],p=0;p<64;p++){if(p<16)c[p]=0|t[e+p];else{var f=c[p-15],v=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,y=c[p-2],g=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;c[p]=v+c[p-7]+g+c[p-16]}var m=i&r^i&a^r&a,b=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),P=h+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&d)+u[p]+c[p];h=d,d=l,l=s,s=o+P|0,o=a,a=r,r=i,i=P+(b+m)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=a._createHelper(l),e.HmacSHA256=a._createHmacHelper(l)}(Math),n.SHA256)})),cn=function(){function t(t,e,n){void 0===n&&(n={}),this.programmer=t,this.applicationId=e,this.metadata=n}return t.prototype.withSession=function(t){var e=t.authenticationType,n=t.authenticatedIdentity,i=t.authenticatedProvider,r=t.mediaItem;if(e!==Pt.mvpd)return this;var a=n,o=i&&i.id;return this.metadata[Ze]=a,this.metadata[$e]=r.network&&r.network.id,this.metadata[tn]=r.streamType===lt.live?Qe:Xe,this.metadata[en]="",this.metadata[nn]=!!t.authenticatedProvider&&t.authenticatedProvider.isHomeBasedAuth,this.subject=a,this.identityProvider=o,this},t.prototype.withLocationProvider=function(t){var e=t.getPublicIPAddress();return this.metadata[rn]=e?un("m!ck3ym0u$3"+e):null,this.metadata[an]=t.getRegion()?t.getRegion():null,this},t.prototype.withServiceUrl=function(t){return this.serviceUrl=t,this},t.prototype.withMessages=function(t){return this.messages=t,this},t.prototype.build=function(){if(!this.subject||!this.identityProvider)return null;var t=new sn(this.programmer,this.applicationId,this.identityProvider,this.subject,this.metadata);return this.serviceUrl&&(t.serviceUrl=this.serviceUrl),this.messages&&(t.messages=this.messages||{}),t},t}(),ln=function(){function t(t,e){this.partner=t,this.platform=e}return t.prototype.startSession=function(t,e,n,i,r,a){var o=["partner="+this.partner,"platform="+this.platform,"token="+encodeURIComponent(n),"tokenType="+i,"v=2.0.0","ttl=21600"];if(r){var s=D.stringify(U.parse(r));o.push("resource="+encodeURIComponent(s))}a&&Object.keys(a).forEach((function(t){o.push(t+"="+encodeURIComponent(a[t]))}));var u=/swid=*/g;o.some((function(t){return u.test(t)}))||o.push("swid="+encodeURIComponent(e));return I(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},credentials:"include",body:o.join("&")}).then((function(t){return t.json()})).then((function(t){if(!t.session)throw new Error(t.message||"An unexpected error occurred. ["+t.abbreviation+"]");return t})).catch((function(t){if(t.message)throw new Error(t.message);return t.json().then((function(t){throw new Error(t.message||"An unexpected error occurred. ["+t.abbreviation+"]")}))}))},t}(),dn=function(){function t(t){this.authButler=t}return t.prototype.initPlaybackSession=function(t,e,n){var i=t.source.url;t.source.startSessionUrl&&t.source.type===wt.shield&&(i=t.source.startSessionUrl);try{var r=window&&window.location.protocol;r&&"https:"===r&&(i=i.replace(/^http(s?):/,r))}catch(t){}var a=n.customData,o=a.token,s=a.tokenType,u=a.resource,c=void 0===u?t.mrss:u,l=e&&e.swid,d=this.authButler;if(!d)throw new Error("startSession support not configured");return d.startSession(i,l,o,s,c,e.dictionaryForStartSession()).then((function(e){var i=function(t,e){var n=t.playbackUrl,i=new He(n);return i.token=e,i}(e,o);return i.mediaItem=t,i.seekToTime=t.seekInSeconds,i.authenticationType=n.authenticationType,i.authenticatedProvider=n.authenticatedProvider,i.authenticatedIdentity=n.authenticatedIdentity,i}))},t}(),hn="ADOBEPASS",pn="JWT",fn=function(t){if(t instanceof Error)throw t;return t.json&&t.json().then((function(t){var e=t.message||"An unexpected error occurred. ["+t.exception+"]";throw"com.espn.watch.api.AccessDeniedException"===t.exception&&(e="This content is not available for your package or region."),new Error(e)}))},vn="https://web.archive.org/web/20201110234047/https://watch.auth.api.espn.com",yn=function(){function t(t){this.drmSupport=Fe.none,this.serviceUrl=vn,this.apiKey=t}return t.prototype.getAsset=function(t,e,n,i,r){var a=this.serviceUrl+"/video/auth/media/"+t+"/asset";return this.getAssetForUrl(a,e,n,i,r)},t.prototype.getAssetForUrl=function(t,e,n,i,r){var a=r||{},o={"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"};if(e)if(n===hn){if(a.adobeToken=e,i){var s=D.stringify(U.parse(i));a.adobeResource=s}}else n==pn?o.Authorization="Bearer "+a.token:a.token=e;a.drmSupport=this.drmSupport;var u={method:"POST",headers:o,credentials:"include",body:Object.keys(a).map((function(t){return t+"="+encodeURIComponent(a[t])})).join("&")},c=-1===t.indexOf("?")?"?":"&";return I(""+t+c+"apikey="+this.apiKey,u).then((function(t){if(!t.ok)throw t;return t.json()})).then((function(t){if(!t.stream){var e=t.message||"An unexpected error occurred.";throw new Error(e)}return t})).catch(fn)},t.defaultServiceUrl=vn,t}(),gn=function(){function t(t){this.shieldAPI=t}return t.prototype.initPlaybackSession=function(t,e,n){var i=n.customData.token,r=n.customData,a=void 0===r?{}:r,o=a.tokenType,s=a.resource,u=void 0===s?t.mrss:s,c=e.dictionaryForStartSession(),l=this.shieldAPI;if(!l)throw new Error("shield support not configured");var d=t.source.url;return l.getAssetForUrl(d,i,o,u,c).then((function(e){var i=e.stream,r=e.captions,a=e.streamInfo,o=e.gatekeeperToken,s=new He(i);return s.mediaItem=t,s.seekToTime=t.seekInSeconds,s.authenticationType=n.authenticationType,s.authenticatedProvider=n.authenticatedProvider,s.authenticatedIdentity=n.authenticatedIdentity,s.token=o,s.playbackConfig=function(t){if(!t)return null;var e=t.streamType,n=t.licenseAcquisitionUrl,i=t.certificateUrl;switch(e){case"DASH_PLAYREADY":return new ze("application/dash+xml",xe.playReady,n);case"DASH_WIDEVINE":return new ze("application/dash+xml",xe.widevine,n);case"HLS_FAIRPLAY":return new ze("application/x-mpegURL",xe.fairPlay,i);case"HLS":return new ze("application/x-mpegURL",xe.none);default:return null}}(a),s.textTracks=function(t){if(!t)return[];var e={source:t};return t.endsWith(".vtt")&&(e.contentType="text/vtt"),[e]}(r),s}))},t}(),mn=function(){function t(){this.isAuthenticated=!0,this.authenticatedIdentity=null,this.authenticatedProvider=null,this.preauthorizedResources=this.isAuthenticated?["espn_free"]:[]}return t.prototype.checkAuthentication=function(){return w.resolve(!0)},t.prototype.authenticate=function(){return w.resolve(!0)},t.prototype.deauthenticate=function(){return w.resolve(!0)},t.prototype.checkAuthorization=function(t){var e;if(-1===t.authenticationTypes.indexOf(Pt.open)||!this.isAuthenticated)return w.resolve(new Ue(!1,null));var n=((e={})[De.CustomDataKey.token]="IA==",e[De.CustomDataKey.tokenType]="DEVICE",e),i=new De(Pt.open,this.authenticatedProvider,this.authenticatedIdentity,n),r=new Ue(!0,i);return w.resolve(r)},t}(),bn=function(){function t(n,i,r){e(this,t),this.id=n,this.profile=i,this.preferences=r}return i(t,[{key:"toString",value:function(){return"<Fan id:".concat(this.id,">")}},{key:"favoriteSports",get:function(){return this.preferences.filter((function(t){return t.metadata.sportId&&!t.metadata.teamId})).map((function(t){return t.metadata}))}},{key:"favoriteTeams",get:function(){return this.preferences.filter((function(t){return t.metadata.teamInfo})).map((function(t){return t.metadata}))}},{key:"fantasyPreferences",get:function(){return this.preferences.filter((function(t){return 9===t.type.id}))}},{key:"isLeagueManager",get:function(){return this.preferences.some((function(t){var e=t.metadata&&t.metadata.entry&&t.metadata.entry;return e&&!0===e.isLeagueManager}))}}],[{key:"fromJson",value:function(e){if(!e)return null;var n=Pn.fromJson(e.profile),i=e.preferences.map((function(t){return In.fromJson(t)}));return new t(e.id,n,i)}}]),t}(),Pn=function(){function t(n,i,r){e(this,t),this.isInsider=n,this.hasNotificationPreferences=i,this.settings=r}return i(t,[{key:"toString",value:function(){return"<FanProfile isInsider:".concat(this.isInsider,", hasNotificationPreferences:").concat(this.hasNotificationPreferences,">")}}],[{key:"fromJson",value:function(e){if(!e)return null;var n=wn.fromJson(e.settings);return new t(e.isInsider,e.hasNotificationPreferences,n)}}]),t}(),wn=function(){function t(n){e(this,t),this.videoAutoStart=n}return i(t,null,[{key:"fromJson",value:function(e){return e?new t(An.fromJson(e.videoAutoStart)):null}}]),t}(),An=function(){function t(n){e(this,t),this.value=n}return i(t,null,[{key:"fromJson",value:function(e){return e?new t(e.value):null}}]),t}(),In=function(){function t(n,i,r){e(this,t),this.id=n,this.metadata=i,this.type=r}return i(t,null,[{key:"fromJson",value:function(e){if(!e)return null;var n=kn.fromJson(e.metaData||e.metadata),i=Sn.fromJson(e.type);return new t(e.id,n,i)}}]),t}(),Sn=function(){function t(n,i,r){e(this,t),this.id=n,this.name=i,this.code=r}return i(t,null,[{key:"fromJson",value:function(e){return e?new t(e.id,e.name,e.code):null}}]),t}(),kn=function(){function t(n,i,r,a){e(this,t),this.sportId=n,this.teamId=i,this.teamInfo=r,this.entry=a}return i(t,[{key:"uid",get:function(){if(this.teamInfo)return this.teamInfo.uid;var t=null;return this.sportId&&(t="s:".concat(this.sportId),this.teamId&&(t="".concat(t,"~t:").concat(this.teamId))),t}}],[{key:"fromJson",value:function(e){if(!e)return null;var n=null;if(e.teamInfo)n=new En(e.teamInfo.uid,e.teamInfo.name,e.teamInfo.fullName,e.teamInfo.logoUrl,e.teamInfo.darkLogoUrl,e.teamInfo.scoreboardLogoUrl,e.teamInfo.scoreboardDarkLogoUrl);else if(e.team){var i=e.team,r=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("default")})).map((function(t){return t.href}))[0],a=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("dark")&&-1===t.rel.indexOf("scoreboard")})).map((function(t){return t.href}))[0],o=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("scoreboard")&&-1===t.rel.indexOf("dark")})).map((function(t){return t.href}))[0],s=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("scoreboard")&&-1!==t.rel.indexOf("dark")})).map((function(t){return t.href}))[0];n=new En(i.uid,i.name,i.text,r,a||r,o||r,s||a||r)}var u=Tn.fromJson(e.entry);return new t(e.sportId,e.teamId,n,u)}}]),t}(),Tn=function(){function t(n){e(this,t),this.groups=n}return i(t,[{key:"isLeagueManager",get:function(){return this.groups.some((function(t){return!0===t.groupManager}))}}],[{key:"fromJson",value:function(e){return e?new t((e.groups||[]).map((function(t){return _n.fromJson(t)}))):null}}]),t}(),_n=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e(this,t),this.groupManager=n}return i(t,null,[{key:"fromJson",value:function(e){return e?new t(e.groupManager):null}}]),t}(),En=function t(n,i,r,a,o,s,u){e(this,t),this.uid=n,this.name=i,this.fullName=r,this.logoUrl=a,this.darkLogoUrl=o,this.scoreboardLogoUrl=s,this.scoreboardDarkLogoUrl=u},Cn="https://web.archive.org/web/20201110234047/https://fan.api.espn.com/apis/v2/fans",On=function(){function t(){e(this,t),this.serviceUrl=Cn}return i(t,[{key:"getFan",value:function(t){var e=nt.platform,n=this.serviceUrl||Cn;return I("".concat(n,"/").concat(encodeURIComponent(t),"?prefType=sports&prefType=teams&prefType=fantasy&coreData=logos"),{method:"GET",headers:{"X-Personalization-Source":"espn-watchsdk-js-".concat(e)}}).then((function(t){return t.json()})).then((function(t){return bn.fromJson(t)}))}}]),t}(),Mn=function(t){function n(){return e(this,n),d(this,c(n).apply(this,arguments))}return u(n,t),i(n,null,[{key:"getFan",value:function(t){var e=Q.shared.getConfiguration("fanApi",{serviceUrl:Cn}).serviceUrl,n=new On;return n.serviceUrl=e,n.getFan(t)}}]),n}(On);localStorage.getItem("FanManager.anonSwid")||I("https://web.archive.org/web/20201110234047/https://log.espn.com/log?srvc=sz&silent&returnBody=SWID&responseType=JSON").then((function(t){return t.json()})).then((function(t){var e=t.SWID;e&&localStorage.setItem("FanManager.anonSwid",e)}));var Dn,Un=function(){function t(){e(this,t)}return i(t,null,[{key:"swid",get:function(){return localStorage.getItem("FanManager.anonSwid")}}]),t}(),Nn=function(){function t(){e(this,t)}return i(t,null,[{key:"update",value:function(){var e=localStorage.getItem("FanManager.swid");return e?Mn.getFan(e).then((function(t){return localStorage.setItem("FanManager.fan",JSON.stringify(t)),t})):w.resolve(t.fan)}},{key:"swid",get:function(){return localStorage.getItem("FanManager.swid")||Un.swid},set:function(t){if(!t)return localStorage.removeItem("FanManager.swid"),void localStorage.removeItem("FanManager.fan");localStorage.setItem("FanManager.swid",t)}},{key:"fan",get:function(){var t=localStorage.getItem("FanManager.fan");try{return bn.fromJson(JSON.parse(t))}catch(t){return null}}}]),t}(),jn=function(){function t(){e(this,t)}return i(t,[{key:"getCountryCode",value:function(){}}]),t}(),Rn=function(t){function n(){return e(this,n),d(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"getCountryCode",value:function(){return"us"}}]),n}(jn),Ln=function(t){function n(t){return e(this,n),d(this,c(n).call(this,t||new Rn))}return u(n,t),i(n,[{key:"configuration",get:function(){var t=Q.shared.getConfiguration("provider",s({applicationKeyMap:{}},ve.defaultConfiguration));return b.debug("ESPNAffiliateAPI.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}},{key:"applicationId",get:function(){var t=function(t){return"US"===t||"GU"===t||"PR"===t||"VI"===t}(this.locationProvider.getCountryCode().toUpperCase())&&"web"===nt.platform?"".concat(nt.partner,"_").concat(nt.platform):"".concat(nt.platform),e=this.configuration.applicationKeyMap||{};return e[t]&&(t=e[t]),b.debug("ESPNAffiliateAPI.getApplicationId ".concat(t)),t},set:function(t){v(c(n.prototype),"applicationId",t,this,!0)}}]),n}(ve),xn=function(){function t(){e(this,t)}return i(t,null,[{key:"getBuilder",value:function(){var t,e=Q.shared.getConfiguration("adobeCM",Z);if(!1===e.enabled)return null;var n=nt.platform,i=e.applications&&e.applications[n],a=e.applicationId||i&&i.applicationId,o=(r(t={},j,a),r(t,R,n),r(t,L,""),r(t,x,"false"),r(t,z,"ESPN"),t);return new cn("ESPN",a,o).withServiceUrl(e.serviceUrl).withMessages(e.messages||{})}}]),t}(),zn="watchsdk.isp_authenticator.state",Hn=function(t,e){e.setItem(zn,JSON.stringify(t))},Bn=function(t){var e="true"===t.getItem("ISPAuthenticator.isAuthenticated"),n=t.getItem("ISPAuthenticator.authenticatedIdentity"),i=null;try{i=JSON.parse(t.getItem("ISPAuthenticator.authenticatedProvider"))}catch(t){}var r={isAuthenticated:e,authenticatedIdentity:n,authenticatedProvider:i};return t.removeItem("ISPAuthenticator.isAuthenticated"),t.removeItem("ISPAuthenticator.authenticatedIdentity"),t.removeItem("ISPAuthenticator.authenticatedProvider"),r},Vn=new function(t){this.userDataServiceUrl=t}("https://web.archive.org/web/20201110234047/https://broadband.espn.com/espn3/auth/watchespn/user"),Fn=function(){function t(t,e,n){switch(this.partner=t,this.platform=e,this.providerDataSource=null,this.configuration=Vn,n){case Oe.localStorage:this.storage=localStorage;break;case Oe.sessionStorage:this.storage=sessionStorage;break;default:this.storage=localStorage}this._state={};try{var i=this.storage.getItem(zn);i||(i=Bn(this.storage),Hn(this._state,this.storage));var r=JSON.parse(i.toString());r.authenticatedProvider&&(r.authenticatedProvider=Me.fromObject(r.authenticatedProvider)),this._state=r}catch(t){}}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this._configuration},set:function(t){this._configuration=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===this._state.isAuthenticated||!0===this._state.isAuthenticated},set:function(t){this._state.isAuthenticated=t,Hn(this._state,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return this._state.authenticatedIdentity},set:function(t){if(!t)return delete this._state.authenticatedIdentity,void Hn(this._state,this.storage);this._state.authenticatedIdentity=t,Hn(this._state,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){return this._state.authenticatedProvider},set:function(t){if(!t)return delete this._state.authenticatedProvider,void Hn(this._state,this.storage);this._state.authenticatedProvider=t,Hn(this._state,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return this.isAuthenticated?["espn3"]:[]},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this,e=this.configuration.userDataServiceUrl;return I(e+"?partner="+this.partner+"&platform="+this.platform).then((function(t){return t.json()})).then((function(n){var i=n.user&&n.user.authentication&&n.user.authentication.isp;if(i){t.isAuthenticated=!0;var r=i.name;return t.providerDataSource?t.providerDataSource.getProvider(r,se.isp).then((function(n){var i=n.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new Me(r,n.name,i,e),!0})).catch((function(){return t.authenticatedProvider=new Me(r,r,null,e),!0})):(t.authenticatedProvider=new Me(r,r,null,e),w.resolve(!0))}return!1}))},t.prototype.authenticate=function(){return w.resolve(!0)},t.prototype.deauthenticate=function(){return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,w.resolve(!0)},t.prototype.checkAuthorization=function(t){var e;if(-1===t.authenticationTypes.indexOf(Pt.isp)||!this.isAuthenticated)return w.resolve(new Ue(!1,null));var n=((e={})[De.CustomDataKey.token]="IA==",e[De.CustomDataKey.tokenType]="DEVICE",e),i=new De(Pt.isp,this.authenticatedProvider,this.authenticatedIdentity,n),r=new Ue(!0,i);return w.resolve(r)},t.defaultConfiguration=Vn,t}(),Kn=function(t){function n(){return e(this,n),d(this,c(n).apply(this,arguments))}return u(n,t),i(n,[{key:"configuration",get:function(){var t=Q.shared.getConfiguration("authorization",Fn.defaultConfiguration);return b.debug("ISPAuthenticator.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){v(c(n.prototype),"configuration",t,this,!0)}}]),n}(Fn),Jn=function(){function t(){e(this,t),this.factories=[],this.concurrencyMonitorBuilder=null}return i(t,[{key:"initPlaybackSession",value:function(t,e,n){var i=this,r=this.factories[wt.shield]?this.factories[wt.shield].shieldAPI.drmSupport:Fe.none;return this.getPlaybackSession_(t,e,n,r).then((function(t){var e=i.concurrencyMonitorBuilder&&i.concurrencyMonitorBuilder.withSession(t).build();return e?e.createSession().then((function(e){return t.concurrencyMonitorSessionId=e,t})):t}))}},{key:"getPlaybackSession_",value:function(t,e,n,i){var r=t.source.type,a=this.factories[r];if(!a)throw new Error("Unsupported MediaItem.source.type");return a.drmSupport&&(a.drmSupport=i),a.initPlaybackSession(t,e,n)}}]),t}(),Gn=function(t){function n(t,i){var r;e(this,n),(r=d(this,c(n).call(this))).partner=nt.partner,r.platform=nt.platform,r.apiKey=nt.apiKey,r.deviceId=nt.deviceId;var a=new Ln(t),o={deviceId:r.deviceId,deviceType:nt.platform},s=new Ee(r.partner,r.platform,"ESPN",o);s.providerDataSource=a;var u="web"===r.platform?Oe.sessionStorage:Oe.localStorage,l=new Kn(r.partner,r.platform,u);l.providerDataSource=a;var h=new mn;r.authenticators[Pt.mvpd]=s,r.authenticators[Pt.isp]=l,r.authenticators[Pt.open]=h,r.authorizers[Pt.mvpd]=s,r.authorizers[Pt.isp]=l,r.authorizers[Pt.open]=h;var p=new Jn;p.concurrencyMonitorBuilder=xn.getBuilder();var f={apiKey:r.apiKey,serviceUrl:yn.defaultServiceUrl},v=Q.shared.getConfiguration("shield",f),y=new yn(v.apiKey),g=function(){var t={apiKey:r.apiKey,serviceUrl:yn.defaultServiceUrl},e=Q.shared.getConfiguration("shield",t);y.apiKey=e.apiKey,y.serviceUrl=e.serviceUrl};g();var m=new gn(y);p.factories[wt.shield]=m;var b=new ln(r.partner,r.platform),P=new dn(b);p.factories[wt.startSession]=P;var w=new Je;return p.factories[wt.none]=w,r.playbackSessionFactories[Pt.mvpd]=p,r.playbackSessionFactories[Pt.isp]=p,r.playbackSessionFactories[Pt.open]=p,r.playbackSessionFactories[Pt.none]=p,r.drmSupport=i,Q.shared.on(Y.updated,(function(){g(),p.concurrencyMonitorBuilder=xn.getBuilder()})),r}return u(n,t),i(n,[{key:"initPlaybackSession",value:function(t,e){var i=Nn.swid||Un.swid;(arguments.length<=3?void 0:arguments[3])&&Object.keys(Fe).map((function(t){return Fe[t]})).indexOf(arguments.length<=3?void 0:arguments[3])&&(this.drmSupport=arguments.length<=3?void 0:arguments[3]);var r=new Re;return r.swid=i,r.platform=this.platform,r.merge(e),p(c(n.prototype),"initPlaybackSession",this).call(this,t,r)}},{key:"drmSupport",set:function(t){var e=this;Object.keys(this.playbackSessionFactories).map((function(t){return e.playbackSessionFactories[t]})).forEach((function(e){"drmSupport"in e&&(e.drmSupport=t)}))}},{key:"advertisingId",get:function(){var t=localStorage.getItem("AuthenticationManager.advertisingId");return t||(t=Yt&&Yt.device.advertisingId,this.advertisingId=t),t},set:function(t){localStorage.setItem("AuthenticationManager.advertisingId",t)}}]),n}(Le);!function(t){t.willStartPlaying="atv.player.willStartPlaying",t.didStopPlaying="atv.player.didStopPlaying",t.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",t.playerStateChanged="atv.player.playerStateChanged",t.playerTimeDidChange="atv.player.playerTimeDidChange"}(Dn||(Dn={}));var qn,Wn,Yn,Qn=Dn;!function(t){t.priv="PRIV",t.txxx="TXXX"}(qn||(qn={})),function(t){t.heartbeat="com.espn.authnet.heartbeat",t.transition="com.espn.authnet.transition",t.nielsenWatermark="www.nielsen.com"}(Wn||(Wn={})),function(t){t.program="PROGRAM",t.commercial="COMMERCIAL",t.slate="SLATE"}(Yn||(Yn={}));var Xn,Zn=function(){function t(t,e){this.type=t,this.id=e}return t.prototype.isContent=function(){return this.type!==Yn.slate&&this.type!==Yn.commercial},t}(),$n=function(t,e,n){this.tag=t,this.owner=e,this.dataValue=n};!function(t){t.start="start",t.playing="playing",t.pause="pause",t.seeking="seeking",t.stalled="stalled",t.stop="stop",t.timedMetadata="timedMetadata",t.currentTime="currentTime"}(Xn||(Xn={}));var ti,ei=Xn,ni=function(){function t(t,e){this.certificateUrl=e,this.requests=[],this.bindSecureKeyDelivery(t||atv.secureKeyDelivery||{})}return t.prototype.bindSecureKeyDelivery=function(t){t.fetchCertificate=this.fetchCertificate.bind(this),t.fetchAssetID=this.fetchAssetID.bind(this),t.fetchKeys=this.fetchKeys.bind(this),t.cancelAllRequests=this.cancelAllRequests.bind(this)},t.prototype.fetchCertificate=function(t,e){var n=this;b.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",t);var i=this.certificateUrl;if(i){var r=new XMLHttpRequest;r.open("GET",i),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var t=r.responseDataAsBase64;b.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",t),e.success(t)}else e.failure(r.status);n.requests.splice(n.requests.indexOf(r),1)}},this.requests.push(r),r.send(null)}else e.failure("invalid certificate url")},t.prototype.fetchAssetID=function(t,e){var n=/[?&]c=([^&]+)&*/.exec(t);if(!n||n.length<2)e.failure("Error parsing assetId "+t);else{var i=n[1];b.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",t,i),e.success(i,!1)}},t.prototype.fetchKeys=function(t,e,n){var i=this,r=t.replace("skd://","https://"),a=JSON.stringify({spc:e});b.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",r);var o=new XMLHttpRequest;o.open("POST",r),o.setRequestHeader("Content-Type","application/json"),o.onreadystatechange=function(){if(4===o.readyState){if(200===o.status)try{var t=JSON.parse(o.responseText).ckc;n.success(t)}catch(t){n.failure("invalid JSON")}else n.failure(o.status);i.requests.splice(i.requests.indexOf(o),1)}},this.requests.push(o),o.send(a)},t.prototype.cancelAllRequests=function(){b.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.requests.forEach((function(t){t.abort&&t.abort()})),this.requests=[]},t}(),ii=function(t){function e(e,n,i){var r=t.call(this)||this;if(!n)throw new Error("bus must be supplied");return r.bus=n,r.secureKeyDelivery=new ni(i),r.bindEventListeners(),r}return k(e,t),e.prototype.bindEventListeners=function(){var t=this;this.bus.on(Qn.willStartPlaying,(function(){atv.player.observeTimedMetadataKeys(),t.emit(ei.start)})),this.bus.on(Qn.playerStateChanged,(function(e,n){switch(b.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",e,n),e){case atv.player.states.FastForwarding:t.emit(ei.seeking,n);break;case atv.player.states.Loading:t.emit(ei.stalled,n);break;case atv.player.states.Paused:t.emit(ei.pause,n);break;case atv.player.states.Playing:t.emit(ei.playing,n);break;case atv.player.states.Rewinding:t.emit(ei.seeking,n)}})),this.bus.on(Qn.onTimedMetadataChanged,(function(e){var n=e.key,i=e.extraAttributes.info,r=e.dataValue,a=r&&U.stringify(D.parse(r))||"";a.replace("\0",""),t.emit(ei.timedMetadata,new $n(n,i,a))})),this.bus.on(Qn.didStopPlaying,(function(){t.emit(ei.stop),t.cleanup()})),this.bus.on(Qn.playerTimeDidChange,(function(e){t.emit(ei.currentTime,e)}))},Object.defineProperty(e.prototype,"playbackConfig",{set:function(t){if(t){var e=t.licenseUrl;b.debug("AtvlPlayerAdaptor setPlaybackConfig",e,t.protectionSystem),e&&(this.secureKeyDelivery.certificateUrl=e)}},enumerable:!0,configurable:!0}),e.prototype.stop=function(t){var e=t.message;atv.player.stopWithReason("Video Playback Has Stopped",e)},e.prototype.cleanup=function(){this.bus.off(Qn.willStartPlaying),this.bus.off(Qn.onTimedMetadataChanged),this.bus.off(Qn.didStopPlaying)},e}(J),ri=function(t){function e(e,n){var i=t.call(this)||this;return e?(i.nativePlayer=e,i.bus=e.getEventBus(),i.constants=n,i.bindEventListeners(),i):i}return k(e,t),e.prototype.bindEventListeners=function(){var t=this;this.bus.subscribe(this.constants.Events.Player.ID3,(function(e){void 0===e&&(e={});var n=e.sample?e.sample.data:e,i=n instanceof Uint8Array?String.fromCharCode.apply(String,O(n)):n,r=["PRIV","TXXX"].find((function(t){return i.includes(t)}))||null,a=Object.keys(Wn).map((function(t){return Wn[t]})).find((function(t){return i.includes(t)}))||null,o=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,s=new $n(r,a,o);t.emit(ei.timedMetadata,s)})),this.alreadyStarted=!1,this.bus.subscribe(this.constants.Events.Player.PLAYING,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),t.alreadyStarted?t.emit(ei.playing):(t.emit(ei.start),t.emit(ei.playing),t.alreadyStarted=!0)})),this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,(function(e){var n=e/1e3;t.emit(ei.currentTime,n)})),this.bus.subscribe(this.constants.Events.Player.PAUSE,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.PAUSE"),t.emit(ei.pause)})),this.bus.subscribe(this.constants.Events.Player.SEEKING,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING"),t.emit(ei.seeking)})),this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),t.emit(ei.stalled)})),this.bus.subscribe(this.constants.Events.Player.BUFFERING_END,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_END"),t.emit(ei.playing)})),this.bus.subscribe(this.constants.Events.Player.COMPLETE,(function(){b.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),t.emit(ei.stop),t.cleanup()}))},e.prototype.stop=function(t){t&&b.warn("BAMTizenPlayerAdaptor.stop",t.message),this.nativePlayer.stop(),this.cleanup()},e.prototype.cleanup=function(){this.alreadyStarted=!1,this.bus.unsubscribe(this.constants.Events.Player.ID3,this),this.bus.unsubscribe(this.constants.Events.Player.PLAYING,this),this.bus.unsubscribe(this.constants.Events.Player.TIME_UPDATE,this),this.bus.unsubscribe(this.constants.Events.Player.PAUSE,this),this.bus.unsubscribe(this.constants.Events.Player.SEEKING,this),this.bus.unsubscribe(this.constants.Events.Player.BUFFERING_START,this),this.bus.unsubscribe(this.constants.Events.Player.COMPLETE,this)},e}(J),ai=function(t){function e(e){var n=t.call(this)||this;return e?(n.nativePlayer=e,n.bindEventListeners(),n):n}return k(e,t),e.prototype.bindEventListeners=function(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)},e.prototype.loadCompleteHandler=function(t){b.debug("ChromecastPlayerAdaptor: PLAYER_LOAD_COMPLETE",t),this.emit(ei.start)},e.prototype.id3Handler=function(t){if(b.debug("ChromecastPlayerAdaptor._id3Handler",t),t.detail&&(t.segmentData=t.detail),t.segmentData){var e=String.fromCharCode.apply(String,O(t.segmentData));b.trace("ChromecastPlayerAdaptor._id3Handler",e);var n=["PRIV","TXXX"].find((function(t){return e.includes(t)}))||null,i=Object.keys(Wn).map((function(t){return Wn[t]})).find((function(t){return e.includes(t)}))||null,r=i?e.substring(e.lastIndexOf(i)+i.length).trim().replace(/\0/g,""):null,a=new $n(n,i,r);b.trace("ChromecastPlayerAdaptor._id3Handler","tag:",n,"owner:",i,"dataValue:",r),this.emit(ei.timedMetadata,a)}},e.prototype.timeUpdateHandler=function(t){var e=t.currentMediaTime;this.emit(ei.currentTime,e)},e.prototype.playingHandler=function(t){var e=t.currentMediaTime;this.emit(ei.playing,e)},e.prototype.pauseHandler=function(t){var e=t.currentMediaTime;this.emit(ei.pause,e)},e.prototype.mediaFinishedHandler=function(t){b.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",t),this.emit(ei.stop),this.cleanup()},e.prototype.stop=function(t){t&&b.warn("ChromecastPlayerAdaptor.stop",t.message)},e.prototype.cleanup=function(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))},e}(J),oi=function(t){function e(e){var n=t.call(this)||this;return n.nativePlayer=e,n.bindEventListeners(),n}return k(e,t),e.prototype.bindEventListeners=function(){var t=this;this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeek=this.onSeek.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeek),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeUpdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.textTracks.onaddtrack=function(e){var n=e.track;n&&"metadata"===n.kind&&n.addEventListener("cuechange",(function(e){var n=e.target;if(n&&"metadata"===n.kind){for(var i=[],r=0;r<n.activeCues.length;r++){var a=n.activeCues[r];i.push(a.value)}i.map((function(e){var n=e.key,i=e.info,r=e.data;r instanceof ArrayBuffer&&(r=String.fromCharCode.apply(null,new Uint8Array(r)));var a=new $n(n,i,r);b.trace("HTML5PlayerAdaptor timedMetadata",a),t.emit(ei.timedMetadata,a)}))}}))}):b.error("Native Player wasn't passed to HTML5PlayerAdaptor")},e.prototype.onPlay=function(t){this.emit(ei.start,t.timeStamp)},e.prototype.onPause=function(){this.emit(ei.pause)},e.prototype.onSeek=function(){this.emit(ei.seeking)},e.prototype.onError=function(){this.emit(ei.stop),this.cleanup()},e.prototype.onCurrentTime=function(t){this.emit(ei.currentTime,t.timeStamp)},e.prototype.onStalled=function(t){this.emit(ei.stalled,t.timeStamp)},e.prototype.stop=function(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(ei.stop),this.cleanup()},e.prototype.cleanup=function(){this.nativePlayer.removeEventListener("play",this.onPlay),this.nativePlayer.removeEventListener("pause",this.onPause),this.nativePlayer.removeEventListener("error",this.onError),this.nativePlayer.removeEventListener("seeking",this.onSeek),this.nativePlayer.removeEventListener("stalled",this.onStalled),this.nativePlayer.removeEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.removeEventListener("ended",this.stop)},e}(J);!function(t){t.opened="opened",t.playing="playing",t.ended="ended",t.timedMetadata="timedMetadata",t.error="error",t.timeUpdate="timeUpdate",t.stalled="stalled",t.paused="paused",t.seeking="seeking"}(ti||(ti={}));var si,ui=ti,ci=function(t){function e(e,n){var i=t.call(this)||this;if(!e)throw new Error("nativePlayer must be supplied");return i.nativePlayer=e,i.bus=n,i.bindEventListeners(),i}return k(e,t),e.prototype.bindEventListeners=function(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on(ui.opened,this.onOpened),this.bus.on(ui.playing,this.onPlaying),this.bus.on(ui.paused,this.onPaused),this.bus.on(ui.timedMetadata,this.onTimedMetadata),this.bus.on(ui.ended,this.onEnded),this.bus.on(ui.error,this.onError),this.bus.on(ui.timeUpdate,this.onTimeUpdate),this.bus.on(ui.stalled,this.onStalled),this.bus.on(ui.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)},e.prototype.onSeeking=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onSeeking",t),this.emit(ei.seeking,t)},e.prototype.onStalled=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onStalled",t),this.emit(ei.stalled,t)},e.prototype.onTimeUpdate=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onTimeUpdate",t),this.emit(ei.currentTime,t)},e.prototype.onError=function(t){b.debug("TrilithiumPlayerAdaptor.onError",t),this.emit(ei.stop),this.cleanup()},e.prototype.onEnded=function(){this.emit(ei.stop),this.cleanup()},e.prototype.onTimedMetadata=function(t,e,n){var i=e,r=n.toString(),a=U.stringify(D.parse(n.toString("base64"))),o=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;b.debug("TrilithiumPlayerAdaptor.onTimedMetadata "+i+" "+r+" "+o);var s=new $n(i,r,o);this.emit(ei.timedMetadata,s)},e.prototype.onOpened=function(t){t&&(b.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(ei.start))},e.prototype.onPlaying=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onPlaying",t),this.emit(ei.playing,t)},e.prototype.onPaused=function(){var t=this.nativePlayer.currentTime;b.debug("TrilithiumPlayerAdaptor.onPaused",t),this.emit(ei.pause,t)},e.prototype.stop=function(t){t&&b.warn("TrilithiumPlayerAdaptor.stop",t.message)},e.prototype.cleanup=function(){this.bus&&(this.bus.off(ui.opened),this.bus.off(ui.playing),this.bus.off(ui.timedMetadata),this.bus.off(ui.ended),this.bus.off(ui.error),this.bus.off(ui.timeUpdate),this.bus.off(ui.stalled))},e}(J),li=function(){function t(n,i){e(this,t),this.mediaItem=n,this.mediaItemDataSource=i}return i(t,[{key:"start",value:function(){var t=this;this.mediaItem.isLinear&&this.mediaItem.isLive&&(this._intervalId=setInterval((function(){t._checkProgramChange()}),6e4))}},{key:"stop",value:function(){this._intervalId&&clearInterval(this._intervalId)}},{key:"_checkProgramChange",value:function(){var t=this;if(this.mediaItem&&this.mediaItemDataSource){var e=this.mediaItem.network&&this.mediaItem.network.id;if(e){var n=Et.identifierStringForNetwork(e);this.mediaItemDataSource.getMediaItems([n]).then((function(e){var n=e[0];n&&(t.mediaItem.id!==n.id&&t.mediaItem.references.simulcastAiringId!==n.references.simulcastAiringId&&(t.mediaItem=n,t.onProgramChange(n)))}))}}}},{key:"onProgramChange",value:function(t){}}]),t}(),di=function(){function t(){e(this,t)}return i(t,null,[{key:"fromObject",value:function(t){var e=t;return e.mediaItem=Tt.fromObject(t.mediaItem),e}}]),t}(),hi=function(t){function n(t,i,r,a){var o;e(this,n);var s=nt.apiKey;(o=d(this,c(n).call(this,t,i))).nielsenTrackingManager=a;var u=new yn,l=function(){var t={apiKey:s,serviceUrl:yn.defaultServiceUrl},e=Q.shared.getConfiguration("shield",t);u.apiKey=e.apiKey,u.serviceUrl=e.serviceUrl};return l(),Q.shared.on(Y.updated,l),o.shield=u,o}return u(n,t),n}(function(){function t(n,i){var a=this;e(this,t),r(this,"shield",void 0),r(this,"nielsenTrackingManager",void 0),this.session=di.fromObject(n)||n,this.playerAdaptor=i,this.initConcurrencyMonitor(),this.initProgramChangeMonitor(),this.playerAdaptor.on(ei.start,(function(){b.debug("PlaybackManager.start"),a.programChangeMonitor.start()})),this.playerAdaptor.on(ei.stop,(function(){b.debug("PlaybackManager.stop"),a.cleanup()}))}return i(t,[{key:"initConcurrencyMonitor",value:function(){var t,e=this,n=this.session;n.concurrencyMonitorSessionId&&(t=xn.getBuilder().withSession(n).build())&&t.startWithSession(n.concurrencyMonitorSessionId),t&&(t.onError=function(t,n){e.playerAdaptor.stop(t),e.onStop(t),n&&e.onDeauthenticate(Pt.mvpd)},this.adobeConcurrencyMonitor=t)}},{key:"initProgramChangeMonitor",value:function(){var t=this,e=new Ft,n=new li(this.session.mediaItem,e);n.onProgramChange=function(e){var n=t.session.token,i=e.mrss;if(n){var r=t.shield;r?r.getAsset(e.id,n,"GATEKEEPER",i,drmSupport,{}).then((function(n){n&&(t.session.mediaItem=e,t.session.token=n.gatekeeperToken,t.nielsenTrackingManager&&(t.nielsenTrackingManager.mediaItem=e),t.onUpdatedMediaItem(e))})).catch((function(e){t.playerAdaptor.stop(e),t.onStop(e)})):b.warn("shield support not configured")}else b.warn("token missing. skipping program change re-auth.")},this.programChangeMonitor=n}},{key:"cleanup",value:function(){b.debug("PlaybackManager.cleanup"),this.playerAdaptor.off(ei.start),this.playerAdaptor.off(ei.stop),this.adobeConcurrencyMonitor&&this.adobeConcurrencyMonitor.stop(),this.programChangeMonitor&&this.programChangeMonitor.stop(),this.nielsenTrackingManager&&this.nielsenTrackingManager.stop()}},{key:"onDeauthenticate",value:function(t){}},{key:"onUpdatedMediaItem",value:function(t){}},{key:"onStop",value:function(t){}}]),t}());!function(t){t[t.all=0]="all",t[t.linearPlayback=1]="linearPlayback"}(si||(si={}));var pi,fi=si;!function(t){t.linear="linear",t.event="event"}(pi||(pi={}));var vi,yi=pi;!function(t){t.stitchedPreroll="stitchedPreroll"}(vi||(vi={}));var gi,mi=vi;!function(t){t.live="live",t.onDemand="onDemand"}(gi||(gi={}));var bi,Pi=gi;!function(t){t.nielsen="nielsen",t.comscore="comscore",t.conviva="conviva",t.heartbeats="heartbeats"}(bi||(bi={}));var wi,Ai=bi;!function(t){t.shortform="shortform",t.longform="longform"}(wi||(wi={}));var Ii,Si=wi;!function(t){t.audio="audio",t.video="video"}(Ii||(Ii={}));var ki,Ti=Ii;!function(t){t.pluto="pluto",t.graphQL="graphQL",t.cfa="cfa"}(ki||(ki={}));var _i,Ei=ki;!function(t){t.open="OPEN",t.direct="DIRECT",t.mvpd="MVPD",t.isp="ISP",t.none="NONE"}(_i||(_i={}));var Ci,Oi=_i;!function(t){t.none="none",t.startSession="startSession",t.bam="bam",t.shield="shield",t.entitlement="entitlement"}(Ci||(Ci={}));var Mi=Ci,Di=function(){function t(t,e,n,i,r,a,o){this.url=t,this.type=e,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=o,this.variant=null}return t.fromObject=function(e){if(!e)return null;var n=e.url,i=e.type,r=e.hasEspnId3Heartbeats,a=e.hasNielsenWatermarks,o=e.hasPassThroughAds,s=e.commercialReplacement,u=e.startSessionUrl;return new t(n,Mi[i],r,a,o,s,u)},t}(),Ui=function(){function t(t,e,n,i){this.id=t,this.type=e,this.name=n,this.resource=i}return t.fromObject=function(e){if(!e)return null;var n=yi[e.type];return new t(e.id,n,e.name,e.resource)},t}(),Ni=function(){function t(t){this.url=t}return t.fromObject=function(e){return e&&e.url?new t(e.url):null},t}(),ji=function(){function t(t){this.name=t}return Object.defineProperty(t.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!0,configurable:!0}),t.fromObject=function(e){return e?new t(e.name):null},t}(),Ri=function(){function t(t,e,n,i,r){this.id=t,this.title=e,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=fi.all,this.images=[],this.type=Ti.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null}return Object.defineProperty(t.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===yi.linear},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLive",{get:function(){return this.streamType===Pi.live},enumerable:!0,configurable:!0}),t.fromObject=function(e){var n=Di.fromObject(e.source),i=new t(e.id,e.title,e.duration,e.language,n);return i.authenticationTypes=e.authenticationTypes,i.description=e.description,i.images=(e.images||[]).map((function(t){return Ni.fromObject(t)})),i.mrss=e.mrss,i.network=Ui.fromObject(e.network),i.seekInSeconds=e.seekInSeconds,i.streamType=Pi[e.streamType],i.supportedMediaCommands=e.supportedMediaCommands,i.tracking=e.tracking,i.references=e.references,i.packages=(e.packages||[]).map((function(t){return ji.fromObject(t)})),i.type=Ti[e.type],i.entityType=Si[e.entityType],i.isSyndicatable=e.isSyndicatable,i.brand=e.brand,i},t.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},t}();var Li=function(){function t(t){var e=function(t){var e=t.split("?")[1],n={};if(e)for(var i=e.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(t);if(this.original=t,this.id=e.videoID||e.playID||e.clip||e.externalId,t.match("sportscenter")){this.gameId=e.playGameID,this.channel=e.playChannel,this.simulcastAiringId=e.simulcastAiringId;var n=parseInt(e.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=e.eventId}this.source=e["x-source"],e.videoID?this.entityType=Si.shortform:this.entityType=Si.longform,this.type=Ti.video}return t.prototype.toString=function(t){return t==Ei.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},t.identifierStringForNetwork=function(t,e){return e==Ei.graphQL?"sportscenter://x-callback-url/showWatchStream?playChannel="+t:"natgeo://playVideo?videoID="+t},t}();function xi(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function zi(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function Hi(t,e,n,i){if(!e)return{};var r,a,o,s=null;t===_t.natGeo?s=function(t){if(!t)return{};var e={},n=t.id,i=t.title,r=t.duration;return e.c_video_id_code=n,e.c_a_media_airdate="unknown",e.c_a_media_daypart="daytime",e.c_a_media_digitaldate="unknown",e.c_a_media_episode="none",e.c_a_media_feed="natgeo live",e.c_a_media_format="vod",e.c_a_media_genre="none",e.c_a_media_network="natgeo",e.c_a_media_originator="natgeo",e.c_a_media_pass_auth="none",e.c_a_media_pass_mvpd="none",e.c_a_media_rating="none",e.c_a_media_season="none",e.c_a_media_show=i,e.c_a_media_streamtype=Ii.video,e.c_a_media_length=r,e}(e):(r=function(t,e,n){if(!t)return{};var i=t.duration,r=t.id,a=t.league,o=t.name,s=t.network,u=t.program,c=t.sport,l=t.startDateTime,d=t.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=o,p.title=o,p.clientid="us-600140",e===Si.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(u&&u.code||"")+(c&&c.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=s&&s.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return e===Si.shortform&&(p.accmethod="1",p.length=""+i,p.segA=o,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(e,n,i),a=function(t,e){if(!t)return{};var n=t.id,i=t.duration,r=t.name,a=t.league,o=t.startDateTime,s=t.network,u=t.sport,c=t.status,l=t.tracking,d={};if(e===Si.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":u&&u.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,o){var v=new Date(o);d.ns_st_ddt=v.toDateString(),d.ns_st_tdt=v.toDateString()}return d.ns_st_st=s?s.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(e,n),o=function(t,e,n){if(!t)return{};var i=t.name,r=t.id,a=t.airingId,o=t.eventId,s=t.duration,u=t.network,c=t.status,l=i+" - "+r;u&&u.type===yi.linear&&(l=u.id);var d={};return d.contentId=r,a&&(d.airingId=a),o&&(d.eventId=""+o,d.eventName=i),u&&(d.network=u.id),e===Si.shortform?d.assetType="clip":!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?d.assetType="vod":d.assetType="live",d.appBrand=_t.espn,{assetName:l,duration:s,streamUrl:n&&n.url,custom:d}}(e,n,i),s=function(t,e){if(!t)return{};var n=t.duration,i=t.airingId,r=t.network,a=t.status,o=t.sport,s=t.league,u=t.program,c=t.startDateTime,l=t.tracking,d=t.originalPublishDate,h=t.expirationDate,p=t.lastModifiedDate,f=t.ad,v=t.coverageType,y={};if(y.ContentDuration=n,e===Si.longform){if(y.isFullEpisode="y",i&&(y.AiringID=i),r&&(y.NetworkName=r.id,y.Channel=r.id),a&&(y.VideoType="REPLAY"===a?"replay":"live"),y.Sport=o&&o.name||"Not Applicable",y.SportCode=o&&o.code||"Not Applicable",y.League=s&&s.name||"Not Applicable",u&&u.code&&u.categoryCode?y.ProgramCode=u.categoryCode+u.code:y.ProgramCode="Not Applicable",y.IsStudio=u&&u.isStudio||"Not Applicable",c){var g=new Date(c);y.AirDate=g.toDateString(),y.AirTime=g.toTimeString()}}else if(e===Si.shortform){if(y.isFullEpisode="n",y.VideoType="vod",y.Sport=l&&l.sportName||"Not Applicable",y.League=l&&l.leagueName||"Not Applicable",y.ShowCode=f&&f.bundle||"Not Applicable",l&&l.name&&(y.CMSID=l.name),d){g=new Date(d);y.PublishDate=g.toISOString().substring(0,10),y.PublishTime=g.toISOString().substring(11)}if(h){g=new Date(h);y.ExpirationDate=g.toISOString()}if(p){g=new Date(p);y.DateLastModified=g.toISOString()}v&&(y.VideoTypeDetail=v)}return y}(e,n));var u={};return u[Ai.nielsen]=r,u[Ai.comscore]=a,u[Ai.conviva]=o,u[Ai.heartbeats]=s,u}function Bi(t,e,n){return t.sort((function(t,e){var n="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2,i="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(t,n){var i=t.network&&t.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=e.indexOf(i),o=e.indexOf(r);return-1===a&&(a=999),-1===o&&(o=999),a<o?-1:a>o?1:0})).sort((function(t,e){var i=t.language===n?0:1,r=e.language===n?0:1;return i<r?-1:i<r?1:0}))}var Vi="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName }",Fi="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}";var Ki="https://web.archive.org/web/20201110234047/https://watch.graph.api.espn.com/api",Ji="d15c5790-7cb0-4fe1-8782-25f4698d0739",Gi=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],qi="https://web.archive.org/web/20201110234047/https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock",Wi=function(t,e,n,i){t==Ei.graphQL?(this.serviceUrl=e||Ki,this.apiKey=n||Ji,this.networkSortOrder=i||Gi):t==Ei.cfa&&(this.serviceUrl=e||qi)};!function(){function t(){this.configuration_=t.defaultConfiguration}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return xi(this,void 0,void 0,(function(){return zi(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return xi(this,void 0,void 0,(function(){var r,a,o,s,u,c;return zi(this,(function(l){switch(l.label){case 0:return r=e.map((function(t){return new Li(t)})),a=i.serviceUrl,o=i.apiKey,s=i.networkSortOrder,[4,w.all(r.map((function(e){return t.getPromiseMediaItems(e,a,o,n)})))];case 1:return u=l.sent(),(c=u.filter((function(t){return!(t instanceof Error)&&t instanceof Ri}))).length?[2,Bi(c,s,navigator.language)]:[2,null]}}))}))},t.getPromiseMediaItems=function(e,n,i,r){return xi(this,void 0,void 0,(function(){var a,o,s,u,c,l,d,h,p,f,v,y;return zi(this,(function(g){switch(g.label){case 0:a=function(t,e,n,i){var r="",a="",o="",s=i||"US";return t.entityType===Si.shortform?(r="VOD",o=Fi,a='id:"'+t.id+'"'):(r="airing",o=Vi,t.id?a='id:"'+t.id+'"':t.channel?(r="airings",a='networks:["'+t.channel+'"],type:LIVE'):t.gameId&&(r="airings",a='eventId:"'+(t.eventId||t.gameId)+'"')),e+"?apiKey="+n+"&query="+("airings"===r?encodeURIComponent("{ "+r+"("+a+',countryCode:"'+s+'",deviceType:SETTOP,tz:"Z") '+o+" }"):encodeURIComponent("{ "+r+"("+a+',deviceType:SETTOP,tz:"Z") '+o+" }"))}(e,n,i,r.countryCode),g.label=1;case 1:return g.trys.push([1,4,,5]),[4,I(a)];case 2:return[4,g.sent().json()];case 3:if(o=g.sent(),s=o.data.airing,(u=o.data.airings)&&(c=e.simulcastAiringId?function(t){return t.simulcastAiringId===e.simulcastAiringId}:function(){return!0},s=u.filter(c)[0]),l=o.data.VOD,!(d=s||l))throw new Error("No results found.");if(h=function(t,e,n){var i=t.id,r=t.name,a=t.description,o=t.duration,s=t.image,u=t.eventId,c=t.requiresLinearPlayback,l=t.authTypes,d=t.source,h=t.prerollSource,p=t.packages,f=t.language,v=t.mrss,y=t.seekInSeconds,g=t.tracking,m=t.simulcastAiringId,b=t.network,P=t.status,w=t.cerebroId,A=t.syndicatable,I=P&&("LIVE"===P.toUpperCase()||"OVER"===P.toUpperCase())?Pi.live:Pi.onDemand,S=function(t){switch(t){case"NONE":return Mi.none;case"START_SESSION":return Mi.startSession;case"BAM":return Mi.bam;case"SHIELD":return Mi.shield}}(d.authorizationType),k=new Di(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===mi.stitchedPreroll&&h&&((k=new Di(h.url,Mi.none)).variant=mi.stitchedPreroll);var T=c?fi.linearPlayback:fi.all,_=g&&g.trackingId||i,E=new Ri(i,r,o,f,k);if(E.authenticationTypes=l.map((function(t){switch(t){case"DIRECT":return Oi.direct;case"OPEN":return Oi.open;case"MVPD":return Oi.mvpd;case"ISP":return Oi.isp;default:return Oi.none}})),E.description=a,E.isSyndicatable=A,s&&s.url&&E.images.push(new Ni(s.url)),E.mrss=v,b){var C="linear"===b.type?yi.linear:yi.event;E.network=new Ui(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=y,E.streamType=I,E.supportedMediaCommands=T,E.brand=E.brand?E.brand:"espn",E.tracking=Hi(E.brand,t,e,k),E.references={eventId:u,simulcastAiringId:m,trackingId:_,cerebroId:w},E.type=Ti.video,E.entityType=e,E.apiSource=Ei.graphQL,E.packages=(p||[]).map((function(t){return new ji(t.name)})),E}(d,e.entityType,r),e.resumeTime&&(h.seekInSeconds=e.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===yi.linear,v=d.network&&d.network.id,p&&f&&v)return[2,t.retryGetMediaItems(v,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return y=g.sent(),b.warn("Failed to retrieve MediaItem from GraphQL: "+y),[2,null];case 5:return[2]}}))}))},t.retryGetMediaItems=function(e,n,i,r){return xi(this,void 0,void 0,(function(){var a,o,s,u;return zi(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),a=Li.identifierStringForNetwork(e,Ei.graphQL),o=new Li(a),[4,t.getPromiseMediaItems(o,n,i,r)];case 1:if((s=c.sent())&&s instanceof Ri==!0)return[2,s];throw new Error("Retry fetchMediaItems failed with "+e);case 2:return u=c.sent(),b.warn("MediaItem is over and retry failed: "+u),[2,null];case 3:return[2]}}))}))},t.defaultConfiguration=new Wi(Ei.graphQL)}();var Yi;!function(){function t(){this.configuration_=t.defaultConfiguration}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),t.prototype.getMediaItems=function(e,n){return xi(this,void 0,void 0,(function(){return zi(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return xi(this,void 0,void 0,(function(){var n,r;return zi(this,(function(a){switch(a.label){case 0:return n=e.map((function(t){return new Li(t)})),r=i.serviceUrl,[4,w.all(n.map((function(e){return t.getPromiseMediaItem(e,r)})))];case 1:return[2,a.sent().filter((function(t){return!(t instanceof Error)&&t instanceof Ri}))]}}))}))},t.getPromiseMediaItem=function(t,e){return xi(this,void 0,void 0,(function(){var n,i,r;return zi(this,(function(a){switch(a.label){case 0:n=e.replace("videoID",t.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,I(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(t){var e=t.id,n=t.title,i=t.description,r=t.duration,a=t.source,o=t.type,s=t.entityType,u=t.streamType,c=t.authenticationTypes,l=t.language,d=t.network,h=t.brand,p=t.images,f=s,v=a.type,y=new Di(a.url,v),g=new Ri(e,n,r,l,y);return g.authenticationTypes=c.map((function(t){switch(t){case"DIRECT":return Oi.direct;case"OPEN":return Oi.open;case"MVPD":return Oi.mvpd;case"ISP":return Oi.isp;default:return Oi.none}})),g.description=i,d&&(g.network=new Ui(d.id,d.type,d.name,d.resource)),g.streamType=u,g.brand=h,g.tracking=Hi(g.brand,t,f,y),g.images=p,g.type=o,g.entityType=f,g.apiSource=Ei.cfa,g}(i)];case 4:return r=a.sent(),b.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},t.defaultConfiguration=new Wi(Ei.cfa)}();!function(t){t.localStorage="LOCAL_STORAGE",t.sessionStorage="SESSION_STORAGE"}(Yi||(Yi={}));var Qi,Xi=function(){function t(t,e,n,i){this.id=t,this.name=e,this.logoUrl=n,this.websiteUrl=i}return t.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},t.fromObject=function(e){return new t(e.id,e.name,e.logoUrl,e.websiteUrl)},t}();!function(t){t.token="token",t.tokenType="tokenType",t.resource="resource",t.requestor="requestor"}(Qi||(Qi={}));var Zi,$i,tr=function(){function t(t,e,n,i){void 0===i&&(i={}),this.authenticationType=t,this.authenticatedProvider=e,this.authenticatedIdentity=n,this.customData=i}return t.CustomDataKey=Qi,t}(),er=function(t,e){this.success=t,this.payload=e};!function(t){t.standard="default",t.googleAdManager="gam"}(Zi||(Zi={})),function(t){t.standard="default",t.prod="prod",t.development="dev"}($i||($i={}));var nr=function(){function t(t,e){this.id=t,this.tier=e}return t.prototype.toString=function(){return"<AuthenticatedPackage id:"+this.id+", tier:"+this.tier+">"},t.fromObject=function(e){return new t(e.id,e.tier)},t}();var ir,rr=new function(t,e,n,i){this.preauthorizedNetworksEnabled=t,this.preauthorizedNetworks=e,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),ar=(function(){function t(t,e,n,i){void 0===i&&(i={}),this.partner=t,this.platform=e,this.requestorId=n,this.options=i,this.adobePass=null,this.providerDataSource=null,this.configuration=rr}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.isAuthenticated")},set:function(t){localStorage.setItem("AdobePassAuthenticator.isAuthenticated",JSON.stringify(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("AdobePassAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedIdentity",t):localStorage.removeItem("AdobePassAuthenticator.authenticatedIdentity")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedPackage",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedPackage");try{return nr.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedPackage",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedPackage")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedProvider");try{return Xi.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedProvider")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasPreviouslyAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.wasPreviouslyAuthenticated")||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){if(!this.isAuthenticated)return[];var t=localStorage.getItem("AdobePassAuthenticator.preauthorizedResources");try{return JSON.parse(t)}catch(t){return[]}},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this;b.debug("AdobePassAuthenticator.checkAuthentication");var e=this.adobePass;return e?e.checkAuthentication().then((function(n){return t.isAuthenticated=n,n?(localStorage.setItem("AdobePassAuthenticator.wasPreviouslyAuthenticated","true"),t.getPreauthorizedResources().then((function(t){localStorage.setItem("AdobePassAuthenticator.preauthorizedResources",JSON.stringify(t))})),e.getUserMetadata().then((function(e){var n=e.data,i=n.upstreamUserID,r=n.mvpd,a=n.packageId,o=n.tier;return t.authenticatedIdentity=i,(a||o)&&(t.authenticatedPackage=new nr(a,o)),t.providerDataSource?t.providerDataSource.getProvider(r).then((function(e){var n=e.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new Xi(r,e.name,n,e.websiteUrl),!0})).catch((function(){return t.authenticatedProvider=new Xi(r,r,null,null),!0})):(t.authenticatedProvider=new Xi(r,r,null,null),w.resolve(!0))}))):(t.authenticatedIdentity=null,t.authenticatedProvider=null,t.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources"),w.resolve(!1))})).catch((function(){return w.resolve(!1)})):w.resolve(!1)},t.prototype.authenticate=function(){var t=this;if(!this.currentRegistrationCode)return w.reject(new Error("Use getRegistrationCode first."));b.debug("AdobePassAuthenticator.authenticate currentRegistrationCode: "+this.currentRegistrationCode.code);var e=this.currentRegistrationCode.expires;return e&&Date.now()>e?w.reject(new Error("Your activation code has expired.")):new w((function(e,n){t.authenticateTimer_=setTimeout((function(){t.checkAuthentication().then((function(t){e(t)})).catch((function(t){n(t)}))}),5e3)})).then((function(e){return e||t.authenticate()}))},t.prototype.cancelAuthenticate=function(){b.debug("AdobePassAuthenticator.cancelAuthenticate"),this.authenticateTimer_&&clearTimeout(this.authenticateTimer_)},t.prototype.deauthenticate=function(){this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources");var t=this.adobePass;return t?t.logout():w.resolve(!1)},t.prototype.getRegistrationCode=function(){var t=this;b.debug("AdobePassAuthenticator.getRegistrationCode");var e=this.adobePass;return e?e.createRegistrationCode().then((function(e){return t.currentRegistrationCode=e,e?e.code:""})):w.reject(new Error("adobe pass not configured"))},t.prototype.checkAuthorization=function(t){var e=this;if(-1===t.authenticationTypes.indexOf(Oi.mvpd)||!this.isAuthenticated)return w.resolve(new er(!1,null));var n=t.mrss,i=this.authenticatedPackage&&this.authenticatedPackage.id;i&&(n=function(t,e,n){if(!t||!e||!n)return t;var i="</item></channel></rss>",r=-1;return-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:affiliateId>"+e+"</shield:affiliateId>"+t.slice(r)),-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:airingId")&&-1!==t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:airingId>"+n+"</shield:airingId>"+t.slice(r)),t}(n,i,t.id));var r=n,a=this.adobePass;return a.authorize(r).then((function(){return a.getShortMediaToken(r)})).then((function(t){var n,i=t.serializedToken,a=((n={})[tr.CustomDataKey.token]=i,n[tr.CustomDataKey.tokenType]="ADOBEPASS",n[tr.CustomDataKey.resource]=r,n[tr.CustomDataKey.requestor]=e.requestorId,n),o=new tr(Oi.mvpd,e.authenticatedProvider,e.authenticatedIdentity,a);return new er(!0,o)})).catch((function(t){try{return t.json().then((function(t){var n=e.configuration.adobeAuthErrorRegex,i=new RegExp(n),r=t.message,a=t.details,o=i.test(r),s=i.test(a),u="This channel is not part of your TV package.";return o?s||(u=a):u=r,w.reject(new Error(u))}))}catch(t){return w.reject(new Error("There was an unexpected error."))}}))},t.prototype.getPreauthorizedResources=function(){var t=this.configuration,e=t.preauthorizedNetworksEnabled,n=t.preauthorizedNetworks,i=t.preauthorizeNetworksMapping;if(!1===e){var r=n;return Object.keys(i).forEach((function(t){var e=i[t];-1!==r.indexOf(t)&&-1===r.indexOf(e)&&r.push(e)})),w.resolve(r)}return 0===n.length?w.resolve([]):this.adobePass.preauthorize(n).then((function(t){var e=t.resources.filter((function(t){return!0===t.authorized})).map((function(t){return t.id}));return Object.keys(i).forEach((function(t){var n=i[t];-1!==e.indexOf(t)&&-1===e.indexOf(n)&&e.push(n)})),e}))},t.defaultConfiguration=rr}(),function(){function t(t,e,n,i,r,a,o,s){this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a,this.rank=o,this.availability=s,this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a||[],this.rank=o,this.availability=s}return t.prototype.getPreferredLogoUrl=function(t,e){var n=this.images.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.type}))[0],i=this.images.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.type}))[0]||n;return i?"https://web.archive.org/web/20201110234047/https://s.secure.espncdn.com/stitcher/watch/clients/"+t+"-"+e+"/providers/"+this.adobeId+".png?height=40&imageType="+i:this.images.filter((function(t){return"DESKTOP"===t.type})).map((function(t){return t.href}))[0]||null},t.prototype.toString=function(){return"<Provider id:"+this.id+", name:"+this.name+", adobeId:"+this.adobeId+">"},t}());!function(t){t.mvpd="mvpd",t.isp="isp"}(ir||(ir={}));var or=ir,sr=function(t){this.serviceUrl=t,this.serviceUrl=t};function ur(t,e){var n=t.tier||99,i=e.tier||99;if(n<i)return-1;if(n>i)return 1;var r=t.rank||9999,a=e.rank||9999;if(r<a)return-1;if(r>a)return 1;var o=t.name.toLowerCase(),s=e.name.toLowerCase();return o<s?-1:o>s?1:0}var cr={negativebgcolorImage:"COLOR_NEGATIVE",negativebgbwImage:"BW_NEGATIVE",positivebgcolorImage:"COLOR_POSITIVE",positivebgbwImage:"BW_POSITIVE",desktop:"DESKTOP"};function lr(t,e){if(!t)return null;var n=t.id,i=t.name,r=t.websiteUrl,a=t.adobeId,o=function(t){return Object.keys(t).filter((function(e){return cr[e]&&!!t[e]})).map((function(e){return{href:t[e].trim(),type:cr[e]}}))}(t.logos),s=t.countries.filter((function(t){return t.countryCode.toLowerCase()===e.toLowerCase()}))[0],u=s&&s.tier,c=s&&s.rank;return new ar(n,i,a,u,r,o,c)}function dr(t,e){return t.rows.map((function(t){return lr(t.data,e)})).sort(ur)}var hr={};hr[or.mvpd]="adobeId",hr[or.isp]="ispId";var pr,fr=new sr("https://web.archive.org/web/20201110234047/https://affiliate.api.espn.com/affiliateApi/affiliates?includeProperties=true&rows=1000&apikey=q458c7hcllto16w0wcjytqoxq"),vr=(function(){function t(t){this.locationProvider=t||{getCountryCode:function(){return"us"}},this.applicationId=null,this.configuration=fr}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applicationId",{get:function(){return this.applicationId_},set:function(t){this.applicationId_=t},enumerable:!0,configurable:!0}),t.prototype.getProvider=function(t,e,n){return void 0===n&&(n={}),xi(this,void 0,void 0,(function(){var i,r,a,o;return zi(this,(function(s){switch(s.label){case 0:return i=e||or.mvpd,r=hr[i]||"adobeId",n[r]=t,[4,this.getProviders(n)];case 1:if(a=s.sent(),!(o=a[0]))throw new Error("Unable to find provider.");return[2,o]}}))}))},t.prototype.getProviders=function(t){return void 0===t&&(t={}),xi(this,void 0,void 0,(function(){var e,n,i,r,a,o;return zi(this,(function(s){switch(s.label){case 0:e=this.configuration.serviceUrl,n=-1===e.indexOf("?")?"?":"&",i=this.applicationId,r=function(t){return-1!==["PR","GU","VI"].indexOf(t)?"US":t}(this.locationProvider.getCountryCode().toUpperCase()),i&&(t.application=i),t.country=r,a=Object.keys(t).map((function(e){return e+"="+encodeURIComponent(t[e])})).join("&"),o=""+e+n+a,s.label=1;case 1:return s.trys.push([1,4,,5]),[4,I(o)];case 2:return[4,s.sent().json()];case 3:return[2,dr(s.sent(),r)];case 4:return s.sent(),[2,[]];case 5:return[2]}}))}))},t.defaultConfiguration=fr}(),function(){function t(t){this.authenticatedProviderId=null,this.providerDataSource=null,this.partner=t.partner,this.platform=t.platform}return Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return!!this.token&&!!this.tokenType},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("TokenAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedIdentity",t):localStorage.removeItem("TokenAuthenticator.authenticatedIdentity")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("TokenAuthenticator.authenticatedProvider");try{return Xi.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("TokenAuthenticator.authenticatedProvider")},enumerable:!0,configurable:!0}),t.prototype.setToken=function(t,e,n){this.token=t,this.tokenType=e,this.resource=n},t.prototype.checkAuthentication=function(){var t=this,e=this.authenticatedProviderId;if(!e||this.authenticatedProvider&&e===this.authenticatedProvider.id)return w.resolve(this.isAuthenticated);if(!this.providerDataSource)return this.authenticatedProvider=new Xi(e,e,null,null),w.resolve(this.isAuthenticated);var n,i="ADOBEPASS"===(n=this.tokenType)?or.mvpd:"DEVICE"===n?or.isp:null;return this.providerDataSource.getProvider(e,i).then((function(n){var i=n.getPreferredLogoUrl(t.partner,t.platform);return t.authenticatedProvider=new Xi(e,n.name,i,n.websiteUrl),w.resolve(t.isAuthenticated)})).catch((function(){return t.authenticatedProvider=new Xi(e,e,null,null),w.resolve(t.isAuthenticated)}))},t.prototype.authenticate=function(t){var e=t.authenticatedProviderId,n=t.authenticatedIdentity,i=t.token,r=t.tokenType;return this.authenticatedProviderId=e,this.authenticatedIdentity=n,this.setToken(i,r,null),this.checkAuthentication()},t.prototype.deauthenticate=function(){return this.authenticatedProvider=null,this.authenticatedIdentity=null,this.token=null,this.tokenType=null,this.resource=null,w.resolve(!0)},t.prototype.checkAuthorization=function(t){var e,n,i="ADOBEPASS"===(n=this.tokenType)?Oi.mvpd:"DEVICE"===n?Oi.isp:"BAM"===n?Oi.direct:null;if(!this.isAuthenticated||-1===t.authenticationTypes.indexOf(i)&&"DEVICE"!==this.tokenType&&"GATEKEEPER"!==this.tokenType)return w.resolve(new er(!1,null));var r=((e={})[tr.CustomDataKey.token]=this.token,e[tr.CustomDataKey.tokenType]=this.tokenType,e);this.resource&&(r.resource=this.resource);var a=new tr(i,this.authenticatedProvider,this.authenticatedIdentity,r),o=new er(!0,a);return w.resolve(o)},t}());function yr(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function gr(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}!function(t){t.localStorage="LOCAL_STORAGE",t.sessionStorage="SESSION_STORAGE"}(pr||(pr={}));var mr,br=function(){function t(t,e,n,i){this.id=t,this.name=e,this.logoUrl=n,this.websiteUrl=i}return t.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},t.fromObject=function(e){return new t(e.id,e.name,e.logoUrl,e.websiteUrl)},t}();!function(t){t.token="token",t.tokenType="tokenType",t.resource="resource",t.requestor="requestor"}(mr||(mr={}));var Pr,wr,Ar=function(){function t(t,e,n,i){void 0===i&&(i={}),this.authenticationType=t,this.authenticatedProvider=e,this.authenticatedIdentity=n,this.customData=i}return t.CustomDataKey=mr,t}(),Ir=function(t,e){this.success=t,this.payload=e};!function(t){t.standard="default",t.googleAdManager="gam"}(Pr||(Pr={})),function(t){t.standard="default",t.prod="prod",t.development="dev"}(wr||(wr={}));var Sr,kr="entitlements",Tr=new function(t,e){void 0===e&&(e=kr),this.serviceUrl=t,this.entitlementsPath=e}("https://web.archive.org/web/20201110234047/https://tve.dtci.technology",kr);function _r(t,e,n,i){return new(n||(n=w))((function(r,a){function o(t){try{u(i.next(t))}catch(t){a(t)}}function s(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((i=i.apply(t,e||[])).next())}))}function Er(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}!function(t){t.badToken="badToken",t.other="other"}(Sr||(Sr={}));var Cr=function(){function t(t,e){void 0===e&&(e="entitlements"),this.serviceUrl=t,this.entitlementsPath=e}return t.prototype.getEntitlements=function(t){return _r(this,void 0,void 0,(function(){var e,n,i,r,a;return Er(this,(function(o){switch(o.label){case 0:e=this.serviceUrl+"/"+this.entitlementsPath,n={user_token:t},i=Object.keys(n).map((function(t){return t+"="+encodeURIComponent(n[t])})).join("&"),r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:i},o.label=1;case 1:return o.trys.push([1,4,,5]),[4,I(e,r)];case 2:return[4,o.sent().json()];case 3:return[2,o.sent()];case 4:return a=o.sent(),console.error("Error retrieving Entitlements from DTCITVEntitlementAPI: "+a),[3,5];case 5:return[2]}}))}))},t.prototype.logout=function(t,e,n){return _r(this,void 0,void 0,(function(){var i,r,a,o,s;return Er(this,(function(u){switch(u.label){case 0:i=this.serviceUrl+"/affiliates/"+t+"/logout",r={user_token:e},n&&(r.redirect_uri=n),a=Object.keys(r).map((function(t){return t+"="+encodeURIComponent(r[t])})).join("&"),o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:a},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,I(i,o)];case 2:return u.sent(),[2,!0];case 3:return s=u.sent(),console.error("Error logging out of affiliate account DTCITVEntitlementAPI: "+s),[2,!1];case 4:return[2]}}))}))},t.prototype.tokenIsValid=function(t){try{var e=function(t){var e=t.split("."),n=U.stringify(D.parse(e[1]));return JSON.parse(n)}(t);if(!e.exp)return!0;var n=new Date;return!(new Date(1e3*e.exp)<n)}catch(t){return!1}},t}(),Or="watchsdk.tve_authenticator.state",Mr=function(t,e){e.setItem(Or,JSON.stringify(t))},Dr=function(t){function n(t,i){var r;return e(this,n),(r=d(this,c(n).call(this,t,i))).providerDataSource=new Ln(i),r}return u(n,t),n}(function(){function t(t,e){this.identityTokenProvider=t,this.locationProvider=e,this.authenticationUrl="https://web.archive.org/web/20201110234047/https://www.espn.com/watch/auth",this.edition="espn-nl-nl",this.storage=localStorage,this.tveAPI=new Cr(Tr.serviceUrl,Tr.entitlementsPath),this.delegate=null,this.providerDataSource=null,window.displayProviderDialog=this.displayProviderDialog.bind(this);try{var n=this.storage.getItem(Or),i=JSON.parse(n);this.state_=i||{}}catch(t){}}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return this.state_.isAuthenticated},set:function(t){this.state_.isAuthenticated=t,Mr(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){var t,e;return null===(e=null===(t=this.state_.entitlements)||void 0===t?void 0:t.accounts[0])||void 0===e?void 0:e.id},set:function(t){this.state_.authenticatedIdentity=t,Mr(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(t){if(!t)return delete this.state_.authenticatedProvider,void Mr(this.state_,this.storage);this.state_.authenticatedProvider=t,Mr(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"entitlements",{get:function(){return this.state_.entitlements},set:function(t){if(!t)return delete this.state_.entitlements,void Mr(this.state_,this.storage);this.state_.entitlements=t,Mr(this.state_,this.storage)},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){return yr(this,void 0,void 0,(function(){var t,e,n,i=this;return gr(this,(function(r){switch(r.label){case 0:return b.debug("TVEAuthenticator.checkAuthentication"),(t=this.identityTokenProvider.getIdentityToken())?(e=this,[4,this.tveAPI.getEntitlements(t)]):[2,w.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:return e.entitlements=r.sent(),this.entitlements?(n=this.entitlements.accounts[0])?(this.isAuthenticated=!(!t||!n),this.authenticatedProvider=new br(n.affiliate.id,n.affiliate.name,null,null),this.providerDataSource?[2,this.providerDataSource.getProvider(n.affiliate.id,se.mvpd).then((function(t){var e=t&&t.images||[],r=e.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.href}))[0],a=e.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.href}))[0]||r||e.map((function(t){return t.href}))[0];return i.authenticatedProvider=new br(t.adobeId||n.affiliate.id,n.affiliate.name,a,t.websiteUrl),i.isAuthenticated})).catch((function(){return i.isAuthenticated}))]:[2,w.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,w.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,w.reject(new Error("TVEAuthenticator.NotEntitled"))])}}))}))},t.prototype.authenticate=function(t){var e=this,n=this.providerId,i=this.accessType,r=this.edition,a=t&&t.redirectUrl||window.location.href,o=this.identityTokenProvider.getIdentityToken();return new w((function(t){var s;if(e.resolveAuthenticate_=function(e){t(e)},!n)return e.redirectUrl=a,e.displayProviderDialog(),w.resolve(!1);var u=null===(s=e.locationProvider.getCountryCode())||void 0===s?void 0:s.toLowerCase(),c={mvpd:n,redirectUrl:a,country:u};r&&(c["edition-view"]=r),i&&(c.accessType=i);var l=Object.keys(c).map((function(t){return t+"="+encodeURIComponent(c[t])})).join("&"),d=-1===e.authenticationUrl.indexOf("?")?"?":"&",h=""+e.authenticationUrl+d+l;o&&(h=h+"#oneIdToken="+o),window.location.href=h}))},t.prototype.deauthenticate=function(){var t=this.entitlements.accounts[0].affiliate.id,e=this.identityTokenProvider.getIdentityToken();return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.entitlements=null,e?this.tveAPI.logout(t,e,null).catch((function(){return!0})):w.resolve(!0)},t.prototype.checkAuthorization=function(){return yr(this,void 0,void 0,(function(){var t,e,n,i,r,a;return gr(this,(function(o){switch(o.label){case 0:return(t=this.identityTokenProvider.getIdentityToken())?this.isAuthenticated?this.entitlements&&this.tveAPI.tokenIsValid(this.entitlements.token)?[3,2]:(e=this,[4,this.tveAPI.getEntitlements(t)]):[2,w.reject(new Error("TVEAuthenticator.AuthenticationRequired"))]:[2,w.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:e.entitlements=o.sent(),o.label=2;case 2:return this.entitlements&&this.tveAPI.tokenIsValid(this.entitlements.token)?((a={})[Ar.CustomDataKey.token]=this.entitlements.token,a[Ar.CustomDataKey.tokenType]="JWT",n=a,i=new Ar(Pt.mvpd,this.authenticatedProvider,this.authenticatedIdentity,n),r=new Ir(!0,i),[2,w.resolve(r)]):[2,w.reject(new Error("TVEAuthenticator.NotEntitled"))]}}))}))},t.prototype.displayProviderDialog=function(){var t=this;b.debug("TVEAuthenticator.displayProviderDialog"),this.providerDataSource&&this.providerDataSource.getProviders().then((function(e){t.delegate&&t.delegate.selectProvider&&t.delegate.selectProvider(e)}))},t.prototype.setProvider=function(t,e){var n=this;b.debug("TVEAuthenticator.setProvider"),this.providerId=t,this.accessType=e,this.authenticate({redirectUrl:this.redirectUrl}).then((function(){n.resolveAuthenticate_&&(n.resolveAuthenticate_(n.isAuthenticated),n.resolveAuthenticate_=null)}))},t.defaultConfiguration=Tr,t}()),Ur=function(t){function n(){return e(this,n),d(this,c(n).call(this))}return u(n,t),n}(K),Nr=function(){function t(n,i){e(this,t),this.playerAdaptor=n,this.mediaItem=i,this._currentContentType=null,this._currentAdId=null,this._lastHeartbeatTime=null,this._initialHeartbeatTimer=null,this._heartbeatTimer=null,this._currentPlayerTime=0,this._initialPlayerTime=null,this._isPlaying=!1,this._handleStart=this._handleStart.bind(this),this.playerAdaptor.on(ei.start,this._handleStart),this._handlePlaying=this._handlePlaying.bind(this),this.playerAdaptor.on(ei.playing,this._handlePlaying),this._handlePaused=this._handlePaused.bind(this),this.playerAdaptor.on(ei.pause,this._handlePaused),this.playerAdaptor.on(ei.stalled,this._handlePaused),this.playerAdaptor.on(ei.seeking,this._handlePaused),this._handlePlayerCurrentTime=this._handlePlayerCurrentTime.bind(this),this.playerAdaptor.on(ei.currentTime,this._handlePlayerCurrentTime),this._handleTimedMetadata=this._handleTimedMetadata.bind(this),this.playerAdaptor.on(ei.timedMetadata,this._handleTimedMetadata),this._handleStop=this._handleStop.bind(this),this.playerAdaptor.on(ei.stop,this._handleStop)}return i(t,[{key:"onContentTypeChanged",value:function(t,e,n,i){}},{key:"stop",value:function(){this.playerAdaptor.off(ei.start),this.playerAdaptor.off(ei.playing),this.playerAdaptor.off(ei.pause),this.playerAdaptor.off(ei.stalled),this.playerAdaptor.off(ei.seeking),this.playerAdaptor.off(ei.timedMetadata),this.playerAdaptor.off(ei.currentTime),this.playerAdaptor.off(ei.stop)}},{key:"_handleStart",value:function(){if(b.debug("AdBreakMonitor._handleStart"),!0!==this.mediaItem.source.hasEspnId3Heartbeats)return b.debug("AdBreakMonitor._handleStart hasEspnId3Heartbeats !== true, setting currentContentType to content.",this._currentPlayerTime,this._initialPlayerTime,this.mediaItem.source.hasEspnId3Heartbeats),void(this.currentContentType=t.ContentType.content);this._scheduleInitialHeartbeatTimer()}},{key:"_handlePlaying",value:function(){this._isPlaying=!0}},{key:"_handlePaused",value:function(){this._isPlaying=!1}},{key:"_handleTimedMetadata",value:function(t){if(!0===this.mediaItem.source.hasEspnId3Heartbeats&&t.tag===qn.priv&&t.owner===Wn.heartbeat){b.debug("AdBreakMonitor._handleTimedMetadata",JSON.stringify(t));var e=function(t){var e;try{e=JSON.parse(t.dataValue)}catch(t){return null}return e.length?e.map((function(t){return new Zn(t.type,t.id)})):null}(t);e&&this._handleHeartbeats(e)}}},{key:"_handlePlayerCurrentTime",value:function(t){var e=Math.floor(t);null===this._initialPlayerTime&&(this._initialPlayerTime=e),this._currentPlayerTime=e}},{key:"_handleStop",value:function(){this._invalidateInitialHeartbeatTimer(),this._invalidateHeartbeatTimer()}},{key:"_handleHeartbeats",value:function(e){b.debug("AdBreakMonitor._handleHeartbeats",JSON.stringify(e)),this._invalidateInitialHeartbeatTimer(),this._lastHeartbeatTime=Date.now();var n=e.every((function(t){return t.isContent}))?t.ContentType.content:t.ContentType.ad;n===t.ContentType.ad&&(this._currentAdId=function(t){return t.find((function(t){return t.type===Yn.commercial&&null!==t.id}))||null}(e)),this.currentContentType=n,this._scheduleHeartbeatTimer()}},{key:"_scheduleInitialHeartbeatTimer",value:function(){var t=this;b.debug("AdBreakMonitor._scheduleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),this._initialHeartbeatTimer=setInterval((function(){t._handleInitialHeartbeatTimer()}),15e3)}},{key:"_invalidateInitialHeartbeatTimer",value:function(){this._initialHeartbeatTimer&&(clearInterval(this._initialHeartbeatTimer),this._initialHeartbeatTimer=null)}},{key:"_handleInitialHeartbeatTimer",value:function(){if(b.debug("AdBreakMonitor._handleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),!1!==this._isPlaying){if(!this.currentContentType){var e=t.ContentType.ad;this._currentAdId="1",this.currentContentType=e}}else this._scheduleInitialHeartbeatTimer()}},{key:"_scheduleHeartbeatTimer",value:function(){var t=this;this._invalidateHeartbeatTimer(),this._heartbeatTimer=setInterval((function(){t._handleHeartbeatTimer()}),1e4)}},{key:"_invalidateHeartbeatTimer",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:"_handleHeartbeatTimer",value:function(){var e=Date.now();if(b.debug("AdBreakMonitor._handleHeartbeatTimer"),!1!==this._isPlaying){if(this._lastHeartbeatTime&&e-this._lastHeartbeatTime>2e4){b.debug("AdBreakMonitor._handleHeartbeatTimer [now - this._lastHeartbeatTime]: ",e-this._lastHeartbeatTime);var n=t.ContentType.ad;this._currentAdId="1",this.currentContentType=n}this._scheduleHeartbeatTimer()}else this._scheduleHeartbeatTimer()}},{key:"currentContentType",get:function(){return this._currentContentType},set:function(t){if(this._currentContentType!==t){var e=this._currentContentType;this._currentContentType=t;var n=this._currentPlayerTime;e||(n=this._initialPlayerTime||0),this.onContentTypeChanged&&this.onContentTypeChanged(t,e,n,this._currentAdId)}}}]),t}();Nr.ContentType={ad:"ad",content:"content"};var jr={production:"PROD",testing:"TESTING"},Rr={};Rr[jr.production]="https://web.archive.org/web/20201110234047/https://cloudapi.imrworldwide.com/nmapi/v2",Rr[jr.testing]="https://web.archive.org/web/20201110234047/https://sandbox-cloudapi.imrworldwide.com/nmapi/v2";var Lr=function(){function t(n,i,r,a,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:jr.production;e(this,t);var u=n instanceof t.Configuration||n===Object(n)?n:new t.Configuration(n,i,r,a,o,s);b.debug("NielsenCloudAPIClient.constructor",JSON.stringify(u)),this.configuration=u,this.sessionId=V()}return i(t,[{key:"sendEvent",value:function(t,e,n,i,r){var a={devInfo:this.devInfo,metadata:{},event:t,position:isNaN(e)||null===e?"".concat(e):"".concat(Math.floor(e)),type:n,utc:"".concat(Date.now())};i&&(a.metadata.content=i.tracking[ht.nielsen]),n===Nr.ContentType.ad&&(a.metadata.ad=r);var o="".concat(Rr[this.env],"/").concat(this.appId,"/").concat(this.sessionId,"/a?b=").concat(encodeURIComponent(JSON.stringify(a)));b.debug("NielsenCloudAPIClient.sendEvent url:",o),b.debug("NielsenCloudAPIClient.sendEvent payload:",JSON.stringify(a)),I(o).then((function(t){b.debug("NielsenCloudAPIClient.sendEvent response.status: ".concat(t.status))})).catch((function(t){b.warn("NielsenCloudAPIClient.sendEvent response.error: ".concat(t&&t.message))}))}},{key:"closeSession",value:function(){this.sendEvent(t.EventType.delete,"","",null,null)}},{key:"configuration",set:function(t){t&&(this.appId=t.appId,this.devInfo={devId:!1===t.isOptOut?t.deviceId:"",apn:t.appName,apv:"".concat(t.appVersion),uoo:"".concat(t.isOptOut)},this.env=t.environment,this._configuration=t)},get:function(){return this._configuration}}]),t}();Lr.AssetType={content:"content",ad:"ad"},Lr.EventType={playhead:"playhead",complete:"complete",delete:"delete"},Lr.Environment=jr,Lr.Configuration=function t(n,i,r,a,o,s){e(this,t),this.appId=n,this.appName=i,this.appVersion=r,this.deviceId=a,this.isOptOut=o,this.environment=s};var xr=function(){function t(n,i,r){var a=this;e(this,t),this.cloudAPIClient=n,this.playerAdaptor=i;var o=qt.fromObject(r)||r;if(o.entityType===ft.airing){this.mediaItem=o,this.currentPlayerTime=null,this.lastContentBeaconTime=null,this._isPlayerPlaying=!1,this.playerAdaptor.on(ei.playing,(function(t){if(b.debug("NielsenTrackingManager PlayerAdaptorEvent.playing"),t){var e=Math.floor(t);a.currentPlayerTime=e}a.isPlayerPlaying=!0})),this.playerAdaptor.on(ei.seeking,(function(){b.debug("NielsenTrackingManager PlayerAdaptorEvent.seeking"),a.isPlayerPlaying=!1})),this.playerAdaptor.on(ei.pause,(function(){b.debug("NielsenTrackingManager PlayerAdaptorEvent.pause"),a.isPlayerPlaying=!1})),this.playerAdaptor.on(ei.currentTime,(function(t){var e=Math.floor(t);a.currentPlayerTime=e;var n=a.currentContentType;if(n&&a.isPlayerPlaying){var i=e-a.currentContentStartTime;0!==i&&i%10==0&&e!==a.lastContentBeaconTime&&e>a.lastContentBeaconTime&&(a.lastContentBeaconTime=e,b.debug("NielsenTrackingManager PlayerAdaptorEvent.currentTime sending playhead 10 second beacon",e),a._sendPlayheadEvent(n,e))}})),this.playerAdaptor.on(ei.stop,(function(){a.stop()})),this.currentContentType=null,this.currentContentStartTime=0,this.totalAdTime=0,this.currentAdInfo=null;var s=new Nr(i,r);s.onContentTypeChanged=function(t,e,n){if(b.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged from",e,"to",t),e){b.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead before contentType change");var i=a._getPlayheadPosition(e,n,!0);a.cloudAPIClient.sendEvent(Lr.EventType.playhead,i,e,a.mediaItem,a.currentAdInfo)}b.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead after contentType change");var r=e&&!a.mediaItem.isLive?0:a._getPlayheadPosition(t,n),o=t===Nr.ContentType.ad?{assetid:"1",type:0===r?"preroll":"midroll"}:null;a.cloudAPIClient.sendEvent(Lr.EventType.playhead,r,t,a.mediaItem,o),a.currentContentType=t,a.currentContentStartTime=n,a.currentAdInfo=o,a.lastContentBeaconTime=n},this.adBreakMonitor=s}}return i(t,[{key:"stop",value:function(){this.playerAdaptor.off(ei.currentTime),this.playerAdaptor.off(ei.stop),this.adBreakMonitor&&this.adBreakMonitor.stop(),this.mediaItem=null}},{key:"_getPlayheadPosition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.mediaItem.isLive)return Math.floor(Date.now()/1e3);if(t===Nr.ContentType.ad){if(n){var i=e-this.currentContentStartTime;return this.totalAdTime+=i,i}return 0}return e-this.totalAdTime}},{key:"_sendPlayheadEventForCurrentPlayerTimeAndContentType",value:function(){var t=this.currentPlayerTime,e=this.currentContentType;e&&t!==this.lastContentBeaconTime&&t>this.lastContentBeaconTime&&(this.lastContentBeaconTime=t,b.debug("NielsenTrackingManager _sendPlayheadEventForCurrentPlayerTimeAndContentType sending playhead beacon",t),this._sendPlayheadEvent(e,t))}},{key:"_sendPlayheadEvent",value:function(t,e){var n=e-this.currentContentStartTime,i=t!==Nr.ContentType.ad||this.mediaItem.isLive?this._getPlayheadPosition(t,e):n,r=t===Nr.ContentType.ad?this.currentAdInfo:null;this.cloudAPIClient.sendEvent(Lr.EventType.playhead,i,t,this.mediaItem,r)}},{key:"mediaItem",get:function(){return this._mediaItem},set:function(t){if(this._mediaItem){this._sendPlayheadEventForCurrentPlayerTimeAndContentType();var e=this._getPlayheadPosition(Nr.ContentType.content,this.currentPlayerTime);b.debug("NielsenTrackingManager setMediaItem sending complete"),this.cloudAPIClient.sendEvent(Lr.EventType.complete,e,Lr.AssetType.content,this._mediaItem)}this._mediaItem=t,this.adBreakMonitor&&(this.adBreakMonitor.mediaItem=t)}},{key:"isPlayerPlaying",get:function(){return this._isPlayerPlaying},set:function(t){t!==this._isPlayerPlaying&&(this._isPlayerPlaying=t,this._sendPlayheadEventForCurrentPlayerTimeAndContentType())}}]),t}();t.AdvertisingInfo=Re,t.AtvlPlayerAdaptor=ii,t.AtvlPlayerEvent=Qn,t.AtvlPlayerEventBus=Ur,t.AuthenticationManager=Gn,t.AuthenticationType=Pt,t.BAMTizenPlayerAdaptor=ri,t.BootstrappedESPNAffiliateAPI=Ln,t.ChromecastPlayerAdaptor=ai,t.Client=nt,t.DRMKeySystem=Ve,t.DRMSupport=Fe,t.DTCITVEntitlementAPI=Cr,t.DomesticLocationProvider=Rn,t.DrmSupport=Fe,t.FanManager=Nn,t.HTML5PlayerAdaptor=oi,t.LocationProvider=jn,t.MediaItemAPI=Wt,t.MediaItemAuthenticationType=Pt,t.MediaItemSourceType=wt,t.MediaItemTrackingType=ht,t.NielsenCloudAPIClient=Lr,t.NielsenTrackingManager=xr,t.PlaybackConfig=ze,t.PlaybackManager=hi,t.PlayerEventBus=Ur,t.TVEAuthenticator=Dr,t.TokenAuthenticator=vr,t.TrilithiumPlayerAdaptor=ci,t.TrilithiumPlayerEvent=ui,t.log=P,t.uuid=V,Object.defineProperty(t,"__esModule",{value:!0})}));


}
/*
     FILE ARCHIVED ON 23:40:47 Nov 10, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 01:30:17 Jul 18, 2023.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  captures_list: 118.805
  exclusion.robots: 0.07
  exclusion.robots.policy: 0.06
  RedisCDXSource: 0.588
  esindex: 0.01
  LoadShardBlock: 99.558 (3)
  PetaboxLoader3.datanode: 167.933 (5)
  load_resource: 416.296 (2)
  PetaboxLoader3.resolve: 311.691 (2)
*/