var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).WatchSDK={})}(this,(function(t){"use strict";
/** @preserve ESPN WatchSDK 4.4.9 */function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function n(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l(this,n)}}function p(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=p(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function v(t,e,n,i){return(v="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var r,a=p(t,e);if(a){if((r=Object.getOwnPropertyDescriptor(a,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,e)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,e,r)}else s(i,e,n);return!0})(t,e,n,i)}function y(t,e,n,i,r){if(!v(t,e,n,i||t)&&r)throw new Error("failed to set property");return n}function g(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function P(t,e){return t(e={exports:{}},e.exports),e.exports}var w=P((function(t){var e,n;e=b,n=function(){var t=function(){},e="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function i(t,e){var n=t[e];if("function"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(e){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function r(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(n){return"debug"===n&&(n="log"),"undefined"!=typeof console&&("trace"===n&&e?r:void 0!==console[n]?i(console,n):void 0!==console.log?i(console,"log"):t)}function s(e,i){for(var r=0;r<n.length;r++){var a=n[r];this[a]=r<e?t:this.methodFactory(a,e,i)}this.log=this.debug}function o(t,e,n){return function(){"undefined"!=typeof console&&(s.call(this,e,n),this[t].apply(this,arguments))}}function u(t,e,n){return a(t)||o.apply(this,arguments)}function c(t,e,i){var r,a=this,o="loglevel";function c(){var t;if("undefined"!=typeof window&&o){try{t=window.localStorage[o]}catch(t){}if(void 0===t)try{var e=window.document.cookie,n=e.indexOf(encodeURIComponent(o)+"=");-1!==n&&(t=/^([^;]+)/.exec(e.slice(n))[1])}catch(t){}return void 0===a.levels[t]&&(t=void 0),t}}"string"==typeof t?o+=":"+t:"symbol"==typeof t&&(o=void 0),a.name=t,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=i||u,a.getLevel=function(){return r},a.setLevel=function(e,i){if("string"==typeof e&&void 0!==a.levels[e.toUpperCase()]&&(e=a.levels[e.toUpperCase()]),!("number"==typeof e&&e>=0&&e<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+e;if(r=e,!1!==i&&function(t){var e=(n[t]||"silent").toUpperCase();if("undefined"!=typeof window&&o){try{return void(window.localStorage[o]=e)}catch(t){}try{window.document.cookie=encodeURIComponent(o)+"="+e+";"}catch(t){}}}(e),s.call(a,e,t),"undefined"==typeof console&&e<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(t){c()||a.setLevel(t,!1)},a.enableAll=function(t){a.setLevel(a.levels.TRACE,t)},a.disableAll=function(t){a.setLevel(a.levels.SILENT,t)};var d=c();null==d&&(d=null==e?"WARN":e),a.setLevel(d,!1)}var d=new c,l={};d.getLogger=function(t){if("symbol"!=typeof t&&"string"!=typeof t||""===t)throw new TypeError("You must supply a name when creating a logger.");var e=l[t];return e||(e=l[t]=new c(t,d.getLevel(),d.methodFactory)),e};var h="undefined"!=typeof window?window.log:void 0;return d.noConflict=function(){return"undefined"!=typeof window&&window.log===d&&(window.log=h),d},d.getLoggers=function(){return l},d.default=d,d},t.exports?t.exports=n():e.log=n()})),A=Object.freeze({__proto__:null,default:w,__moduleExports:w}),I=P((function(t,e){
/*!
   * @overview es6-promise - a tiny implementation of Promises/A+.
   * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
   * @license   Licensed under MIT license
   *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
   * @version   v4.2.8+1e68dce6
   */
t.exports=function(){function t(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,i=void 0,r=void 0,a=function(t,e){h[n]=t,h[n+1]=e,2===(n+=2)&&(r?r(p):m())},s="undefined"!=typeof window?window:void 0,o=s||{},u=o.MutationObserver||o.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function l(){var t=setTimeout;return function(){return t(p,1)}}var h=new Array(1e3);function p(){for(var t=0;t<n;t+=2)(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0;n=0}var f,v,y,g,m=void 0;function P(t,e){var n=this,i=new this.constructor(I);void 0===i[A]&&N(i);var r=n._state;if(r){var s=arguments[r-1];a((function(){return M(r,i,s,n._result)}))}else C(n,i,t,e);return i}function w(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(I);return S(e,t),e}c?m=function(){return process.nextTick(p)}:u?(v=0,y=new u(p),g=document.createTextNode(""),y.observe(g,{characterData:!0}),m=function(){g.data=v=++v%2}):d?((f=new MessageChannel).port1.onmessage=p,m=function(){return f.port2.postMessage(0)}):m=void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(p)}:l()}catch(t){return l()}}():l();var A=Math.random().toString(36).substring(2);function I(){}function T(e,n,i){n.constructor===e.constructor&&i===P&&n.constructor.resolve===w?function(t,e){1===e._state?E(t,e._result):2===e._state?k(t,e._result):C(e,void 0,(function(e){return S(t,e)}),(function(e){return k(t,e)}))}(e,n):void 0===i?E(e,n):t(i)?function(t,e,n){a((function(t){var i=!1,r=function(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}(n,e,(function(n){i||(i=!0,e!==n?S(t,n):E(t,n))}),(function(e){i||(i=!0,k(t,e))}),t._label);!i&&r&&(i=!0,k(t,r))}),t)}(e,n,i):E(e,n)}function S(t,e){if(t===e)k(t,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=e),null===i||"object"!==r&&"function"!==r)E(t,e);else{var n=void 0;try{n=e.then}catch(e){return void k(t,e)}T(t,e,n)}var i,r}function _(t){t._onerror&&t._onerror(t._result),O(t)}function E(t,e){void 0===t._state&&(t._result=e,t._state=1,0!==t._subscribers.length&&a(O,t))}function k(t,e){void 0===t._state&&(t._state=2,t._result=e,a(_,t))}function C(t,e,n,i){var r=t._subscribers,s=r.length;t._onerror=null,r[s]=e,r[s+1]=n,r[s+2]=i,0===s&&t._state&&a(O,t)}function O(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,r=void 0,a=t._result,s=0;s<e.length;s+=3)i=e[s],r=e[s+n],i?M(n,i,r,a):r(a);t._subscribers.length=0}}function M(e,n,i,r){var a=t(i),s=void 0,o=void 0,u=!0;if(a){try{s=i(r)}catch(t){u=!1,o=t}if(n===s)return void k(n,new TypeError("A promises callback cannot return that same promise."))}else s=r;void 0!==n._state||(a&&u?S(n,s):!1===u?k(n,o):1===e?E(n,s):2===e&&k(n,s))}var D=0;function N(t){t[A]=D++,t._state=void 0,t._result=void 0,t._subscribers=[]}var U=function(){function t(t,n){this._instanceConstructor=t,this.promise=new t(I),this.promise[A]||N(this.promise),e(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&E(this.promise,this._result))):k(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;void 0===this._state&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===w){var r=void 0,a=void 0,s=!1;try{r=t.then}catch(t){s=!0,a=t}if(r===P&&void 0!==t._state)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(n===L){var o=new n(I);s?k(o,a):T(o,t,r),this._willSettleAt(o,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(i(t),e)},t.prototype._settledAt=function(t,e,n){var i=this.promise;void 0===i._state&&(this._remaining--,2===t?k(i,n):this._result[e]=n),0===this._remaining&&E(i,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;C(t,void 0,(function(t){return n._settledAt(1,e,t)}),(function(t){return n._settledAt(2,e,t)}))},t}();var L=function(){function e(t){this[A]=D++,this._result=this._state=void 0,this._subscribers=[],I!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){S(t,e)}),(function(e){k(t,e)}))}catch(e){k(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):this.then(e,e)},e}();return L.prototype.then=P,L.all=function(t){return new U(this,t).promise},L.race=function(t){var n=this;return e(t)?new n((function(e,i){for(var r=t.length,a=0;a<r;a++)n.resolve(t[a]).then(e,i)})):new n((function(t,e){return e(new TypeError("You must pass an array to race."))}))},L.resolve=w,L.reject=function(t){var e=new this(I);return k(e,t),e},L._setScheduler=function(t){r=t},L._setAsap=function(t){a=t},L._asap=a,L.polyfill=function(){var t=void 0;if(void 0!==b)t=b;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=L},L.Promise=L,L}()}));function T(t,e){return e=e||{},new I((function(n,i){var r=new XMLHttpRequest;for(var a in r.open(e.method||"get",t,!0),e.headers)r.setRequestHeader(a,e.headers[a]);function s(){var t,e=[],n=[],i={};return r.getAllResponseHeaders().replace(/^(.*?):\s*?([\s\S]*?)$/gm,(function(r,a,s){e.push(a=a.toLowerCase()),n.push([a,s]),t=i[a],i[a]=t?"".concat(t,",").concat(s):s})),{ok:2==(r.status/100|0),status:r.status,statusText:r.statusText,url:r.responseURL,clone:s,text:function(){return I.resolve(r.responseText)},json:function(){return I.resolve(r.responseText).then((function(t){try{return JSON.parse(t)}catch(t){return{}}}))},blob:function(){return I.resolve(new Blob([r.response]))},headers:{keys:function(){return e},entries:function(){return n},get:function(t){return i[t.toLowerCase()]},has:function(t){return t.toLowerCase()in i}}}}r.withCredentials="include"===e.credentials,r.onload=function(){n(s())},r.onreadystatechange=function(){try{4===r.readyState&&(200===(t=r).status||201===t.status||202===t.status||204===t.status||0===t.status&&t.responseText&&""!==t.responseText?n(s()):i(s()))}catch(t){r.abort()}var t},r.onerror=i,r.send(e.body)}))}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function _(t,e){function n(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var E=function(){return(E=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function k(t,e,n,i){return new(n||(n=I))((function(r,a){function s(t){try{u(i.next(t))}catch(t){a(t)}}function o(t){try{u(i.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}u((i=i.apply(t,e||[])).next())}))}function C(t,e){var n,i,r,a,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}function O(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,a=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return s}function M(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(O(arguments[e]));return t}var D=P((function(t,e){var n;t.exports=(n=n||function(t,e){var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var s=n[a>>>2]>>>24-a%4*8&255;e[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)e[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n,i=[],r=function(e){e=e;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(e=18e3*(65535&e)+(e>>16)&i)&i;return r/=4294967296,(r+=.5)*(t.random()>.5?1:-1)}},a=0;a<e;a+=4){var o=r(4294967296*(n||t.random()));n=987654071*o(),i.push(4294967296*o()|0)}return new s.init(i,e)}}),o=i.enc={},u=o.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new s.init(n,e/2)}},c=o.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new s.init(n,e)}},d=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},l=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=d.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,o=r/(4*a),u=(o=e?t.ceil(o):t.max((0|o)-this._minBufferSize,0))*a,c=t.min(4*u,r);if(u){for(var d=0;d<u;d+=a)this._doProcessBlock(i,d);var l=i.splice(0,u);n.sigBytes-=c}return new s.init(l,c)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),h=(r.Hasher=l.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new h.HMAC.init(t,n).finalize(e)}}}),i.algo={});return i}(Math),n)})),N=P((function(t,e){var n,i,r;t.exports=(i=(n=r=D).lib.WordArray,n.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],a=0;a<n;a+=3)for(var s=(e[a>>>2]>>>24-a%4*8&255)<<16|(e[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|e[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;o<4&&a+.75*o<n;o++)r.push(i.charAt(s>>>6*(3-o)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(t){var e=t.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var s=n.charAt(64);if(s){var o=t.indexOf(s);-1!==o&&(e=o)}return function(t,e,n){for(var r=[],a=0,s=0;s<e;s++)if(s%4){var o=n[t.charCodeAt(s-1)]<<s%4*2,u=n[t.charCodeAt(s)]>>>6-s%4*2;r[a>>>2]|=(o|u)<<24-a%4*8,a++}return i.create(r,a)}(t,e,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)})),U=P((function(t,e){t.exports=D.enc.Utf8}));function L(t){var e=t+":";return{Authorization:"Basic "+N.stringify(U.parse(e)),Accept:"application/json"}}var j,R="live",x="vod",B="accountId",F="applicationId",H="applicationPlatform",z="channel",K="contentType",V="contractType",G="deviceModel",q="hba",J="mobileDevice",Y="programmerName",W="ship",Q="region",X=function(){function t(t,e,n,i,r){e&&n&&i&&(this.programmer=t,this.applicationId=e,this.identityProvider=encodeURIComponent(n),this.subject=encodeURIComponent(i),this.metadata=r||{},this.serviceUrl="https://web.archive.org/web/20220907123413/https://streams.adobeprimetime.com/v2",this.requestHeaders=L(e),this.heartbeatIntervalId=null,this.messages={})}return t.fetchMetadataKeys=function(e,n){return k(this,void 0,void 0,(function(){var i,r,a,s,o,u;return C(this,(function(c){switch(c.label){case 0:i=n+"/metadata",r=L(e),a={method:"GET",headers:r},c.label=1;case 1:return c.trys.push([1,5,,6]),[4,T(i,a)];case 2:return(s=c.sent())?[4,s.json()]:[3,4];case 3:return o=c.sent(),t.setLocalStorageByAppID(o,e),[2,!0];case 4:return[2,!1];case 5:return u=c.sent(),console.log("fetchMetadataKeys error: "+u),[2,!1];case 6:return[2]}}))}))},t.setLocalStorageByAppID=function(t,e){var n="AdobeCM.metadata."+e;localStorage.setItem(n,JSON.stringify(t))},Object.defineProperty(t.prototype,"metadataKeys",{get:function(){return this.getMetadataKeysFromLocalStorage_(this.applicationId)},enumerable:!1,configurable:!0}),t.prototype.getMetadataKeysFromLocalStorage_=function(t){var e="AdobeCM.metadata."+t,n=[];try{n=JSON.parse(localStorage.getItem(e))||[]}catch(t){console.error("AdobeCM getMetadataKeys error: "+t)}return n},t.prototype.start=function(){return k(this,void 0,void 0,(function(){var t;return C(this,(function(e){switch(e.label){case 0:return[4,this.createSession()];case 1:return(t=e.sent())?(this.scheduleHeartbeat(),[2,t]):[2,null]}}))}))},t.prototype.startWithSession=function(t){this.sessionId=t,this.scheduleHeartbeat()},t.prototype.stop=function(){this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=null),this.terminateSession()},t.prototype.createSession=function(t){return void 0===t&&(t=[]),k(this,void 0,void 0,(function(){var e,n,i,r,a,s,o,u,c,d;return C(this,(function(l){switch(l.label){case 0:w.debug("AdobeConcurrencyMonitorV2.createSession"),e=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject,n=E({"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},this.requestHeaders),t.length>0&&(n["X-Terminate"]=t.join(",")),i=this.getMetadata(),r=Object.keys(i).map((function(t){return t+"="+encodeURIComponent(i[t])})).join("&"),a={method:"POST",headers:n,body:r},l.label=1;case 1:return l.trys.push([1,3,,5]),[4,this.fetchRequest(e,a,!0)];case 2:if(!(s=l.sent()))throw"fetchRequest failed";if(o=s.sessionId)return this.sessionId=o,w.debug("AdobeConcurrencyMonitorV2.createSession sessionId:",o),[2,o];throw u=s.status,c=s.json,{status:u,json:c};case 3:return d=l.sent(),w.error("AdobeConcurrencyMonitorV2.createSession error: ",d),[4,this.handleError(d,!1)];case 4:return[2,l.sent()];case 5:return[2]}}))}))},t.prototype.heartbeat=function(){return k(this,void 0,void 0,(function(){var t,e,n,i,r,a,s;return C(this,(function(o){switch(o.label){case 0:if(!(t=this.sessionId))return[2];w.debug("AdobeConcurrencyMonitorV2.heartbeat",t),e=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+t,n={method:"POST",headers:this.requestHeaders},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchRequest(e,n,!1)];case 2:if(!(i=o.sent()))throw"fetchRequest failed";if(i.error)throw r=i.status,a=i.json,{status:r,json:a};return this.scheduleHeartbeat(),[3,4];case 3:return s=o.sent(),w.error("AdobeConcurrencyMonitorV2.heartbeat error: ",s),[2,this.handleError(s,!0)];case 4:return[2]}}))}))},t.prototype.scheduleHeartbeat=function(){var t=this;w.debug("AdobeConcurrencyMonitorV2.scheduleHeartbeat"),clearTimeout(this.heartbeatIntervalId),this.heartbeatIntervalId=window.setTimeout((function(){t.heartbeat()}),45e3)},t.prototype.fetchRequest=function(t,e,n){return k(this,void 0,void 0,(function(){var i,r,a,s,o;return C(this,(function(u){switch(u.label){case 0:return u.trys.push([0,4,,7]),[4,T(t,e)];case 1:return i=u.sent(),(r=i.status)>=200&&r<300?[3,3]:[4,i.clone().json().catch((function(){return!!i.text()||null}))];case 2:return o=u.sent(),[2,{status:r,json:o,error:!0}];case 3:return a=void 0,n&&(a=i.headers.get("location").trim()),[2,{sessionId:a,status:r,error:!1}];case 4:return s=u.sent(),console.error("AdobeCM fetchRequest: "+s),s&&409===s.status&&"function"==typeof s.json?[4,s.json()]:[3,6];case 5:return[2,{status:409,json:o=u.sent(),error:!0}];case 6:return[2,s];case 7:return[2]}}))}))},t.prototype.terminateSession=function(){return k(this,void 0,void 0,(function(){var t,e,n,i,r;return C(this,(function(a){switch(a.label){case 0:if(!(t=this.sessionId))return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,T(e=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+t,{method:"DELETE",headers:this.requestHeaders})];case 2:if(n=a.sent(),!((i=n.status)>=200&&i<300))throw new Error("Error - url: "+e+", status: "+i);return[3,4];case 3:return r=a.sent(),console.error("AdobeCM TerminateSession "+r),[3,4];case 4:return[2]}}))}))},t.prototype.handleError=function(t,e){w.debug("AdobeConcurrencyMonitorV2.handleError",t);var n=t.status,i=t.json;switch(n){case 400:return this.handleError400_(i);case 409:return this.handleError409_(i,e);case 410:return this.handleError410_(i,e)}},t.prototype.handleError400_=function(e){return k(this,void 0,void 0,(function(){var n,i;return C(this,(function(r){switch(r.label){case 0:return n=e&&e.obligations||[],!!n.find((function(t){return"logout"===t.action||"refresh"===t.action}))?[4,t.fetchMetadataKeys(this.applicationId,this.serviceUrl)]:[3,2];case 1:if(r.sent(),i=this.metadata,Object.keys(i).length>=this.metadataKeys.length)return[2,this.start()];r.label=2;case 2:return[2,null]}}))}))},t.prototype.handleError409_=function(t,e){try{var n=(t&&t.associatedAdvice||[]).find((function(t){return"rule-violation"===t.type}));if(n){var i=n.message,r=this.messages[i]||i,a=new Error(r),s=!!(t.obligations||[]).find((function(t){return"logout"===t.action}));if(w.debug("AdobeConcurrencyMonitorV2.handleError",409,a,s),!e)throw a;this.onError(a,s)}}catch(a){throw w.debug("AdobeConcurrencyMonitorV2.handleError409_: "+a),a}return null},t.prototype.handleError410_=function(t,e){if(!t)return this.start();try{var n=(t&&t.associatedAdvice||[]).find((function(t){return"remote-termination"===t.type}));if(n){var i=n.message,r=this.messages[i]||i,a=new Error(r),s=!!t.obligations.find((function(t){return"logout"===t.action}));if(w.debug("AdobeConcurrencyMonitorV2.handleError",410,a,s),!e)throw a;this.onError(a,s)}}catch(a){throw w.debug("AdobeConcurrencyMonitorV2.handleError410_: "+a),a}return null},t.prototype.getMetadata=function(){var t=this;return this.metadataKeys.reduce((function(e,n){return e[n]=t.metadata[n],e}),{})},t.prototype.onError=function(t,e){w.debug("AdobeConcurrencyMonitor.onError"),w.debug("error: "+t),w.debug("shouldLogout: "+e)},t}();function Z(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,Z)}function $(){}!function(t){t.abc="abc",t.abcNews="abcnews",t.abcNewsLive="abcnewslive",t.abcOtv="abcotv",t.disney="dch",t.disneyJr="djr",t.disneyXD="dxd",t.disneyNow="dnow",t.espn="espn",t.espnFantasy="espnFantasy",t.oscar="oscar",t.freeform="ff",t.foxLatam="foxlatam",t.fxNow="fxnow",t.fx="fx",t.fxm="fxm",t.fxx="fxx",t.natGeoTV="natgeotv",t.natGeo="natgeo",t.natGeoWild="natgeowild",t.natgeoBrasil="natgeobrasil",t.unknown="000"}(j||(j={})),$.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var i=this;function r(){i.off(t,r),e.apply(n,arguments)}return r._=e,this.on(t,r,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var a=0,s=i.length;a<s;a++)i[a].fn!==e&&i[a].fn._!==e&&r.push(i[a]);return r.length?n[t]=r:delete n[t],this}};var tt=$,et=$;tt.TinyEmitter=et;var nt=function(t){u(n,t);var e=h(n);function n(){return i(this,n),e.apply(this,arguments)}return a(n,[{key:"getConfiguration",value:function(t,e){return{}}}]),n}(tt),it=!1;try{it="caches"in self}catch(t){}var rt="UPDATED",at=function(t){u(r,t);var e=h(r);function r(){var t;if(i(this,r),(t=e.call(this))._bootstrap=null,t._cache=null,it)caches.open("watchsdk-cache").then((function(e){t._cache=e,e&&e.match("bootstrap").then((function(t){return t&&t.json()})).then((function(e){e&&null===t._bootstrap&&(t._bootstrap=e)}))}));else{var n=localStorage.getItem("BootstrapManager.bootstrap");try{var a=JSON.parse(U.stringify(N.parse(n)));t._bootstrap=a}catch(e){try{var s=JSON.parse(n);t._bootstrap=s}catch(t){}}}return t}return a(r,[{key:"bootstrap",get:function(){return this._bootstrap}},{key:"update",value:function(t){var e=this;return T(t).then((function(t){return t.json()})).then((function(t){if(w.debug("BootstrapManager.update() ".concat(JSON.stringify(t,null,2))),e._bootstrap=t,e._cache&&e._cache.put("bootstrap",new Response(JSON.stringify(t),{headers:{"Content-Type":"application/json"}})),!it){var n=N.stringify(U.parse(JSON.stringify(t)));localStorage.setItem("BootstrapManager.bootstrap",n)}e.emit(rt,e._bootstrap)}))}},{key:"getConfiguration",value:function(t,e){var i=this.bootstrap,r=i&&i[t]||{};if(e){var a=Object.keys(r).filter((function(t){return-1!==Object.keys(e).indexOf(t)})).reduce((function(t,e){return n(n({},t),{},s({},e,r[e]))}),{});r=n(n({},e),a)}return r}}]),r}(nt);at.shared=new at;var st,ot=new function t(e,n,r,a){i(this,t),this.enabled=e,this.serviceUrl=n,this.applicationId=null,this.applications=r,this.messages=a}(!0,"https://web.archive.org/web/20220907123413/https://streams.adobeprimetime.com/v2",{chromecast:{applicationId:"4c6fd925-7d06-4dbd-9edb-720962619882"},appletv:{applicationId:"eebe77ee-3064-4b4a-b89b-fef248a474be"},samsungtv:{applicationId:"0e3d9128-cdf7-4464-9952-55434ead1e8e"},web:{applicationId:"3bfbbbdf-be8e-40be-9540-97a73469ada2"},ps4:{applicationId:"41e7539c-d38f-4c20-856a-8db2de060287"},comcastflex:{applicationId:"8c1ffe19-f278-4ace-8fc4-833d0ce5c638"}},{}),ut="https://web.archive.org/web/20220907123413/https://a.espncdn.com/connected-devices/app-configurations/espn-js-sdk-2.0.config.json",ct={appletv:"dniqxcl2cnjuzgl04vuek1mm",chromecast:"1q86jvqka85r41w7daunp5ipgb",comcastflex:"flex-web-gk2lbqnmoddq1cjz4c7idqeka",comcastx1:"x1-web_ek3rjw4nlqxm1fo1a76xlwivr",comcastxclass:"watch-sdk-xclass_fparjzlo4iam15wy3pgpigulv",ps4:"kbjoe0y9awb41guc2nzey04ji",samsungtv:"csrf56z30hke1aozrm00ad50g",web:"uiqlbgzdwuru14v627vdusswb"},dt=function(t){var e=at.shared.getConfiguration("adobeCM",ot);if(!1!==e.enabled){var n=e.applications&&e.applications[t],i=e.applicationId||n&&n.applicationId,r=e.serviceUrl;X.fetchMetadataKeys(i,r)}},lt=function(){function t(){i(this,t)}return a(t,null,[{key:"init",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.partner=e,t.platform=n,t.version=i,t.deviceId=t.deviceId||Z(),w.debug(this.toString());var a=r&&r.bootstrapUrl||ut;at.shared.update(a).finally((function(){dt(t.platform)}))}},{key:"partner",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.partner")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.partner",t)}},{key:"platform",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.platform")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.platform",t)}},{key:"version",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.version")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.version",t)}},{key:"deviceId",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.deviceId")},set:function(t){localStorage.setItem("ESPNWatchSDK.Client.deviceId",t)}},{key:"toString",value:function(){return"<WatchSDK.Client partner:".concat(t.partner,", platform:").concat(t.platform,", deviceId:").concat(t.deviceId,">")}},{key:"apiKey",get:function(){return at.shared.getConfiguration("shield",{apiKeys:ct}).apiKeys[t.platform]||"mbmhfdgflphg14wss50rny3ct"}}]),t}();!function(t){t[t.all=0]="all",t[t.linearPlayback=1]="linearPlayback"}(st||(st={}));var ht,pt=st;!function(t){t.linear="linear",t.event="event"}(ht||(ht={}));var ft,vt=ht;!function(t){t.stitchedPreroll="stitchedPreroll"}(ft||(ft={}));var yt,gt=ft;!function(t){t.live="live",t.onDemand="onDemand"}(yt||(yt={}));var mt,bt=yt;!function(t){t.nielsen="nielsen",t.comscore="comscore",t.conviva="conviva",t.heartbeats="heartbeats"}(mt||(mt={}));var Pt,wt=mt;!function(t){t.shortform="shortform",t.longform="longform"}(Pt||(Pt={}));var At,It=Pt;!function(t){t.audio="audio",t.video="video"}(At||(At={}));var Tt,St=At;!function(t){t.pluto="pluto",t.graphQL="graphQL",t.cfa="cfa",t.itemFeed="itemFeed"}(Tt||(Tt={}));var _t,Et=Tt;!function(t){t.open="OPEN",t.direct="DIRECT",t.mvpd="MVPD",t.isp="ISP",t.none="NONE"}(_t||(_t={}));var kt,Ct=_t;!function(t){t.none="none",t.startSession="startSession",t.bam="bam",t.shield="shield",t.entitlement="entitlement"}(kt||(kt={}));var Ot=kt,Mt=function(){function t(t,e,n,i,r,a,s,o){this.url=t,this.type=e,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return t.fromObject=function(e){if(!e)return null;var n=e.url,i=e.type,r=e.hasEspnId3Heartbeats,a=e.hasNielsenWatermarks,s=e.hasPassThroughAds,o=e.commercialReplacement,u=e.startSessionUrl,c=e.variant;return new t(n,Ot[i],r,a,s,o,u,c)},t}(),Dt=function(){function t(t,e,n,i){this.id=t,this.type=e,this.name=n,this.resource=i}return t.fromObject=function(e){if(!e)return null;var n=vt[e.type];return new t(e.id,n,e.name,e.resource)},t}(),Nt=function(){function t(t){this.url=t}return t.fromObject=function(e){return e&&e.url?new t(e.url):null},t}(),Ut=function(){function t(t){this.name=t}return Object.defineProperty(t.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),t.fromObject=function(e){return e?new t(e.name):null},t}(),Lt=function(){function t(t,e,n,i,r){this.id=t,this.title=e,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=pt.all,this.images=[],this.type=St.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(t.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===vt.linear},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLive",{get:function(){return this.streamType===bt.live},enumerable:!1,configurable:!0}),t.fromObject=function(e){var n=Mt.fromObject(e.source),i=new t(e.id,e.title,e.duration,e.language,n);return i.airDate=e.airDate,i.apiSource=e.apiSource,i.authenticationTypes=e.authenticationTypes,i.description=e.description,i.images=(e.images||[]).map((function(t){return Nt.fromObject(t)})),i.mrss=e.mrss,i.network=Dt.fromObject(e.network),i.seekInSeconds=e.seekInSeconds,i.streamType=bt[e.streamType],i.supportedMediaCommands=e.supportedMediaCommands,i.tracking=e.tracking,i.references=e.references,i.packages=(e.packages||[]).map((function(t){return Ut.fromObject(t)})),i.tier=e.tier,i.type=St[e.type],i.entityType=It[e.entityType],i.isSyndicatable=e.isSyndicatable,i.brand=e.brand,i.adUnitId=e.adUnitId,i.cues=e.cues,i.show=e.show,i.adTarget=e.adTarget,i.availableDate=e.availableDate,i.episodeNumber=e.episodeNumber,i.locale=e.locale,i.seasonNumber=e.seasonNumber,i.tmsid=e.tmsid,i.videoShowGenre=e.videoShowGenre,i},t.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},t}();var jt,Rt=function(){function t(t){var e=function(t){var e=t.split("?")[1],n={};if(e)for(var i=e.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(t);if(this.original=t,this.id=e.videoID||e.playID||e.clip||e.externalId,t.match("sportscenter")){this.gameId=e.playGameID,this.channel=e.playChannel,this.simulcastAiringId=e.simulcastAiringId;var n=parseInt(e.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=e.eventId}else t.match("abcnews")&&(this.channel=e.playChannel,this.id=e.videoID||e.id);this.source=e["x-source"],e.videoID?this.entityType=It.shortform:this.entityType=It.longform,this.type=St.video}return t.prototype.toString=function(t){return t==Et.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},t.identifierStringForNetwork=function(t,e){switch(e){case Et.cfa:return"natgeo://playVideo?videoID="+t;case Et.itemFeed:return"abcnews://playVideo?playChannel="+t;case Et.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+t}},t}();function xt(t,e,n,i){if(!e)return{};var r,a,s,o=null;t===jt.natGeo?o=function(t){if(!t)return{};var e={},n=t.id,i=t.title,r=t.duration;return e.c_video_id_code=n,e.c_a_media_airdate="unknown",e.c_a_media_daypart="daytime",e.c_a_media_digitaldate="unknown",e.c_a_media_episode="none",e.c_a_media_feed="natgeo live",e.c_a_media_format="vod",e.c_a_media_genre="none",e.c_a_media_network="natgeo",e.c_a_media_originator="natgeo",e.c_a_media_pass_auth="none",e.c_a_media_pass_mvpd="none",e.c_a_media_rating="none",e.c_a_media_season="none",e.c_a_media_show=i,e.c_a_media_streamtype=At.video,e.c_a_media_length=r,e}(e):(r=function(t,e,n){if(!t)return{};var i=t.duration,r=t.id,a=t.league,s=t.name,o=t.network,u=t.program,c=t.sport,d=t.startDateTime,l=t.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=l&&l.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",e===It.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(u&&u.code||"")+(c&&c.code||""),d){var f=new Date(d);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=l&&l.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return e===It.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(e,n,i),a=function(t,e){if(!t)return{};var n=t.id,i=t.duration,r=t.name,a=t.league,s=t.startDateTime,o=t.network,u=t.sport,c=t.status,d=t.tracking,l={};if(e===It.longform)l.ns_st_cl=0,l.ns_st_ct="vc",!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?(l.ns_st_cl=i,l.ns_st_ct="vc12",l.ns_st_pr="VOD",l.ns_st_ep=r):(l.ns_st_cl=0,l.ns_st_ct="vc13",l.ns_st_pr=r,l.ns_st_ep="*null"),l.c3="WATCHESPNLIVE",l.c6=a&&a.name?a||"No league":u&&u.code||"No Sport";else{l.ns_st_cl=i,l.ns_st_ct="vc11",l.ns_st_pr="VOD",l.ns_st_ep=r;var h=d||{},p=h.sportName,f=h.leagueName;l.c3="vod",l.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(l.ns_st_ti="*null",l.ns_st_ia="*null",l.ns_st_ce="*null",l.ns_st_ci=n,s){var v=new Date(s);l.ns_st_ddt=v.toDateString(),l.ns_st_tdt=v.toDateString()}return l.ns_st_st=o?o.id:"*null",l.ns_st_en="*null",l.ns_st_cn="1",l.ns_st_pn="1",l.ns_st_tp="1",l.ns_st_pu="ESPN",l.ns_st_cu="none",l.ns_st_ad="0",l.ns_st_ge="Sports",l}(e,n),s=function(t,e,n){if(!t)return{};var i=t.name,r=t.id,a=t.airingId,s=t.eventId,o=t.duration,u=t.network,c=t.status,d=t.sport,l=t.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),u&&(h.network=u.id),e===It.shortform?h.assetType="clip":!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return u&&u.type===vt.linear&&"live"===h.assetType&&(p=u.id),h.sport=d&&d.name||"Not Applicable",h.league=l&&l.name||"Not Applicable",h.appBrand=jt.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(e,n,i),o=function(t,e){if(!t)return{};var n=t.duration,i=t.airingId,r=t.network,a=t.status,s=t.sport,o=t.league,u=t.name,c=t.program,d=t.startDateTime,l=t.tracking,h=t.originalPublishDate,p=t.expirationDate,f=t.lastModifiedDate,v=t.ad,y=t.coverageType,g=t.brands,m={};if(m.ContentDuration=n,e===It.longform){if(m.CMSID=l&&l.name||u,m.isFullEpisode="y",i&&(m.AiringID=i),r&&(m.NetworkName=r.id,m.Channel=r.id),a&&(m.VideoType="REPLAY"===a?"replay":"live"),m.Sport=s&&s.name||"Not Applicable",m.SportCode=s&&s.code||"Not Applicable",m.League=o&&o.name||"Not Applicable",c&&c.code&&c.categoryCode?m.ProgramCode=c.categoryCode+c.code:m.ProgramCode="Not Applicable",m.IsStudio=c&&c.isStudio||"Not Applicable",d){var b=new Date(d);m.AirDate=b.toDateString(),m.AirTime=b.toTimeString()}if(Array.isArray(g)&&g.length){var P=g[0],w=P.id,A=P.name,I=P.type;m["a.media.asset"]=w,m["a.media.show"]=A,m["a.media.genre"]=I}}else if(e===It.shortform){if(m.isFullEpisode="n",m.VideoType="vod",m.Sport=l&&l.sportName||"Not Applicable",m.League=l&&l.leagueName||"Not Applicable",m.ShowCode=v&&v.bundle||"Not Applicable",l&&l.name&&(m.CMSID=l.name),h){b=new Date(h);m.PublishDate=b.toISOString().substring(0,10),m.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);m.ExpirationDate=b.toISOString()}if(f){b=new Date(f);m.DateLastModified=b.toISOString()}y&&(m.VideoTypeDetail=y)}return m}(e,n));var u={};return u[wt.nielsen]=r,u[wt.comscore]=a,u[wt.conviva]=s,u[wt.heartbeats]=o,u}function Bt(t,e,n){return t.sort((function(t,e){var n="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2,i="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(t,n){var i=t.network&&t.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=e.indexOf(i),s=e.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(t,e){var i=t.language===n?0:1,r=e.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(t){t.abc="abc",t.abcNews="abcnews",t.abcNewsLive="abcnewslive",t.abcOtv="abcotv",t.cricinfo="cricinfo",t.disney="dch",t.disneyJr="djr",t.disneyXD="dxd",t.disneyNow="dnow",t.espn="espn",t.espnFantasy="espnFantasy",t.fiveThirtyEight="fivethirtyeight",t.foxLatam="foxlatam",t.freeform="ff",t.fxNow="fxnow",t.fx="fx",t.fxm="fxm",t.fxx="fxx",t.oscar="oscar",t.marvel="marvel",t.natGeoTV="ngtv",t.natGeo="ngc",t.natGeoWild="ngw",t.natgeoBrasil="natgeobrasil",t.theUndefeated="theundefeated",t.unknown="000"}(jt||(jt={}));var Ft=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Ht=function(t,e,n,i){t==Et.graphQL?(this.serviceUrl=e||"https://web.archive.org/web/20220907123413/https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||Ft):t==Et.cfa?this.serviceUrl=e||"https://web.archive.org/web/20220907123413/https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":t===Et.itemFeed&&(this.serviceUrl=e||"https://web.archive.org/web/20220907123413/https://abcnews.go.com/video/itemfeed")},zt=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!1,configurable:!0}),t.prototype.getMediaItems=function(e,n){return k(this,void 0,void 0,(function(){return C(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return k(this,void 0,void 0,(function(){var r,a,s,o,u,c;return C(this,(function(d){switch(d.label){case 0:return r=e.map((function(t){return new Rt(t)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,I.all(r.map((function(e){return t.getPromiseMediaItems(e,a,s,n)})))];case 1:return u=d.sent(),(c=u.filter((function(t){return!(t instanceof Error)&&t instanceof Lt}))).length?[2,Bt(c,o,navigator.language)]:[2,null]}}))}))},t.getPromiseMediaItems=function(e,n,i,r){return k(this,void 0,void 0,(function(){var a,s,o,u,c,d,l,h,p,f,v,y;return C(this,(function(g){switch(g.label){case 0:a=function(t,e,n,i){var r="",a="",s="",o=i||"US";return t.entityType===It.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+t.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",t.id?a='id:"'+t.id+'"':t.channel?(r="airings",a='networks:["'+t.channel+'"],type:LIVE'):t.gameId&&(r="airings",a='eventId:"'+(t.eventId||t.gameId)+'"')),e+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(e,n,i,r.countryCode),g.label=1;case 1:return g.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,g.sent().json()];case 3:if(s=g.sent(),o=s.data.airing,(u=s.data.airings)&&(c=e.simulcastAiringId?function(t){return t.simulcastAiringId===e.simulcastAiringId}:function(){return!0},o=u.filter(c)[0]),d=s.data.VOD,!(l=o||d))throw new Error("No results found.");if(h=function(t,e,n){var i=t.id,r=t.name,a=t.description,s=t.duration,o=t.image,u=t.eventId,c=t.requiresLinearPlayback,d=t.authTypes,l=t.source,h=t.prerollSource,p=t.packages,f=t.language,v=t.mrss,y=t.seekInSeconds,g=t.tracking,m=t.simulcastAiringId,b=t.network,P=t.status,w=t.cerebroId,A=t.syndicatable,I=P&&("LIVE"===P.toUpperCase()||"OVER"===P.toUpperCase())?bt.live:bt.onDemand,T=function(t){switch(t){case"NONE":return Ot.none;case"START_SESSION":return Ot.startSession;case"BAM":return Ot.bam;case"SHIELD":return Ot.shield}}(l.authorizationType),S=new Mt(l.url,T,l.hasEspnId3Heartbeats,l.hasNielsenWatermarks,l.hasPassThroughAds,l.commercialReplacement,l.startSessionUrl);n&&n.sourceVariant===gt.stitchedPreroll&&h&&((S=new Mt(h.url,Ot.none)).variant=gt.stitchedPreroll);var _=c?pt.linearPlayback:pt.all,E=g&&g.trackingId||i,k=new Lt(i,r,s,f,S);if(k.authenticationTypes=d.map((function(t){switch(t){case"DIRECT":return Ct.direct;case"OPEN":return Ct.open;case"MVPD":return Ct.mvpd;case"ISP":return Ct.isp;default:return Ct.none}})),k.description=a,k.isSyndicatable=A,o&&o.url&&k.images.push(new Nt(o.url)),k.mrss=v,b){var C="linear"===b.type?vt.linear:vt.event;k.network=new Dt(b.id,C,b.name,b.adobeResource)}return k.seekInSeconds=y,k.streamType=I,k.supportedMediaCommands=_,k.brand=k.brand?k.brand:"espn",k.tracking=xt(k.brand,t,e,S),k.references={eventId:u,simulcastAiringId:m,trackingId:E,cerebroId:w},k.type=St.video,k.entityType=e,k.apiSource=Et.graphQL,k.packages=(p||[]).map((function(t){return new Ut(t.name)})),k}(l,e.entityType,r),e.resumeTime&&(h.seekInSeconds=e.resumeTime),!h.source.url){if(p="OVER"===l.status.toUpperCase(),f=l.network&&l.network.type===vt.linear,v=l.network&&l.network.id,p&&f&&v)return[2,t.retryGetMediaItems(v,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return y=g.sent(),w.warn("Failed to retrieve MediaItem from GraphQL: "+y),[2,null];case 5:return[2]}}))}))},t.retryGetMediaItems=function(e,n,i,r){return k(this,void 0,void 0,(function(){var a,s,o,u;return C(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),a=Rt.identifierStringForNetwork(e,Et.graphQL),s=new Rt(a),[4,t.getPromiseMediaItems(s,n,i,r)];case 1:if((o=c.sent())&&o instanceof Lt==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+e);case 2:return u=c.sent(),w.warn("MediaItem is over and retry failed: "+u),[2,null];case 3:return[2]}}))}))},t.defaultConfiguration=new Ht(Et.graphQL),t}();var Kt=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!1,configurable:!0}),t.prototype.getMediaItems=function(e,n){return k(this,void 0,void 0,(function(){return C(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return k(this,void 0,void 0,(function(){var n,r;return C(this,(function(a){switch(a.label){case 0:return n=e.map((function(t){return new Rt(t)})),r=i.serviceUrl,[4,I.all(n.map((function(e){return t.getPromiseMediaItem(e,r)})))];case 1:return[2,a.sent().filter((function(t){return!(t instanceof Error)&&t instanceof Lt}))]}}))}))},t.getPromiseMediaItem=function(t,e){return k(this,void 0,void 0,(function(){var n,i,r;return C(this,(function(a){switch(a.label){case 0:n=e.replace("videoID",t.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(t){var e=t.id,n=t.title,i=t.description,r=t.duration,a=t.source,s=t.type,o=t.entityType,u=t.streamType,c=t.authenticationTypes,d=t.language,l=t.network,h=t.brand,p=t.images,f=o,v=a.type,y=new Mt(a.url,v),g=new Lt(e,n,r,d,y);return g.authenticationTypes=c.map((function(t){switch(t){case"DIRECT":return Ct.direct;case"OPEN":return Ct.open;case"MVPD":return Ct.mvpd;case"ISP":return Ct.isp;default:return Ct.none}})),g.description=i,l&&(g.network=new Dt(l.id,l.type,l.name,l.resource)),g.streamType=u,g.brand=h,g.tracking=xt(g.brand,t,f,y),g.images=p,g.type=s,g.entityType=f,g.apiSource=Et.cfa,g}(i)];case 4:return r=a.sent(),w.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},t.defaultConfiguration=new Ht(Et.cfa),t}(),Vt=Object.freeze({}),Gt=Object.freeze({}),qt=Et.itemFeed,Jt={lf:"longform",sf:"shortform",live:"longform"},Yt={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},Wt={name:"abc_news_live",type:"linear"},Qt=["HLS_ALL","PDL_MED","PDL_LOW"];function Xt(t){var e,n,i,r=(t||Vt).channel||Vt,a=r.item||Vt,s=a["media-group"]||Vt,o=s["media-content"]||Gt,u=s["media-title"],c=(function(t){for(var e,n,i=Qt.length,r=t.length,a=0;a<i;a++)for(var s=Qt[a],o=0;o<r;o++){var u=t[o];if((null===(n=null===(e=null==u?void 0:u["media-category"])||void 0===e?void 0:e["@attributes"])||void 0===n?void 0:n.label)===s)return u}}(o)||Vt)["@attributes"]||Vt,d=(s["media-thumbnail"]||Vt)["@attributes"]||Vt,l=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,v=a.link,y=c.duration,g=c.url,m=c.medium,b=(a.omniture||Vt).channel||"",P=O(String(b).split(":"),1)[0],w=Yt[b]||Yt[void 0===P?"abcn":P]||"abcnews",A="vod"===p,I="live"===p,T=Jt[a.videoContentType]||(A?"shortform":"longform"),S=u||h,_=r.language||"en";try{n=(e=O(new Date(f).toISOString().split("T"),2))[0],i=e[1]}catch(t){console.warn(t)}var k="akamai live stream"!==a.mediatype||A?{}:E(E({},Wt),{id:l}),C={id:l,apiSource:qt,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:k,show:{title:S},title:S,duration:y,language:_,source:{url:g,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:w,type:"video"===m?"video":"audio",entityType:T,streamType:I?"live":"onDemand",images:d?[{url:d.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:l},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:l,program:S,title:S},conviva:{assetName:h,duration:y,streamURL:g,custom:{contentId:l,assetType:A?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:y,isFullEpisode:"shortform"===T||I?"n":"y",VideoType:p,CMSID:S,PublishDate:n,PublishTime:i}},webHref:v};return Lt.fromObject(C)}var Zt=new RegExp("%[a-f0-9]{2}","gi"),$t=new RegExp("(%[a-f0-9]{2})+","gi");function te(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var n=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],te(n),te(i))}function ee(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(Zt),n=1;n<e.length;n++)e=(t=te(e,n).join("")).match(Zt);return t}}var ne,ie=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"","%FF%FE":""},n=$t.exec(t);n;){try{e[n[0]]=decodeURIComponent(n[0])}catch(t){var i=ee(n[0]);i!==n[0]&&(e[n[0]]=i)}n=$t.exec(t)}e["%C2"]="";for(var r=Object.keys(e),a=0;a<r.length;a++){var s=r[a];t=t.replace(new RegExp(s,"g"),e[s])}return t}(t)}},re=(t,e)=>{if("string"!=typeof t||"string"!=typeof e)throw new TypeError("Expected the arguments to be of type `string`");if(""===e)return[t];const n=t.indexOf(e);return-1===n?[t]:[t.slice(0,n),t.slice(n+e.length)]},ae=function(t,e){for(var n={},i=Object.keys(t),r=Array.isArray(e),a=0;a<i.length;a++){var s=i[a],o=t[s];(r?-1!==e.indexOf(s):e(s,o,t))&&(n[s]=o)}return n},se=P((function(t,e){function n(t){if("string"!=typeof t||1!==t.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(t,e){return e.encode?e.strict?encodeURIComponent(t).replace(/[!'()*]/g,t=>"%"+t.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(t):t}function r(t,e){return e.decode?ie(t):t}function a(t){const e=t.indexOf("#");return-1!==e&&(t=t.slice(0,e)),t}function s(t){const e=(t=a(t)).indexOf("?");return-1===e?"":t.slice(e+1)}function o(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&"string"==typeof t&&""!==t.trim()?t=Number(t):!e.parseBooleans||null===t||"true"!==t.toLowerCase()&&"false"!==t.toLowerCase()||(t="true"===t.toLowerCase()),t}function u(t,e){n((e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e)).arrayFormatSeparator);const i=function(t){let e;switch(t.arrayFormat){case"index":return(t,n,i)=>{e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===i[t]&&(i[t]={}),i[t][e[1]]=n):i[t]=n};case"bracket":return(t,n,i)=>{e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==i[t]?i[t]=[].concat(i[t],n):i[t]=[n]:i[t]=n};case"comma":case"separator":return(e,n,i)=>{const a="string"==typeof n&&n.includes(t.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,t).includes(t.arrayFormatSeparator);n=s?r(n,t):n;const o=a||s?n.split(t.arrayFormatSeparator).map(e=>r(e,t)):null===n?n:r(n,t);i[e]=o};default:return(t,e,n)=>{void 0!==n[t]?n[t]=[].concat(n[t],e):n[t]=e}}}(e),a=Object.create(null);if("string"!=typeof t)return a;if(!(t=t.trim().replace(/^[?#&]/,"")))return a;for(const n of t.split("&")){if(""===n)continue;let[t,s]=re(e.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(e.arrayFormat)?s:r(s,e),i(r(t,e),s,a)}for(const t of Object.keys(a)){const n=a[t];if("object"==typeof n&&null!==n)for(const t of Object.keys(n))n[t]=o(n[t],e);else a[t]=o(n,e)}return!1===e.sort?a:(!0===e.sort?Object.keys(a).sort():Object.keys(a).sort(e.sort)).reduce((t,e)=>{const n=a[e];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?t[e]=function t(e){return Array.isArray(e)?e.sort():"object"==typeof e?t(Object.keys(e)).sort((t,e)=>Number(t)-Number(e)).map(t=>e[t]):e}(n):t[e]=n,t},Object.create(null))}e.extract=s,e.parse=u,e.stringify=(t,e)=>{if(!t)return"";n((e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e)).arrayFormatSeparator);const r=n=>e.skipNull&&null==t[n]||e.skipEmptyString&&""===t[n],a=function(t){switch(t.arrayFormat){case"index":return e=>(n,r)=>{const a=n.length;return void 0===r||t.skipNull&&null===r||t.skipEmptyString&&""===r?n:null===r?[...n,[i(e,t),"[",a,"]"].join("")]:[...n,[i(e,t),"[",i(a,t),"]=",i(r,t)].join("")]};case"bracket":return e=>(n,r)=>void 0===r||t.skipNull&&null===r||t.skipEmptyString&&""===r?n:null===r?[...n,[i(e,t),"[]"].join("")]:[...n,[i(e,t),"[]=",i(r,t)].join("")];case"comma":case"separator":return e=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(e,t),"=",i(r,t)].join("")]:[[n,i(r,t)].join(t.arrayFormatSeparator)];default:return e=>(n,r)=>void 0===r||t.skipNull&&null===r||t.skipEmptyString&&""===r?n:null===r?[...n,i(e,t)]:[...n,[i(e,t),"=",i(r,t)].join("")]}}(e),s={};for(const e of Object.keys(t))r(e)||(s[e]=t[e]);const o=Object.keys(s);return!1!==e.sort&&o.sort(e.sort),o.map(n=>{const r=t[n];return void 0===r?"":null===r?i(n,e):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,e)+"="+i(r,e)}).filter(t=>t.length>0).join("&")},e.parseUrl=(t,e)=>{e=Object.assign({decode:!0},e);const[n,i]=re(t,"#");return Object.assign({url:n.split("?")[0]||"",query:u(s(t),e)},e&&e.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,e)}:{})},e.stringifyUrl=(t,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(t.url).split("?")[0]||"",s=e.extract(t.url),o=e.parse(s,{sort:!1}),u=Object.assign(o,t.query);let c=e.stringify(u,n);c&&(c="?"+c);let d=function(t){let e="";const n=t.indexOf("#");return-1!==n&&(e=t.slice(n)),e}(t.url);return t.fragmentIdentifier&&(d="#"+i(t.fragmentIdentifier,n)),`${r}${c}${d}`},e.pick=(t,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=e.parseUrl(t,i);return e.stringifyUrl({url:r,query:ae(a,n),fragmentIdentifier:s},i)},e.exclude=(t,n,i)=>{const r=Array.isArray(n)?t=>!n.includes(t):(t,e)=>!n(t,e);return e.pick(t,r,i)}})),oe=(se.extract,se.parse,se.stringify,se.parseUrl,se.stringifyUrl,se.pick,se.exclude,function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!1,configurable:!0}),t.prototype.getMediaItems=function(e,n){return k(this,void 0,void 0,(function(){return C(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return k(this,void 0,void 0,(function(){var n,r;return C(this,(function(a){switch(a.label){case 0:return n=e.map((function(t){return new Rt(t)})),r=i.serviceUrl,[4,I.all(n.map((function(e){return t.getPromiseMediaItem(e,r)})))];case 1:return[2,a.sent().filter((function(t){return!(t instanceof Error)&&t instanceof Lt}))]}}))}))},t.getPromiseMediaItem=function(t,e){return k(this,void 0,void 0,(function(){var n,i,r;return C(this,(function(a){switch(a.label){case 0:n=se.stringify({id:t.id||t.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(e+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,Xt(i)];case 4:return r=a.sent(),w.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},t.defaultConfiguration=new Ht(Et.itemFeed),t}()),ue=function(){function t(){}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!1,configurable:!0}),t.prototype.getMediaItems=function(t,e){return k(this,void 0,void 0,(function(){var n,i=this;return C(this,(function(r){switch(r.label){case 0:return n=e||{sourceVariant:null},[4,I.all(t.map((function(t){return k(i,void 0,void 0,(function(){var e,i,r,a;return C(this,(function(s){switch(s.label){case 0:e=t.match("natgeo")?Kt:t.match("abcnews")?oe:zt,(r=new e).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([t],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))},t}(),ce=new function t(e){i(this,t),this.intervals=e}({intervals:{DEFAULT:2,ESPN_PLUS:0,ESPN_PLUS_MLB:0,ESPN_PLUS_NHL:0}}),de=function(){function t(){i(this,t),this.configuration=ce}return a(t,[{key:"configuration",get:function(){return this._configuration},set:function(t){this._configuration=t}},{key:"shouldPreroll",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=this.configuration.intervals.DEFAULT||0,r=(n||[]).filter((function(t){return t in e.configuration.intervals})).map((function(t){return e.configuration.intervals[t]}));0===r.length&&r.push(i);var a=Math.min.apply(Math,g(r));return a>0&&t.prerollCount>=a-1}}],[{key:"prerollCount",get:function(){var t=localStorage.getItem("PrerollManager.prerollCount");try{return JSON.parse(t)||0}catch(t){return 0}},set:function(t){localStorage.setItem("PrerollManager.prerollCount",JSON.stringify(t))}}]),t}(),le=function(t){u(n,t);var e=h(n);function n(){return i(this,n),e.apply(this,arguments)}return a(n,[{key:"configuration",get:function(){var t=at.shared.getConfiguration("preRoll",ce);return w.debug("PrerollManager.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){y(c(n.prototype),"configuration",t,this,!0)}}],[{key:"prerollCount",get:function(){return de.prerollCount},set:function(t){de.prerollCount=t}}]),n}(de),he=function(t){u(n,t);var e=h(n);function n(){return i(this,n),e.apply(this,arguments)}return a(n,[{key:"name",get:function(){return this.title}},{key:"eventId",get:function(){return this.references.eventId}},{key:"trackingId",get:function(){return this.references.trackingId}},{key:"simulcastAiringId",get:function(){return this.references.simulcastAiringId}},{key:"airingId",get:function(){return this.id}},{key:"requiresLinearPlayback",get:function(){return this.supportedMediaCommands===pt.linearPlayback}},{key:"convivaContentMetadata",get:function(){return this.tracking&&this.tracking[wt.conviva]}},{key:"trackingInfo",get:function(){return this.tracking&&this.tracking[wt.heartbeats]}},{key:"nielsenMetadata",get:function(){return this.tracking&&this.tracking[wt.nielsen]}}],[{key:"fromObject",value:function(t){var e=new n(t.id,t.title,t.duration,t.language,t.source);if(o(e,Lt.fromObject(t)),e.source){var i=function(t){switch(t){case Ot.bam:return"BAM";case Ot.none:return"NONE";case Ot.shield:return"SHIELD";case Ot.startSession:return"START_SESSION";default:return null}}(e.source.type);e.source.authorizationType=i}return e}}]),n}(Lt),pe=function(t){u(n,t);var e=h(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et.graphQL;return i(this,n),(t=e.call(this)).prerollManager=new le,t.apiSource=r,t.configurationKey=r===Et.graphQL?"graphqlapi":null,t.configuration=new Ht(r),t}return a(n,[{key:"configuration",get:function(){var t=at.shared.getConfiguration(this.configurationKey,n.defaultConfiguration);return w.debug("MediaItemAPI.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){y(c(n.prototype),"configuration",t,this,!0)}},{key:"getMediaItems",value:function(t,e){var i=e||{},r=i.entitlements||[];return this.prerollManager.shouldPreroll(r)&&(i.sourceVariant=gt.stitchedPreroll),f(c(n.prototype),"getMediaItems",this).call(this,t,i).then((function(t){var e=t||[],n=e.filter((function(t){return t.source.variant===gt.stitchedPreroll})).length;return n>0?le.prerollCount=0:le.prerollCount+=e.length-n,e.map((function(t){return he.fromObject(t)}))}))}}]),n}(ue),fe={device:{advertisingId:"0000-0000-0000-0000-0000",devType:"web"}};!function(t){t.localStorage="LOCAL_STORAGE",t.sessionStorage="SESSION_STORAGE"}(ne||(ne={}));var ve,ye=ne,ge=function(){function t(t,e,n,i){this.id=t,this.name=e,this.logoUrl=n,this.websiteUrl=i}return t.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},t.fromObject=function(e){return new t(e.id,e.name,e.logoUrl,e.websiteUrl)},t}();!function(t){t.token="token",t.tokenType="tokenType",t.resource="resource",t.requestor="requestor",t.fullToken="fullToken",t.zipcode="zipcode",t.mvpd="mvpd"}(ve||(ve={}));var me,be,Pe=function(){function t(t,e,n,i){void 0===i&&(i={}),this.authenticationType=t,this.authenticatedProvider=e,this.authenticatedIdentity=n,this.customData=i}return t.CustomDataKey=ve,t}(),we=function(t,e){this.success=t,this.payload=e};(me=t.AdProvider||(t.AdProvider={})).standard="default",me.googleAdManager="gam",(be=t.AdEnvironment||(t.AdEnvironment={})).standard="default",be.prod="prod",be.development="dev";function Ae(t,e){void 0===e&&(e=4e3);var n="undefined"!=typeof window&&window,i=n&&n.document,r=i&&i.getElementsByTagName&&i.getElementsByTagName("head")[0],a=i&&i.body,s=r||a;return s&&t?new I((function(n,i){var r=document.createElement("script"),a=[],o=null,u=function(){a.forEach((function(t){return t()})),a=null,clearTimeout(o),o=null},c=function(t){u(),n(t)},d=function(t){u(),i(t)};r.type="text/javascript",r.src=t,r.addEventListener("load",c),a.push((function(){return r.removeEventListener("load",c)})),r.addEventListener("error",d),a.push((function(){return r.removeEventListener("error",d)})),o=setTimeout((function(){return d(new Error("Timeout ("+e+") while fetching "+t))}),4e3),s.appendChild(r)})):I.reject()}var Ie,Te,Se,_e=Object.freeze({}),Ee=Object.freeze(""),ke="undefined"!=typeof window&&window,Ce=function(t){ke&&ke.console&&ke.console.error(t)},Oe=function(){return k(this,void 0,void 0,(function(){var t,e,n;return C(this,(function(i){switch(i.label){case 0:if(t=Ie||ke.goog&&ke.goog.pal,e=ke&&ke.bc,t)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Ae("https://web.archive.org/web/20220907123413/https://imasdk.googleapis.com/pal/sdkloader/pal.js")];case 2:return i.sent(),[3,4];case 3:return n=i.sent(),Ce(n),[3,4];case 4:(t=ke.goog&&ke.goog.pal)&&(Ie=t),!e&&ke.bc&&(ke.bc=null),i.label=5;case 5:return[2,t||_e]}}))}))};function Me(t,e,n,i,r){return void 0===e&&(e=3e3),void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===r&&(r=Oe),k(this,void 0,void 0,(function(){var a,s,o,u,c,d,l,h;return C(this,(function(p){switch(p.label){case 0:if(a=i&&Se||Ee)return[3,10];s=void 0,o=void 0,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,r()];case 2:return(u=p.sent())&&(s=u.NonceLoader,o=u.NonceRequest),[3,4];case 3:return c=p.sent(),Ce(c),[3,4];case 4:if(i&&Se||!s||!o)return[3,10];d=void 0,p.label=5;case 5:return p.trys.push([5,7,,8]),Te=!Te||n?new s:Te,l=Object.assign(new o,function(t){var e=O(String(t.videoPlayerSize||"640x480").split("x"),2),n=e[0],i=e[1];return{adWillAutoPlay:t.isAutoplay,adWillPlayMuted:t.isMute,continuousPlayback:"vod"===t.videoDeliveryMethod,descriptionUrl:t.descriptionUrl||Ee,iconsSupported:t.vastIconsSupported,playerType:t.videoPlayerType||Ee,playerVersion:t.videoPlayerVersion||Ee,ppid:t.ppid||t.swid||Ee,videoHeight:parseInt(i,10),videoWidth:parseInt(n,10)}}(t)),[4,Te.loadNonceManager(l)];case 6:return d=p.sent(),[3,8];case 7:return h=p.sent(),Ce(h),[3,8];case 8:return d?[4,d.getNonce()]:[3,10];case 9:(!(a=p.sent())||Number(e)>0&&String(a).length>e)&&(a=Ee),a&&(Se=a),p.label=10;case 10:return[2,a]}}))}))}var De=function(t){return null===t?null:t?"1":"0"},Ne=function(t,e){return null!=t?t:e},Ue=function(){function e(e,n,i,r,a,s,o,u,c,d,l,h,p,f,v,y,g,m,b,P,w,A,I,T,S,_,E,k,C,O,M,D,N,U,L,j,R,x,B,F,H,z,K,V,G,q,J,Y,W,Q,X,Z,$,tt,et,nt,it,rt,at,st,ot,ut,ct,dt,lt,ht,pt,ft,vt){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a="espn"),void 0===s&&(s=null),void 0===o&&(o=null),void 0===u&&(u=null),void 0===c&&(c=null),void 0===d&&(d=null),void 0===l&&(l=null),void 0===h&&(h=null),void 0===p&&(p=null),void 0===f&&(f=null),void 0===v&&(v=null),void 0===y&&(y=null),void 0===g&&(g=!1),void 0===m&&(m=null),void 0===b&&(b=null),void 0===P&&(P=!1),void 0===w&&(w=!1),void 0===A&&(A=null),void 0===I&&(I=null),void 0===T&&(T=null),void 0===S&&(S=null),void 0===_&&(_=null),void 0===E&&(E=null),void 0===k&&(k=null),void 0===C&&(C=null),void 0===O&&(O=!1),void 0===M&&(M=null),void 0===D&&(D=null),void 0===N&&(N=null),void 0===U&&(U=null),void 0===L&&(L=null),void 0===j&&(j=null),void 0===R&&(R=null),void 0===x&&(x=null),void 0===B&&(B=null),void 0===F&&(F=null),void 0===H&&(H=null),void 0===z&&(z=null),void 0===K&&(K=null),void 0===V&&(V=null),void 0===G&&(G=null),void 0===q&&(q=null),void 0===J&&(J=null),void 0===Y&&(Y=null),void 0===W&&(W=null),void 0===Q&&(Q=null),void 0===X&&(X=null),void 0===Z&&(Z=null),void 0===$&&($=null),void 0===tt&&(tt=null),void 0===et&&(et=!1),void 0===nt&&(nt=null),void 0===it&&(it=null),void 0===rt&&(rt=null),void 0===at&&(at=null),void 0===st&&(st={}),void 0===ot&&(ot=null),void 0===ut&&(ut=null),void 0===ct&&(ct=null),void 0===dt&&(dt=null),void 0===lt&&(lt=t.AdEnvironment.standard),void 0===ht&&(ht=t.AdProvider.standard),void 0===pt&&(pt=null),void 0===ft&&(ft=null),void 0===vt&&(vt=null),this.aff=e,this.alt=n,this.accessLevel=i,this.adRule=r,this.an=a,this.beacType=s,this.collection=o,this.cbp=u,this.descriptionUrl=c,this.edition=d,this.fcap=l,this.hashedIp=h,this.hl=p,this.isAuth=f,this.idType=v,this.impl=y,this.isLat=g,this.iu=m,this.msid=b,this.npa=P,this.ltd=w,this.nlsnPlat=A,this.output=I,this.palNonce=T,this.playlist=S,this.ppid=_,this.rdid=E,this.tags=k,this.transId=C,this.tfcd=O,this.url=M,this.varResolution=D,this.vpa=N,this.vpi=U,this.vadFormat=L,this.vpmute=j,this.authenticationProvider=R,this.bundleId=x,this.deviceOS=B,this.deviceType=F,this.isAutoplay=H,this.isMute=z,this.language=K,this.nielsenAppId=V,this.nielsenDeviceGroup=G,this.noAds=q,this.objectId=J,this.pageType=Y,this.platform=W,this.stitchingProvider=Q,this.swid=X,this.testAdTargeting=Z,this.tag=$,this.unid=tt,this.vastIconsSupported=et,this.videoDeliveryMethod=nt,this.videoPlayerSize=it,this.videoPlayerType=rt,this.videoPlayerVersion=at,this.userInfo=st,this.isDoNotTrackEnabled=ot,this.pp=ut,this.cmsid=ct,this.vid=dt,this.adEnvironment=lt,this.adProvider=ht,this.usPrivacy=pt,this.additionalConsent=ft,this.rdp=vt}return e.prototype.merge=function(e){return e?(this.adRule=e.adRule||this.adRule,this.an=e.an||this.an,this.descriptionUrl=e.descriptionUrl||this.descriptionUrl,this.fcap=e.fcap||this.fcap,this.hashedIp=e.hashedIp||this.hashedIp,this.hl=e.hl||this.hl,this.idType=e.idType||this.idType,this.isLat=Ne(e.isLat,this.isLat),this.iu=e.iu||this.iu,this.msid=e.msid||this.msid,this.npa=Ne(e.npa,this.npa),this.ltd=Ne(e.ltd,this.ltd),this.output=e.output||this.output,this.ppid=e.ppid||this.ppid,this.rdid=e.rdid||this.rdid,this.rdp=e.rdp||this.rdp,this.tfcd=e.tfcd||this.tfcd,this.url=e.url||this.url,this.vpa=e.vpa||this.vpa,this.vpi=e.vpi||this.vpi,this.vadFormat=e.vadFormat||this.vadFormat,this.vpmute=Ne(e.vpmute,this.vpmute),this.authenticationProvider=e.authenticationProvider||this.authenticationProvider,this.bundleId=e.bundleId||this.bundleId,this.deviceOS=e.deviceOS||this.deviceOS,this.deviceType=e.deviceType||this.deviceType,this.isAutoplay=Ne(e.isAutoplay,this.isAutoplay),this.isMute=Ne(e.isMute,this.isMute),this.language=e.language||this.language,this.palNonce=e.palNonce||this.palNonce,this.nielsenAppId=e.nielsenAppId||this.nielsenAppId,this.nielsenDeviceGroup=e.nielsenDeviceGroup||this.nielsenDeviceGroup,this.noAds=Ne(e.noAds,this.noAds),this.objectId=e.objectId||this.objectId,this.platform=e.platform||this.platform,this.stitchingProvider=e.stitchingProvider||this.stitchingProvider,this.swid=e.swid||this.swid,this.tags=e.tags||this.tags,this.testAdTargeting=e.testAdTargeting||this.testAdTargeting,this.unid=e.unid||this.unid,this.alt=e.alt||this.alt,this.beacType=e.beacType||this.beacType,this.transId=e.transId||this.transId,this.accessLevel=e.accessLevel||this.accessLevel,this.varResolution=e.varResolution||this.varResolution,this.nlsnPlat=e.nlsnPlat||this.nlsnPlat,this.tag=e.tag||this.tag,this.aff=e.aff||this.aff,this.playlist=e.playlist||this.playlist,this.cbp=e.cbp||this.cbp,this.collection=e.collection||this.collection,this.impl=e.impl||this.impl,this.isAuth=e.isAuth||this.isAuth,this.pageType=e.pageType||this.pageType,this.vastIconsSupported=Ne(e.vastIconsSupported,this.vastIconsSupported),this.videoDeliveryMethod=e.videoDeliveryMethod||this.videoDeliveryMethod,this.videoPlayerSize=e.videoPlayerSize||this.videoPlayerSize,this.videoPlayerType=e.videoPlayerType||this.videoPlayerType,this.videoPlayerVersion=e.videoPlayerVersion||this.videoPlayerVersion,this.isDoNotTrackEnabled=Ne(e.isDoNotTrackEnabled,this.isDoNotTrackEnabled),this.pp=e.pp||this.pp,this.cmsid=e.cmsid||this.cmsid,this.usPrivacy=e.usPrivacy||this.usPrivacy,this.additionalConsent=e.additionalConsent||this.additionalConsent,this.vid=e.vid||this.vid,this.userInfo?Object.assign(this.userInfo,e.userInfo):this.userInfo=e.userInfo,this.adEnvironment=e.adEnvironment!==t.AdEnvironment.standard?e.adEnvironment:this.adEnvironment,this.adProvider=e.adProvider!==t.AdProvider.standard?e.adProvider:this.adProvider,this):this},e.prototype.dictionaryForStartSession=function(){var e={};return e["ad.tfcd"]=De(this.tfcd),e["ad.is_lat"]=De(this.isLat),e["ad.idtype"]=this.idType,e["ad.rdid"]=this.rdid,e["ad.ppid"]=this.ppid||this.swid,e["ad.description_url"]=this.descriptionUrl,e["ad.hl"]=this.hl,e["ad.paln"]=this.palNonce,e["ad.npa"]=De(this.npa),e["ad.ltd"]=De(this.ltd),e["ad.msid"]=this.msid,e["ad.an"]=this.an,e["ad.url"]=this.url,e["ad.us_privacy"]=this.usPrivacy,e["ad.cust_params.d_us_privacy"]=this.usPrivacy,e["ad.rdp"]=null!==this.rdp?this.rdp:"1YYY"===this.usPrivacy?"1":null,e.authp=this.authenticationProvider,e.bundleId=this.bundleId,e.devOS=this.deviceOS,e.devType=this.deviceType,e.fcap=this.fcap,e.isAutoplay=De(this.isAutoplay),e.isMute=De(this.isMute),e.nlsnAppID=this.nielsenAppId,e.plt=this.platform,e.swid=this.swid,e.unid=this.unid,e.vps=this.videoPlayerSize,this.adEnvironment!==t.AdEnvironment.standard&&(e.adEnv=this.adEnvironment),this.adProvider!==t.AdProvider.standard&&(e.adProvider=this.adProvider),Object.assign(e,this.userInfo),Object.keys(e).forEach((function(t){return null===e[t]&&delete e[t]})),e},e.prototype.dictionaryForBrightcove=function(){var t={};t.bundleId=this.bundleId,t.devOS=this.deviceOS,t.devType=this.deviceType,t.isAutoplay=De(this.isAutoplay),t.isMute=De(this.isMute),t.plt=this.platform,t.swid=this.swid,t.vps=this.videoPlayerSize,t.d_id=this.rdid,t.vdm=this.videoDeliveryMethod||"vod",t.stp=this.stitchingProvider||"brightcove";var e=Object.keys(t).filter((function(e){return null!==t[e]})).map((function(e){return e+"="+t[e]})).join("&"),n={};return n.UMADPARAMiu=this.iu,n.UMADPARAMis_lat=De(this.isLat),n.UMADPARAMidtype=this.idType,n.UMADPARAMrdid=this.rdid,n.UMADPARAMppid=this.ppid||this.swid,n.UMADPARAMdescription_url=this.descriptionUrl,n.UMADPARAMhl=this.hl,n.UMADPARAMnpa=De(this.npa),n.UMADPARAMltd=De(this.ltd),n.UMADPARAMmsid=this.msid,n.UMADPARAMan=this.an,n.UMADPARAMurl=this.url,n.UMADPARAMvpa=De(this.vpa),n.UMADPARAMvpmute=De(this.vpmute),n.UMPTPARAMcust_params=e,Object.assign(n,this.userInfo),Object.keys(n).forEach((function(t){return null===n[t]&&delete n[t]})),n},e.prototype.dictionaryForAdEngine=function(){var e={};switch(e.sect=this.iu,e.npa=De(this.npa),e.ltd=De(this.ltd),e.lat=De(this.isLat),e.idtype=this.idType,e.devId=this.rdid,e.ppid=this.ppid||this.swid,e.app=this.an,e.tfcd=De(this.tfcd),e.devOS=this.deviceOS,e.devType=this.deviceType,e.isAutoplay=De(this.isAutoplay),e.isMute=De(this.isMute),e.plt=this.platform,e.swid=this.swid,e.unid=this.unid,e.vps=this.videoPlayerSize,e.bundle=this.msid,e.hl=this.hl,e.UID=this.swid,e.vdm=this.videoDeliveryMethod,e.url=this.url,this.adEnvironment){case t.AdEnvironment.development:e.env="qa";break;case t.AdEnvironment.prod:e.env="prod";break;case t.AdEnvironment.standard:}switch(this.adProvider){case t.AdProvider.googleAdManager:e.ads="google";break;case t.AdProvider.standard:}return Object.assign(e,this.userInfo),Object.keys(e).forEach((function(t){return null===e[t]&&delete e[t]})),e},e.prototype.dictionaryForImaSdk=function(){var e={};e.authp=this.authenticationProvider,e.d_us_privacy=this.usPrivacy,e.devOS=this.deviceOS,e.devType=this.deviceType,e.ed=this.edition,e.hip=this.hashedIp,e.isAutoplay=De(this.isAutoplay),e.isDnt=De(this.isDoNotTrackEnabled),e.isMute=De(this.isMute),e.lang=this.language,e.nlsnAppID=this.nielsenAppId,e.nlsnDevGrp=this.nielsenDeviceGroup,e.noad=this.noAds,e.objid=this.objectId,e.plt=this.platform,e.pgtyp=this.pageType,e.swid=this.swid,e.tag=this.tags,e.tstAdTar=this.testAdTargeting,e.unid=this.unid,e.vdm=this.videoDeliveryMethod||"vod",e.vps=this.videoPlayerSize;var n=Object.keys(e).filter((function(t){return null!==e[t]})).map((function(t){return t+"="+e[t]})).join("&"),i={};return i.ad_rule=this.adRule,i.cmsid=this.cmsid,i.description_url=this.descriptionUrl,i.hl=this.hl,i.iu=this.iu,i.npa=De(this.npa),i.output=this.output,i.ltd=De(this.ltd),i.pp=this.pp,i.ppid=this.ppid,i.rdp=this.rdp,i.tfcd=De(this.tfcd),i.us_privacy=this.usPrivacy,i.addtl_consent=this.additionalConsent,i.vid=this.vid,i.vpa=De(this.vpa),i.cust_params=n,i.gdfp_req="1",i.env="vp",i.sz="640x480",this.adEnvironment!==t.AdEnvironment.standard&&(i.adEnv=this.adEnvironment),Object.keys(i).forEach((function(t){return null===i[t]&&delete i[t]})),i},e.prototype.dictionaryForEntertainment=function(){var t={};t.ed=this.edition,t.devOS=this.deviceOS,t.devType=this.deviceType,t.hip=this.hashedIp,t.isAutoplay=De(this.isAutoplay),t.isDnt=De(this.isDoNotTrackEnabled),t.isMute=De(this.isMute),t.lang=this.language,t.nlsnAppID=this.nielsenAppId,t.nlsnDevGrp=this.nielsenDeviceGroup,t.nlsnPlat=this.nlsnPlat,t.noad=this.noAds,t.objid=this.objectId,t.pgtyp=this.pageType,t.plt=this.platform,t.swid=this.swid||this.ppid,t.tag=this.tags,t.tstAdTar=this.testAdTargeting,t.unid=this.unid,t.vdm=this.videoDeliveryMethod||"vod",t.vps=this.videoPlayerSize,t.alt=this.alt,t.beacType=this.beacType,t.transId=this.transId,t.accesslevel=this.accessLevel,t.isAuth=this.isAuth,t.fcap=this.fcap,t.var=this.varResolution,t.tag=this.tag,t.aff=this.aff,t.authp=this.authenticationProvider,t.playlist=this.playlist,t.cbp=this.cbp,t.collection=this.collection,t.impl=this.impl;var e=Object.keys(t).filter((function(e){return null!==t[e]})).map((function(e){return e+"="+t[e]})).join("&"),n={};return n.addtl_consent=this.additionalConsent,n.ad_rule=this.adRule,n.cmsid=this.cmsid,n.description_url=this.descriptionUrl,n.hl=this.hl,n.iu=this.iu,n.npa=De(this.npa),n.output=this.output,n.ltd=De(this.ltd),n.pp=this.pp,n.ppid=this.ppid,n.tfcd=De(this.tfcd),n.vid=this.vid,n.vpa=De(this.vpa),n.cust_params=e,n.output=this.output,n.vad_format=this.vadFormat,n.vpi=this.vpi,n.url=this.url,n.us_privacy=this.usPrivacy,n.gdfp_req="1",n.env="vp",n.sz="640x480",Object.keys(n).forEach((function(t){return null===n[t]&&delete n[t]})),n},e.ppidForSwid=function(t){return t},e.getGooglePalNonce=Me,e}(),Le=function(){function t(t,e){this.id=t,this.tier=e}return t.prototype.toString=function(){return"<AuthenticatedPackage id:"+this.id+", tier:"+this.tier+">"},t.fromObject=function(e){return new t(e.id,e.tier)},t}();function je(t,e,n){if(!t||!e||!n)return t;var i="</item></channel></rss>",r=-1;return-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:affiliateId>"+e+"</shield:affiliateId>"+t.slice(r)),-1!==(r=t.indexOf(i))&&-1===t.indexOf("shield:airingId")&&-1!==t.indexOf("shield:affiliateId")&&(t=t.slice(0,r)+"<shield:airingId>"+n+"</shield:airingId>"+t.slice(r)),t}var Re,xe=new function(t,e,n,i){this.preauthorizeNetworksEnabled=t,this.preauthorizeNetworks=e,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),Be=(function(){function t(t,e,n,i){void 0===i&&(i={}),this.partner=t,this.platform=e,this.requestorId=n,this.options=i,this.adobePass=null,this.providerDataSource=null,this.configuration=xe}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.isAuthenticated")},set:function(t){localStorage.setItem("AdobePassAuthenticator.isAuthenticated",JSON.stringify(t))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("AdobePassAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedIdentity",t):localStorage.removeItem("AdobePassAuthenticator.authenticatedIdentity")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedPackage",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedPackage");try{return Le.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedPackage",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedPackage")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("AdobePassAuthenticator.authenticatedProvider");try{return ge.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("AdobePassAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("AdobePassAuthenticator.authenticatedProvider")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wasPreviouslyAuthenticated",{get:function(){return"true"===localStorage.getItem("AdobePassAuthenticator.wasPreviouslyAuthenticated")||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){if(!this.isAuthenticated)return[];var t=localStorage.getItem("AdobePassAuthenticator.preauthorizedResources");try{return JSON.parse(t)}catch(t){return[]}},enumerable:!1,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this;w.debug("AdobePassAuthenticator.checkAuthentication");var e=this.adobePass;return e?e.checkAuthentication().then((function(n){return t.isAuthenticated=n,n?(localStorage.setItem("AdobePassAuthenticator.wasPreviouslyAuthenticated","true"),t.getPreauthorizedResources().then((function(t){localStorage.setItem("AdobePassAuthenticator.preauthorizedResources",JSON.stringify(t))})),e.getUserMetadata().then((function(e){var n=e.data,i=n.upstreamUserID,r=n.mvpd,a=n.packageId,s=n.tier;return t.authenticatedIdentity=i,(a||s)&&(t.authenticatedPackage=new Le(a,s)),t.providerDataSource?t.providerDataSource.getProvider(r).then((function(e){var n=e.getPreferredLogoUrl(t.partner);return t.authenticatedProvider=new ge(r,e.name,n,e.websiteUrl),!0})).catch((function(){return t.authenticatedProvider=new ge(r,r,null,null),!0})):(t.authenticatedProvider=new ge(r,r,null,null),I.resolve(!0))}))):(t.authenticatedIdentity=null,t.authenticatedProvider=null,t.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources"),I.resolve(!1))})).catch((function(){return I.resolve(!1)})):I.resolve(!1)},t.prototype.authenticate=function(){var t=this;if(!this.currentRegistrationCode)return I.reject(new Error("Use getRegistrationCode first."));w.debug("AdobePassAuthenticator.authenticate currentRegistrationCode: "+this.currentRegistrationCode.code);var e=this.currentRegistrationCode.expires;return e&&Date.now()>e?I.reject(new Error("Your activation code has expired.")):new I((function(e,n){t.authenticateTimer_=setTimeout((function(){t.checkAuthentication().then((function(t){e(t)})).catch((function(t){n(t)}))}),5e3)})).then((function(e){return e||t.authenticate()}))},t.prototype.cancelAuthenticate=function(){w.debug("AdobePassAuthenticator.cancelAuthenticate"),this.authenticateTimer_&&clearTimeout(this.authenticateTimer_)},t.prototype.deauthenticate=function(){this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.authenticatedPackage=null,localStorage.removeItem("AdobePassAuthenticator.preauthorizedResources");var t=this.adobePass;return t?t.logout():I.resolve(!1)},t.prototype.getRegistrationCode=function(){var t=this;w.debug("AdobePassAuthenticator.getRegistrationCode");var e=this.adobePass;return e?e.createRegistrationCode().then((function(e){return t.currentRegistrationCode=e,e?e.code:""})):I.reject(new Error("adobe pass not configured"))},t.prototype.checkAuthorization=function(t){var e=this;if(-1===t.authenticationTypes.indexOf(Ct.mvpd)||!this.isAuthenticated)return I.resolve(new we(!1,null));var n=t.mrss,i=this.authenticatedPackage&&this.authenticatedPackage.id;i&&(n=je(n,i,t.id));var r=n,a=this.adobePass;return a.authorize(r).then((function(){return a.getShortMediaToken(r)})).then((function(t){var n,i=t.serializedToken,a=((n={})[Pe.CustomDataKey.token]=i,n[Pe.CustomDataKey.tokenType]="ADOBEPASS",n[Pe.CustomDataKey.resource]=r,n[Pe.CustomDataKey.requestor]=e.requestorId,n),s=new Pe(Ct.mvpd,e.authenticatedProvider,e.authenticatedIdentity,a);return new we(!0,s)})).catch((function(t){try{return t.json().then((function(t){var n=e.configuration.adobeAuthErrorRegex,i=new RegExp(n),r=t.message,a=t.details,s="This channel is not part of your TV package.";return i.test(r)?a&&(s=a):s=r,I.reject(new Error(s))}))}catch(t){return I.reject(new Error("There was an unexpected error."))}}))},t.prototype.getPreauthorizedResources=function(){var t=this.configuration,e=t.preauthorizeNetworksEnabled,n=t.preauthorizeNetworks,i=t.preauthorizeNetworksMapping;if(!1===e){var r=n;return Object.keys(i).forEach((function(t){var e=i[t];-1!==r.indexOf(t)&&-1===r.indexOf(e)&&r.push(e)})),I.resolve(r)}return 0===n.length?I.resolve([]):this.adobePass.preauthorize(n).then((function(t){var e=t.resources.filter((function(t){return!0===t.authorized})).map((function(t){return t.id}));return Object.keys(i).forEach((function(t){var n=i[t];-1!==e.indexOf(t)&&-1===e.indexOf(n)&&e.push(n)})),e}))},t.defaultConfiguration=xe}(),P((function(t,e){var n;t.exports=(n=n||function(t,e){var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var s=n[a>>>2]>>>24-a%4*8&255;e[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)e[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n,i=[],r=function(e){e=e;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(e=18e3*(65535&e)+(e>>16)&i)&i;return r/=4294967296,(r+=.5)*(t.random()>.5?1:-1)}},a=0;a<e;a+=4){var o=r(4294967296*(n||t.random()));n=987654071*o(),i.push(4294967296*o()|0)}return new s.init(i,e)}}),o=i.enc={},u=o.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new s.init(n,e/2)}},c=o.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new s.init(n,e)}},d=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},l=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=d.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,o=r/(4*a),u=(o=e?t.ceil(o):t.max((0|o)-this._minBufferSize,0))*a,c=t.min(4*u,r);if(u){for(var d=0;d<u;d+=a)this._doProcessBlock(i,d);var l=i.splice(0,u);n.sigBytes-=c}return new s.init(l,c)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),h=(r.Hasher=l.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new h.HMAC.init(t,n).finalize(e)}}}),i.algo={});return i}(Math),n)})));P((function(t,e){var n,i,r,a,s,o,u,c;t.exports=(i=(n=c=Be).lib,r=i.WordArray,a=i.Hasher,s=n.algo,o=[],u=s.SHA1=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],s=n[3],u=n[4],c=0;c<80;c++){if(c<16)o[c]=0|t[e+c];else{var d=o[c-3]^o[c-8]^o[c-14]^o[c-16];o[c]=d<<1|d>>>31}var l=(i<<5|i>>>27)+u+o[c];l+=c<20?1518500249+(r&a|~r&s):c<40?1859775393+(r^a^s):c<60?(r&a|r&s|a&s)-1894007588:(r^a^s)-899497514,u=s,s=a,a=r<<30|r>>>2,r=i,i=l}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),n.SHA1=a._createHelper(u),n.HmacSHA1=a._createHmacHelper(u),c.SHA1)})),P((function(t,e){var n,i,r;t.exports=(i=(n=Be).lib.Base,r=n.enc.Utf8,void(n.algo.HMAC=i.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=r.parse(e));var n=t.blockSize,i=4*n;e.sigBytes>i&&(e=t.finalize(e)),e.clamp();for(var a=this._oKey=e.clone(),s=this._iKey=e.clone(),o=a.words,u=s.words,c=0;c<n;c++)o[c]^=1549556828,u[c]^=909522486;a.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}})))})),P((function(t,e){t.exports=Be.HmacSHA1})),P((function(t,e){var n,i,r;t.exports=(i=(n=r=Be).lib.WordArray,n.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],a=0;a<n;a+=3)for(var s=(e[a>>>2]>>>24-a%4*8&255)<<16|(e[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|e[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;o<4&&a+.75*o<n;o++)r.push(i.charAt(s>>>6*(3-o)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(t){var e=t.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var s=n.charAt(64);if(s){var o=t.indexOf(s);-1!==o&&(e=o)}return function(t,e,n){for(var r=[],a=0,s=0;s<e;s++)if(s%4){var o=n[t.charCodeAt(s-1)]<<s%4*2,u=n[t.charCodeAt(s)]>>>6-s%4*2;r[a>>>2]|=(o|u)<<24-a%4*8,a++}return i.create(r,a)}(t,e,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)}));!function(t){t.abc="abc",t.abcNews="abcnews",t.abcNewsLive="abcnewslive",t.abcOtv="abcotv",t.disney="dch",t.disneyJr="djr",t.disneyXD="dxd",t.disneyNow="dnow",t.espn="espn",t.espnFantasy="espnFantasy",t.oscar="oscar",t.freeform="ff",t.foxLatam="foxlatam",t.fxNow="fxnow",t.fx="fx",t.fxm="fxm",t.fxx="fxx",t.natGeoTV="natgeotv",t.natGeo="natgeo",t.natGeoWild="natgeowild",t.natgeoBrasil="natgeobrasil",t.unknown="000"}(Re||(Re={}));var Fe,He=function(){function t(t,e,n,i,r,a,s,o,u){this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a,this.rank=s,this.availability=o,this.accessType=u,this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a||[],this.rank=s,this.availability=o,this.accessType=u}return t.prototype.getPreferredLogoUrl=function(t){var e=this.images.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.type}))[0],n=this.images.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.type}))[0]||e;return n?"https://web.archive.org/web/20220907123413/https://s.secure.espncdn.com/stitcher/watch/clients/"+t+"-web/providers/"+this.adobeId+".png?height=40&imageType="+n:this.images.filter((function(t){return"DESKTOP"===t.type})).map((function(t){return t.href}))[0]||null},t.prototype.toString=function(){return"<Provider id:"+this.id+", name:"+this.name+", adobeId:"+this.adobeId+">"},t}();!function(t){t.mvpd="mvpd",t.isp="isp",t.tve="tve"}(Fe||(Fe={}));var ze=Fe,Ke=function(t){this.serviceUrl=t,this.serviceUrl=t};function Ve(t,e){var n=t.tier||99,i=e.tier||99;if(n<i)return-1;if(n>i)return 1;var r=t.rank||9999,a=e.rank||9999;if(r<a)return-1;if(r>a)return 1;var s=t.name.toLowerCase(),o=e.name.toLowerCase();return s<o?-1:s>o?1:0}var Ge={negativebgcolorImage:"COLOR_NEGATIVE",negativebgbwImage:"BW_NEGATIVE",positivebgcolorImage:"COLOR_POSITIVE",positivebgbwImage:"BW_POSITIVE",desktop:"DESKTOP"};function qe(t,e){if(!t)return null;var n=t.id,i=t.name,r=t.websiteUrl,a=t.adobeId,s=t.logos,o=t.accessType,u=function(t){return Object.keys(t).filter((function(e){return Ge[e]&&!!t[e]})).map((function(e){return{href:t[e].trim(),type:Ge[e]}}))}(s),c=t.countries.filter((function(t){return t.countryCode.toLowerCase()===e.toLowerCase()}))[0],d=c&&c.tier,l=c&&c.rank;return new He(n,i,a,d,r,u,l,null,o)}function Je(t,e){return t.rows?t.rows.map((function(t){return qe(t.data,e)})).sort(Ve):[qe(t,e)]}var Ye={};Ye[ze.mvpd]="adobeId",Ye[ze.isp]="ispId",Ye[ze.tve]="id";var We=new Ke("https://web.archive.org/web/20220907123413/https://affiliate.api.espn.com/affiliateApi/affiliates?includeProperties=true&rows=1000&apikey=q458c7hcllto16w0wcjytqoxq"),Qe=(function(){function t(t){this.locationProvider=t||{getCountryCode:function(){return"us"}},this.applicationId=null,this.configuration=We}Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applicationId",{get:function(){return this.applicationId_},set:function(t){this.applicationId_=t},enumerable:!0,configurable:!0}),t.prototype.getProvider=function(t,e,n){return void 0===n&&(n={}),k(this,void 0,void 0,(function(){var i,r,a,s;return C(this,(function(o){switch(o.label){case 0:return i=e||ze.mvpd,r=Ye[i]||"adobeId",n[r]=t,[4,this.getProviders(n)];case 1:if(a=o.sent(),!(s=a[0]))throw new Error("Unable to find provider.");return[2,s]}}))}))},t.prototype.getProviders=function(t){return void 0===t&&(t={}),k(this,void 0,void 0,(function(){var e,n,i,r,a,s,o;return C(this,(function(u){switch(u.label){case 0:e=this.configuration.serviceUrl,n=-1===e.indexOf("?")?"?":"&",i=this.applicationId,r=function(t){return-1!==["PR","GU","VI"].indexOf(t)?"US":t}(this.locationProvider.getCountryCode().toUpperCase()),t.country=r,i&&(t.application=i),a=Object.keys(t).map((function(e){if("id"!==e)return e+"="+encodeURIComponent(t[e])})).join("&"),s=""+e+n+a,t.id&&(o=e.split("?"),s=o[0]+"/"+t.id+"?"+o[1]),u.label=1;case 1:return u.trys.push([1,4,,5]),[4,T(s)];case 2:return[4,u.sent().json()];case 3:return[2,Je(u.sent(),r)];case 4:return u.sent(),[2,[]];case 5:return[2]}}))}))},t.defaultConfiguration=We}(),function(){function t(t){this.authenticatedProviderId=null,this.providerDataSource=null,this.partner=t.partner,this.platform=t.platform}return Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return!!this.token&&!!this.tokenType},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return localStorage.getItem("TokenAuthenticator.authenticatedIdentity")},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedIdentity",t):localStorage.removeItem("TokenAuthenticator.authenticatedIdentity")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){var t=localStorage.getItem("TokenAuthenticator.authenticatedProvider");try{return ge.fromObject(JSON.parse(t))}catch(t){return null}},set:function(t){t?localStorage.setItem("TokenAuthenticator.authenticatedProvider",JSON.stringify(t)):localStorage.removeItem("TokenAuthenticator.authenticatedProvider")},enumerable:!1,configurable:!0}),t.prototype.setToken=function(t,e,n,i){this.token=t,this.tokenType=e,this.resource=n,this.zipcode=i},t.prototype.checkAuthentication=function(){var t=this,e=this.authenticatedProviderId;if(!e||this.authenticatedProvider&&e===this.authenticatedProvider.id)return I.resolve(this.isAuthenticated);if(!this.providerDataSource)return this.authenticatedProvider=new ge(e,e,null,null),I.resolve(this.isAuthenticated);var n,i="ADOBEPASS"===(n=this.tokenType)?ze.mvpd:"DEVICE"===n?ze.isp:"AUTHTOKEN"===n?ze.mvpd:null;return this.providerDataSource.getProvider(e,i).then((function(n){var i=n.getPreferredLogoUrl(t.partner);return t.authenticatedProvider=new ge(e,n.name,i,n.websiteUrl),I.resolve(t.isAuthenticated)})).catch((function(){return t.authenticatedProvider=new ge(e,e,null,null),I.resolve(t.isAuthenticated)}))},t.prototype.authenticate=function(t){var e=t.authenticatedProviderId,n=t.authenticatedIdentity,i=t.token,r=t.tokenType,a=t.zipcode;return this.authenticatedProviderId=e,this.authenticatedIdentity=n,this.setToken(i,r,null,a),this.checkAuthentication()},t.prototype.deauthenticate=function(){return this.authenticatedProvider=null,this.authenticatedIdentity=null,this.token=null,this.tokenType=null,this.resource=null,this.zipcode=null,I.resolve(!0)},t.prototype.checkAuthorization=function(t){var e,n,i="ADOBEPASS"===(n=this.tokenType)?Ct.mvpd:"DEVICE"===n?Ct.isp:"BAM"===n?Ct.direct:"AUTHTOKEN"===n||"GATEKEEPER"===n?Ct.mvpd:null;if(!this.isAuthenticated||-1===t.authenticationTypes.indexOf(i)&&"DEVICE"!==this.tokenType&&"GATEKEEPER"!==this.tokenType)return I.resolve(new we(!1,null));var r=((e={})[Pe.CustomDataKey.token]=this.token,e[Pe.CustomDataKey.tokenType]=this.tokenType,e);this.zipcode&&(r.zipcode=this.zipcode),this.resource&&(r.resource=this.resource);var a=new Pe(i,this.authenticatedProvider,this.authenticatedIdentity,r),s=new we(!0,a);return I.resolve(s)},t}()),Xe=P((function(t,e){var n;t.exports=(n=n||function(t,e){var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||u).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var s=n[a>>>2]>>>24-a%4*8&255;e[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)e[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n,i=[],r=function(e){e=e;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(e=18e3*(65535&e)+(e>>16)&i)&i;return r/=4294967296,(r+=.5)*(t.random()>.5?1:-1)}},a=0;a<e;a+=4){var o=r(4294967296*(n||t.random()));n=987654071*o(),i.push(4294967296*o()|0)}return new s.init(i,e)}}),o=i.enc={},u=o.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new s.init(n,e/2)}},c=o.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var a=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new s.init(n,e)}},d=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},l=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=d.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,o=r/(4*a),u=(o=e?t.ceil(o):t.max((0|o)-this._minBufferSize,0))*a,c=t.min(4*u,r);if(u){for(var d=0;d<u;d+=a)this._doProcessBlock(i,d);var l=i.splice(0,u);n.sigBytes-=c}return new s.init(l,c)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),h=(r.Hasher=l.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new h.HMAC.init(t,n).finalize(e)}}}),i.algo={});return i}(Math),n)})),Ze=P((function(t,e){var n,i,r;t.exports=(i=(n=r=Xe).lib.WordArray,n.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],a=0;a<n;a+=3)for(var s=(e[a>>>2]>>>24-a%4*8&255)<<16|(e[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|e[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;o<4&&a+.75*o<n;o++)r.push(i.charAt(s>>>6*(3-o)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(t){var e=t.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var s=n.charAt(64);if(s){var o=t.indexOf(s);-1!==o&&(e=o)}return function(t,e,n){for(var r=[],a=0,s=0;s<e;s++)if(s%4){var o=n[t.charCodeAt(s-1)]<<s%4*2,u=n[t.charCodeAt(s)]>>>6-s%4*2;r[a>>>2]|=(o|u)<<24-a%4*8,a++}return i.create(r,a)}(t,e,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)})),$e=P((function(t,e){t.exports=Xe.enc.Utf8})),tn=function(t,e){e.setItem("watchsdk.web_adobe_pass_authenticator.state",JSON.stringify(t))},en={production:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyZGJmZWM4My03OWE1LTQyNzEtYTVmZC04NTZjYTMxMjRjNjMiLCJuYmYiOjE1NDAyMTI3NjEsImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjEyNzYxfQ.yaK3r4AI2uLVvsyN1GLzqzgzRlxMPtasSaiYYBV0wIstqih5tvjTmeoLmi8Xy9Kp_U7Md-bOffwiyK3srHkpUkhhwXLH2x6RPjmS1tPmhaG7-3LBcHTf2ySPvXhVf7cN4ngldawK4tdtLtsw6rF_JoZE2yaC6XbS2F51nXSFEDDnOQWIHEQRG3aYAj-38P2CLGf7g-Yfhbp5cKXeksHHQ90u3eOO4WH0EAjc9oO47h33U8KMEXxJbvjV5J8Va2G2fQSgLDZ013NBI3kQnE313qgqQh2feQILkyCENpB7g-TVBreAjOaH1fU471htSoGGYepcAXv-UDtpgitDiLy7CQ",staging:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhMmRjNjgyMC1kZGNkLTQ4NGEtOTdlNS0xZjJiZmQzOGI4YzgiLCJuYmYiOjE1NDAyMjIwNTksImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjIyMDU5fQ.YgX4ecGCgLCaZS7uwRQYZ8UR5EwT7GIl-glFbwU122bO1JYZSmbIX8YJSfmYth_scyeg-15BYWNftV9lOcmCe8VwIsQMJMIZKaF8qSIj5OfuTOBpNZNBpDAp5dC3zG7Zp1xLe3z-T0Y18-0BGj2yhGcJxBz4gtLXQ30Bw0LEIJ89nXCQaXFTq9N6zhDzMfkFJNnSNEvEmvcQqB4bFPIqn2is8427oQDU4D0XYvvTtx9eb5hmzKc9MbBG-8KRBA62BqdHomA5UA4kBYJKpe-8B2hO07Adi2bZoo5wP_VLNAnAxANWNXaGQYHMDjHDrHbbvuKHBudHgKxAuKpIdC7UrA"},nn=new function(t,e,n,i){this.preauthorizeNetworksEnabled=t,this.preauthorizeNetworks=e,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),rn="mvpd",an="upstreamUserID",sn="packageId",on="tier",un="hba_status",cn={},dn=function(){function t(e,n,i,r,a){this.partner=e,this.platform=n,this.requestorId=i,this.options=r,this.configuration=nn;var s=r||{},o=s.environment,u=void 0===o?t.Environment.PRODUCTION:o,c=s.errorEventHandlerName,d=void 0===c?"AEErrorHandler":c;this.accessEnabler=null,this.environment=u,this.errorEventHandlerName=d,this.resolveEntitlementLoaded_=null,this.resolveCheckAuthenticationCompletions_=[],this.resolveAuthenticate_=null,this.resolveDeauthenticate_=null,this.resolveAuthorization_=null,this.resolvePreauthorizes_=[],this.resolveAuthenticateMetadataDependencies_={},this.softwareStatements=a||en,this.delegate=null,this.providerDataSource=null,this.storage=localStorage,this.state_={};try{var l=this.storage.getItem("watchsdk.web_adobe_pass_authenticator.state"),h=JSON.parse(l);h.authenticatedProvider&&(h.authenticatedProvider=ge.fromObject(h.authenticatedProvider)),h.authenticatedPackage&&(h.authenticatedPackage=Le.fromObject(h.authenticatedPackage)),this.state_=h}catch(t){}this.initialization_=this.initialize(),window.tokenRequestFailed=this.tokenRequestFailed.bind(this)}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===this.state_.isAuthenticated.toString()},set:function(t){this.state_.isAuthenticated=t,tn(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return this.state_.authenticatedIdentity},set:function(t){if(!t)return delete this.state_.authenticatedIdentity,void tn(this.state_.toString,this.storage);this.state_.authenticatedIdentity=t,tn(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedPackage",{get:function(){return this.state_.authenticatedPackage},set:function(t){if(!t)return delete this.state_.authenticatedPackage,void tn(this.state_,this.storage);this.state_.authenticatedPackage=t,tn(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(t){if(!t)return delete this.state_.authenticatedProvider,void tn(this.state_,this.storage);this.state_.authenticatedProvider=t,tn(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasPreviouslyAuthenticated",{get:function(){var t,e;return"true"===(null===(e=null===(t=this.state_)||void 0===t?void 0:t.wasPreviouslyAuthenticated)||void 0===e?void 0:e.toString())||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return this.isAuthenticated?this.state_.preauthorizedResources:[]},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this;return w.debug("AdobePassAuthenticator.checkAuthentication"),this.accessEnabler?new I((function(e){t.resolveCheckAuthenticationCompletions_.push((function(t){e(t)})),t.accessEnabler.checkAuthentication()})):I.reject(null)},t.prototype.authenticate=function(t){var e=this;if(w.debug("AdobePassClient.authenticate"),!this.accessEnabler)return I.reject(null);var n=t&&t.redirectUrl||window.location.href;return new I((function(t){e.resolveAuthenticate_=function(e){t(e)},e.accessEnabler.getAuthentication(n)}))},t.prototype.deauthenticate=function(){var t=this;return w.debug("AdobePassAuthenticator.deauthenticate"),this.accessEnabler?new I((function(e){t.resolveDeauthenticate_=function(t){e(t)},t.accessEnabler.logout()})):I.reject(null)},t.prototype.checkAuthorization=function(t){var e,n=this;if(w.debug("AdobePassClient.checkAuthorization "+t),-1===(null===(e=t.authenticationTypes)||void 0===e?void 0:e.indexOf(Ct.mvpd))||!this.isAuthenticated){var i=new we(!1,null);return I.resolve(i)}var r=t.mrss,a=this.authenticatedPackage&&this.authenticatedPackage.id;a&&(r=je(r,a,t.id));var s=r;return new I((function(t,e){n.resolveAuthorization_=function(i){var r,a=i.token,s=i.resourceId,o=i.errorId,u=i.message;if(a||!o){var c=((r={})[Pe.CustomDataKey.token]=Ze.stringify($e.parse(a)),r[Pe.CustomDataKey.tokenType]="ADOBEPASS",r[Pe.CustomDataKey.resource]=s,r),d=new Pe(Ct.mvpd,n.authenticatedProvider,n.authenticatedIdentity,c),l=new we(!0,d);t(l)}else e(new Error(u||o))},n.accessEnabler.getAuthorization(s)}))},t.prototype.setProvider=function(t){this.accessEnabler.setSelectedProvider(t)},Object.defineProperty(t.prototype,"isHomeBasedAuth",{get:function(){return this.hbaStatus||!1},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){var t=this,e=this.environment;return function(t,e){var n=window&&window.document;if(!n)return I.reject();if(window.Adobe&&window.Adobe.AccessEnabler){var i=new window.Adobe.AccessEnabler(e);return I.resolve(i)}return new I((function(i,r){var a=n.createElement("script");a.id="ae_js",a.type="text/javascript",a.async=!0,a.src=t,a.addEventListener("load",(function(){var t=new window.Adobe.AccessEnabler(e);i(t)})),a.addEventListener("error",(function(){r()})),n.getElementsByTagName("head")[0].appendChild(a)}))}(cn[e],this.softwareStatements[e]).then((function(e){return t.accessEnabler=e,I.resolve()})).then((function(){return new I((function(e){t.resolveEntitlementLoaded_=e,t.bindAccessEnablerCallbacks()}))}))},t.prototype.bindAccessEnablerCallbacks=function(){window.entitlementLoaded=this.entitlementLoaded.bind(this),window.setAuthenticationStatus=this.setAuthenticationStatus.bind(this),window.setMetadataStatus=this.setMetadataStatus.bind(this),window.displayProviderDialog=this.displayProviderDialog.bind(this),window.setConfig=this.setConfig.bind(this),window.sendTrackingData=this.sendTrackingData.bind(this),window.preauthorizedResources=this.handlePreauthorizedResources.bind(this),window.selectedProvider=this.selectedProvider.bind(this),window.setToken=this.setToken.bind(this),window[this.errorEventHandlerName]=this.handleAccessEnablerError.bind(this)},t.prototype.entitlementLoaded=function(){w.debug("AdobePassAuthenticator.entitlementLoaded"),this.accessEnabler&&(this.accessEnabler.bind("errorEvent",this.errorEventHandlerName),this.accessEnabler.setRequestor(this.requestorId),this.resolveEntitlementLoaded_&&(this.resolveEntitlementLoaded_(!0),this.resolveEntitlementLoaded_=null))},t.prototype.setAuthenticationStatus=function(t,e){var n=this;if(w.debug("AdobePassAuthenticator.setAuthenticationStatus",t,e),this.isAuthenticated=!!t,this.isAuthenticated){this.accessEnabler.getMetadata(an);var i=[sn,on,un,rn].map((function(t){return new I((function(e){n.resolveAuthenticateMetadataDependencies_[t]=function(t){e(t)},n.accessEnabler.getMetadata(t)})).catch((function(t){return w.warn(t),null}))}));i.push(this.getPreauthorizedResources_().then((function(t){n.state_.preauthorizedResources=t}))),I.all(i).then((function(){n.resolveCheckAuthenticationCompletions_.forEach((function(t){t(n.isAuthenticated)})),n.resolveCheckAuthenticationCompletions_=[],n.resolveAuthenticate_&&(n.resolveAuthenticate_(n.isAuthenticated),n.resolveAuthenticate_=null)}))}else this.authenticatedIdentity=null,this.authenticatedPackage=null,this.authenticatedProvider=null,this.hbaStatus=null,this.state_.preauthorizedResources=[],this.resolveCheckAuthenticationCompletions_.forEach((function(t){t(n.isAuthenticated)})),this.resolveCheckAuthenticationCompletions_=[],this.resolveDeauthenticate_&&(this.resolveDeauthenticate_(this.isAuthenticated),this.resolveDeauthenticate_=null)},t.prototype.setMetadataStatus=function(t,e,n){var i=this;switch(w.debug("AdobePassAuthenticator.setMetadataStatus",t,n),t){case rn:var r=n;this.providerDataSource?this.providerDataSource.getProvider(r).then((function(e){var a=e.images||[],s=a.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.href}))[0],o=a.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.href}))[0]||s||a.map((function(t){return t.href}))[0];i.authenticatedProvider=new ge(r,e.name,o,e.websiteUrl),i.authenticatedProvider.isHomeBasedAuth=i.hbaStatus,i.resolveAuthenticateMetadata_(t,n)})).catch((function(){i.authenticatedProvider=new ge(r,r,null,null),i.resolveAuthenticateMetadata_(t,n)})):(this.authenticatedProvider=new ge(r,r,null,null),this.resolveAuthenticateMetadata_(t,n));break;case an:this.authenticatedIdentity=n,this.resolveAuthenticateMetadata_(t,n);break;case un:this.hbaStatus="true"===n,this.resolveAuthenticateMetadata_(t,n);break;case sn:case on:if(n){var a=this.authenticatedPackage||new Le(null,null);t===sn?a.id=n:t===on&&(a.tier=n),this.authenticatedPackage=a}this.resolveAuthenticateMetadata_(t,n)}},t.prototype.displayProviderDialog=function(t){var e=this;w.debug("AdobePassAuthenticator.displayProviderDialog",t),this.providerDataSource&&this.providerDataSource.getProviders().then((function(t){e.delegate&&e.delegate.selectProvider&&e.delegate.selectProvider(t)}))},t.prototype.setConfig=function(){},t.prototype.sendTrackingData=function(t,e){if("authenticationDetection"===t){var n={success:e[0],mvpd:e[1],guid:e[2],isTokenCached:e[3],deviceType:e[4],clientType:e[5],os:e[6]};w.debug("AdobePassAuthenticator.sendTrackingData",t,n)}},t.prototype.handlePreauthorizedResources=function(t){w.debug("AdobePassAuthenticator.preauthorizedResources",t);var e=this.resolvePreauthorizes_.shift();e&&e(t)},t.prototype.selectedProvider=function(t){var e=t.MVPD,n=t.AEstate_;w.debug("AdobePassAuthenticator.selectedProvider mvpd: "+e+", aeState: "+n)},t.prototype.setToken=function(t,e){w.debug("Requested resource: "+t+" tokenResult: "+e),this.resolveAuthorization_&&(this.resolveAuthorization_({resourceId:t,token:e}),this.resolveAuthorization_=null)},t.prototype.handleAccessEnablerError=function(t){var e=t.errorId,n=t.message;switch(w.debug("AdobePassAuthenticator.handleAccessEnablerError errorId: "+e+", message: "+n),e){case"Z100":w.error("Failure to authorize: "+n);var i=this.configuration.adobeAuthErrorRegex,r=new RegExp(i).test(n)?"This channel is not part of your TV package.":n;this.resolveAuthorization_&&(this.resolveAuthorization_({errorId:e,message:r}),this.resolveAuthorization_=null);break;case"N130":this.checkAuthentication()}},t.prototype.tokenRequestFailed=function(){w.debug("AdobePassAuthenticator.tokenRequestFailed")},t.prototype.resolveAuthenticateMetadata_=function(t,e){var n=this.resolveAuthenticateMetadataDependencies_[t];n&&(n(e),delete this.resolveAuthenticateMetadataDependencies_[t])},t.prototype.getPreauthorizedResources_=function(){var t=this;w.debug("AdobePassAuthenticator.getPreauthorizedResources_");var e=this.configuration,n=e.preauthorizeNetworksEnabled,i=e.preauthorizeNetworks,r=e.preauthorizeNetworksMapping;if(!1===n){var a=i;return Object.keys(r).forEach((function(t){var e=r[t];-1!==a.indexOf(t)&&-1===a.indexOf(e)&&a.push(e)})),I.resolve(a)}if(0===i.length||!0!==this.isAuthenticated)return I.resolve([]);if(!this.accessEnabler)return I.reject(null);var s=function t(e,n){return e.length?M([e.slice(0,n)],t(e.slice(n),n)):[]}(i,5),o=[],u=s.map((function(e){return new I((function(n){o.push((function(t){n(t)})),t.accessEnabler.checkPreauthorizedResources(e)})).catch((function(){return[]}))}));return this.resolvePreauthorizes_=o,I.all(u).then((function(t){return t.reduce((function(t,e){return t.concat(e)}),[])}))},t.defaultConfiguration=nn,t}();dn.Environment={PRODUCTION:"production",STAGING:"staging"},dn.EventType={PREAUTHORIZED:"preauthorized",NOT_PREAUTHORIZED:"not_preauthorized"},cn[dn.Environment.PRODUCTION]="https://web.archive.org/web/20220907123413/https://entitlement.auth.adobe.com/entitlement/v4/AccessEnabler.js",cn[dn.Environment.STAGING]="https://web.archive.org/web/20220907123413/https://entitlement.auth-staging.adobe.com/entitlement/v4/AccessEnabler.js";var ln,hn=function(t){u(n,t);var e=h(n);function n(t,r,a,s,o){var u;return i(this,n),(u=e.call(this)).partner=t,u.platform=r,u.requestorId=a,u.options=s,u.softwareStatements=o,u}return a(n,[{key:"configuration",get:function(){var t=at.shared.getConfiguration("adobePass",dn.defaultConfiguration);return w.debug("WebAdobePassAuthenticator.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){y(c(n.prototype),"configuration",t,this,!0)}}]),n}(dn),pn=function(t,e,n){this.contentType=t,this.keySystem=e,this.licenseUrl=n},fn=function(){function t(t){this.playbackUrl=t,this.textTracks=[]}return Object.defineProperty(t.prototype,"convivaContentMetadata",{get:function(){var t={accessType:null,mvpd:null};this.authenticationType&&(t.accessType=this.authenticationType&&this.authenticationType.toLowerCase()||"free",this.authenticatedProvider&&this.authenticationType===Ct.mvpd&&(t.mvpd=this.authenticatedProvider.id));var e=this.mediaItem&&this.mediaItem.tracking[wt.conviva]||{},n={streamUrl:this.playbackUrl,custom:Object.assign(e.custom||{},t)};return Object.assign(e,n)},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"<PlaybackSession playbackUrl:"+this.playbackUrl+", authenticationType:"+this.authenticationType+", authenticatedProvider:"+this.authenticatedProvider+">"},t}();!function(t){t.none="none",t.fairPlay="fairplay",t.playReady="playready",t.widevine="widevine"}(ln||(ln={}));var vn,yn=ln;!function(t){t.none="HLS",t.hlsFairplay="HLS_FAIRPLAY",t.dashPlayReady="DASH_PLAYREADY",t.dashWidevine="DASH_WIDEVINE"}(vn||(vn={}));var gn=vn,mn=function(){function t(){}return t.prototype.initPlaybackSession=function(t,e,n){var i=t.source.url;if(t.source.variant===gt.stitchedPreroll){var r=e.dictionaryForBrightcove();Object.keys(r).forEach((function(t){i=function(t,e,n){var i=-1===n.indexOf("?")?"?":"&";return n+i+t+"="+encodeURIComponent(e)}(t,r[t].toString(),i)}))}w.debug(i,t);var a=new fn(i);return a.mediaItem=t,a.seekToTime=t.seekInSeconds,a.authenticationType=n.authenticationType,a.authenticatedProvider=n.authenticatedProvider,a.authenticatedIdentity=n.authenticatedIdentity,I.resolve(a)},t}(),bn=P((function(t,e){var n;t.exports=(n=D,function(t){var e=n,i=e.lib,r=i.WordArray,a=i.Hasher,s=e.algo,o=[],u=[];!function(){function e(e){for(var n=t.sqrt(e),i=2;i<=n;i++)if(!(e%i))return!1;return!0}function n(t){return 4294967296*(t-(0|t))|0}for(var i=2,r=0;r<64;)e(i)&&(r<8&&(o[r]=n(t.pow(i,.5))),u[r]=n(t.pow(i,1/3)),r++),i++}();var c=[],d=s.SHA256=a.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],s=n[3],o=n[4],d=n[5],l=n[6],h=n[7],p=0;p<64;p++){if(p<16)c[p]=0|t[e+p];else{var f=c[p-15],v=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,y=c[p-2],g=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;c[p]=v+c[p-7]+g+c[p-16]}var m=i&r^i&a^r&a,b=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),P=h+((o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25))+(o&d^~o&l)+u[p]+c[p];h=l,l=d,d=o,o=s+P|0,s=a,a=r,r=i,i=P+(b+m)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+o|0,n[5]=n[5]+d|0,n[6]=n[6]+l|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=a._createHelper(d),e.HmacSHA256=a._createHmacHelper(d)}(Math),n.SHA256)})),Pn=function(){function t(t,e,n){void 0===n&&(n={}),this.programmer=t,this.applicationId=e,this.metadata=n}return t.prototype.withSession=function(t){var e=t.authenticationType,n=t.authenticatedIdentity,i=t.authenticatedProvider,r=t.mediaItem;if(e!==Ct.mvpd)return this;var a=n,s=i&&i.id;return this.metadata[B]=a,this.metadata[z]=r.network&&r.network.id,this.metadata[K]=r.streamType===bt.live?R:x,this.metadata[V]="",this.metadata[q]=!!t.authenticatedProvider&&t.authenticatedProvider.isHomeBasedAuth,this.subject=a,this.identityProvider=s,this},t.prototype.withLocationProvider=function(t){var e=t.getPublicIPAddress();return this.metadata[W]=e?bn("m!ck3ym0u$3"+e):null,this.metadata[Q]=t.getRegion()?t.getRegion():null,this},t.prototype.withServiceUrl=function(t){return this.serviceUrl=t,this},t.prototype.withMessages=function(t){return this.messages=t,this},t.prototype.build=function(){if(!this.subject||!this.identityProvider)return null;var t=new X(this.programmer,this.applicationId,this.identityProvider,this.subject,this.metadata);return this.serviceUrl&&(t.serviceUrl=this.serviceUrl),this.messages&&(t.messages=this.messages||{}),t},t}(),wn=function(){function t(t,e){this.partner=t,this.platform=e}return t.prototype.startSession=function(t,e,n,i,r,a){var s=["partner="+this.partner,"platform="+this.platform,"token="+encodeURIComponent(n),"tokenType="+i,"v=2.0.0","ttl=21600"];if(r){var o=N.stringify(U.parse(r));s.push("resource="+encodeURIComponent(o))}a&&Object.keys(a).forEach((function(t){s.push(t+"="+encodeURIComponent(a[t]))}));var u=/swid=*/g;s.some((function(t){return u.test(t)}))||s.push("swid="+encodeURIComponent(e));return T(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},credentials:"include",body:s.join("&")}).then((function(t){return t.json()})).then((function(t){if(!t.session)throw new Error(t.message||"An unexpected error occurred. ["+t.abbreviation+"]");return t})).catch((function(t){if(t.message)throw new Error(t.message);return t.json().then((function(t){throw new Error(t.message||"An unexpected error occurred. ["+t.abbreviation+"]")}))}))},t}(),An=function(){function t(t){this.authButler=t}return t.prototype.initPlaybackSession=function(t,e,n){var i=t.source.url;t.source.startSessionUrl&&t.source.type===Ot.shield&&(i=t.source.startSessionUrl);try{var r=window&&window.location.protocol;r&&"https:"===r&&(i=i.replace(/^http(s?):/,r))}catch(t){}var a=n.customData,s=a.token,o=a.tokenType,u=a.resource,c=void 0===u?t.mrss:u,d=e&&e.swid,l=this.authButler;if(!l)throw new Error("startSession support not configured");return l.startSession(i,d,s,o,c,e.dictionaryForStartSession()).then((function(e){var i=function(t,e){var n=t.playbackUrl,i=new fn(n);return i.token=e,i}(e,s);return i.mediaItem=t,i.seekToTime=t.seekInSeconds,i.authenticationType=n.authenticationType,i.authenticatedProvider=n.authenticatedProvider,i.authenticatedIdentity=n.authenticatedIdentity,i}))},t}(),In=function(){function t(){}return t.prototype.initPlaybackSession=function(t,e,n){var i=new fn(t.source.url);return i.mediaItem=t,i.seekToTime=t.seekInSeconds,i.authenticationType=null==n?void 0:n.authenticationType,i.authenticatedProvider=null==n?void 0:n.authenticatedProvider,i.authenticatedIdentity=null==n?void 0:n.authenticatedIdentity,I.resolve(i)},t}(),Tn="ADOBEPASS",Sn="JWT",_n="AUTHTOKEN",En=function(t){if(t instanceof Error)throw t;return t.json&&t.json().then((function(t){var e=t.message||"An unexpected error occurred. ["+t.exception+"]";throw"com.espn.watch.api.AccessDeniedException"===t.exception&&(e="This content is not available for your package or region."),new Error(e)}))},kn=function(){function t(t,e){this.drmSupport=gn.none,this.palEnabled=!1,this.palMaxLength=3e3,this.serviceUrl="https://web.archive.org/web/20220907123413/https://watch.auth.api.espn.com",this.apiKey=t,this.serviceUrl=e||"https://web.archive.org/web/20220907123413/https://watch.auth.api.espn.com"}return t.prototype.getAsset=function(t,e,n,i,r){var a=this.serviceUrl+"/video/auth/media/"+t+"/asset";return this.getAssetForUrl(a,e,n,i,r)},t.prototype.getAssetForUrl=function(t,e,n,i,r){var a=r||{},s={"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},o=-1===t.indexOf("?")?"?":"&",u=""+t+o+"apikey="+this.apiKey;if(e)if(n===Tn){if(a.adobeToken=e,i){var c=N.stringify(U.parse(i));a.adobeResource=c}}else n==Sn?s.Authorization="Bearer "+e:n==_n?(o=-1===u.indexOf("?")?"?":"&",u=""+u+o+"authtoken="+e):a.token=e;return a.drmSupport=this.drmSupport,T(u,{method:"POST",headers:s,credentials:"include",body:Object.keys(a).map((function(t){return t+"="+encodeURIComponent(a[t])})).join("&")}).then((function(t){if(!t.ok)throw t;return t.json()})).then((function(t){if(!t.stream){var e=t.message||"An unexpected error occurred.";throw new Error(e)}return t})).catch(En)},t.defaultServiceUrl="https://web.archive.org/web/20220907123413/https://watch.auth.api.espn.com",t}(),Cn=function(){function t(t){this.shieldAPI=t}return t.prototype.initPlaybackSession=function(t,e,n){return k(this,void 0,void 0,(function(){var i,r,a,s,o,u,c,d,l,h,p,f,v,y,g,m,b,P,w,A;return C(this,(function(I){switch(I.label){case 0:if(!(i=this.shieldAPI))throw new Error("shield support not configured");if(r=i.palEnabled,a=i.palMaxLength,s=n.customData.token,o=n.customData.zipcode,u=n.customData,d=(c=void 0===u?{}:u).tokenType,l=c.resource,h=void 0===l?t.mrss:l,!r||null!==e.palNonce)return[3,4];I.label=1;case 1:return I.trys.push([1,3,,4]),p=e,[4,Ue.getGooglePalNonce(e,a)];case 2:return p.palNonce=I.sent(),[3,4];case 3:return f=I.sent(),console.warn(f),[3,4];case 4:return v=e.dictionaryForStartSession(),o&&(v.zipcode=o),y=t.source.url,[4,i.getAssetForUrl(y,s,d,h,v)];case 5:return g=I.sent(),m=g.stream,b=g.captions,P=g.streamInfo,w=g.gatekeeperToken,(A=new fn(m)).mediaItem=t,A.seekToTime=t.seekInSeconds,A.authenticationType=n.authenticationType,A.authenticatedProvider=n.authenticatedProvider,A.authenticatedIdentity=n.authenticatedIdentity,A.token=w,A.playbackConfig=function(t){if(!t)return null;var e=t.streamType,n=t.licenseAcquisitionUrl,i=t.certificateUrl;switch(e){case"DASH_PLAYREADY":return new pn("application/dash+xml",ln.playReady,n);case"DASH_WIDEVINE":return new pn("application/dash+xml",ln.widevine,n);case"HLS_FAIRPLAY":return new pn("application/x-mpegURL",ln.fairPlay,i);case"HLS":return new pn("application/x-mpegURL",ln.none);default:return null}}(P),A.textTracks=function(t){if(!t)return[];var e={source:t};return t.endsWith(".vtt")&&(e.contentType="text/vtt"),[e]}(b),[2,A]}}))}))},t}(),On=function(){function t(){this.partner=null,this.platform=null,this.apiKey=null,this.deviceId=null,this.authenticators={},this.authorizers={},this.playbackSessionFactories={},this.playbackSessionFactories[Ot.none]=new In}return t.prototype.getAuthenticator=function(t){return this.authenticators[t]},t.prototype.setAuthenticator=function(t,e){var n=this;this.convertToArray(e).forEach((function(e){n.authenticators[e.toString()]=t}))},t.prototype.getAuthorizer=function(t){return this.authorizers[t]},t.prototype.setAuthorizer=function(t,e){var n=this;this.convertToArray(e).forEach((function(e){n.authorizers[e.toString()]=t}))},t.prototype.getPlaybackSessionFactory=function(t){return this.playbackSessionFactories[t]},t.prototype.setPlaybackSessionFactory=function(t,e){this.playbackSessionFactories[e]=t},t.prototype.checkAuthentication=function(){var t=this,e=Object.keys(this.authenticators).map((function(e){var n=t.authenticators[e];return n.checkAuthentication().then((function(t){return w.debug(e+" authenticator","isAuthenticated: "+t,"authenticatedProvider: "+n.authenticatedProvider),t})).catch((function(){return!1}))}));return I.all(e).then((function(t){return t.every((function(t){return!0===t}))}))},t.prototype.isAuthenticatedForMediaItem=function(t){var e=this;return t.authenticationTypes.length<1||-1!==t.authenticationTypes.indexOf(Ct.none)||t.authenticationTypes.map((function(t){return e.authenticators[t]})).filter((function(t){return t})).some((function(t){return t.isAuthenticated}))},t.prototype.isAuthenticatedWithAuthType=function(t){var e=this.authenticators[t];return!!e&&e.isAuthenticated},t.prototype.authenticateWithAuthType=function(t,e){var n=this.authenticators[t];if(n)return n.authenticate(e)},t.prototype.checkAuthorization=function(t,e){var n=this;if(t.authenticationTypes&&t.authenticationTypes.length<1||-1!==t.authenticationTypes.indexOf(Ct.none)){var i=new ge(t.id,t.title,t.images[0].url,t.source.url),r=new Pe(Ct.none,i,t.id,{}),a=new we(!0,r);return I.resolve(a)}var s=[Ct.open,Ct.mvpd,Ct.direct,Ct.isp].filter((function(e){return-1!==t.authenticationTypes.indexOf(e)})),o=s.map((function(t){return n.authorizers[t]})).filter((function(t){return t&&t.checkAuthorization}));return w.debug("mediaItem.authTypes:",s),0===o.length?I.reject(new Error("no authorizer configured to support authTypes: "+t.authenticationTypes)):function t(e,n,i,r){return void 0===r&&(r=[]),i.shift().checkAuthorization(e,n).then((function(a){return a.success?a:i.length<1?r.length>0?I.reject(null):a:t(e,n,i,r)})).catch((function(a){if(i.length>0)return a&&r.push(a),t(e,n,i,r);var s=r[0]||a;if(s)throw s}))}(t,e,o)},t.prototype.initPlaybackSession=function(t,e){var n=this;return!t.source.type&&t.authenticationTypes.length>0?I.reject(new Error("This event is not currently available.")):this.checkAuthorization(t,e).then((function(i){var r,a,s;w.debug("AuthenticationManager.initPlaybackSession.checkAuthorization result:",i.success);var o=i.success,u=i.payload;if(!o)throw new Error("Not authorized.");if(!(null===(r=null==t?void 0:t.source)||void 0===r?void 0:r.type))throw new Error("Media Item source type is missing.");var c=n.playbackSessionFactories[null===(a=null==t?void 0:t.source)||void 0===a?void 0:a.type];if(!c)throw new Error("SessionFactory for source type '"+(null===(s=null==t?void 0:t.source)||void 0===s?void 0:s.type)+"' is missing.");var d=new Ue;return d.authenticationProvider=i.payload.authenticatedProvider&&i.payload.authenticatedProvider.id,d.merge(e),c.initPlaybackSession(t,d,u).then((function(t){w.debug("AuthenticationManager.initPlaybackSession",t);var e=n.concurrencyMonitorBuilder&&n.concurrencyMonitorBuilder.withSession(t).build();return e?e.createSession().then((function(e){return t.concurrencyMonitorSessionId=e,t})):t}))}))},Object.defineProperty(t.prototype,"authStates",{get:function(){var t=this.authenticators[Ct.mvpd],e=[];return this.authenticators[Ct.isp].isAuthenticated&&e.push("isp"),!0===t.isAuthenticated?e.push("mvpd_login"):!0===t.wasPreviouslyAuthenticated&&e.push("mvpd_previous"),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){var t=this;return Object.keys(this.authenticators).map((function(e){return t.authenticators[e].preauthorizedResources})).reduce((function(t,e){return t.concat(e)}),[]).filter((function(t,e,n){return n.indexOf(t)===e}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"primaryAuthenticatedProvider",{get:function(){var t=this;return[Ct.mvpd,Ct.isp].map((function(e){return t.getAuthenticator(e)})).filter((function(t){return t.isAuthenticated})).map((function(t){return t.authenticatedProvider}))[0]},enumerable:!1,configurable:!0}),t.prototype.convertToArray=function(t){if(!t)return[];var e=[];return Array.isArray(t)?e=t:"string"==typeof t&&e.push(t),e},t}();On.AuthenticateOptionsKey={redirectUrl:"redirectUrl"};var Mn=function(){function t(){this.isAuthenticated=!0,this.authenticatedIdentity=null,this.authenticatedProvider=null,this.preauthorizedResources=this.isAuthenticated?["espn_free"]:[]}return t.prototype.checkAuthentication=function(){return I.resolve(!0)},t.prototype.authenticate=function(){return I.resolve(!0)},t.prototype.deauthenticate=function(){return I.resolve(!0)},t.prototype.checkAuthorization=function(t){var e;if(-1===t.authenticationTypes.indexOf(Ct.open)||!this.isAuthenticated)return I.resolve(new we(!1,null));var n=((e={})[Pe.CustomDataKey.token]="IA==",e[Pe.CustomDataKey.tokenType]="DEVICE",e),i=new Pe(Ct.open,this.authenticatedProvider,this.authenticatedIdentity,n),r=new we(!0,i);return I.resolve(r)},t}(),Dn=function(){function t(e,n,r){i(this,t),this.id=e,this.profile=n,this.preferences=r}return a(t,[{key:"favoriteSports",get:function(){return this.preferences.filter((function(t){return t.metadata.sportId&&!t.metadata.teamId})).map((function(t){return t.metadata}))}},{key:"favoriteTeams",get:function(){return this.preferences.filter((function(t){return t.metadata.teamInfo})).map((function(t){return t.metadata}))}},{key:"fantasyPreferences",get:function(){return this.preferences.filter((function(t){return 9===t.type.id}))}},{key:"isLeagueManager",get:function(){return this.preferences.some((function(t){var e=t.metadata&&t.metadata.entry&&t.metadata.entry;return e&&!0===e.isLeagueManager}))}},{key:"toString",value:function(){return"<Fan id:".concat(this.id,">")}}],[{key:"fromJson",value:function(e){if(!e)return null;var n=Nn.fromJson(e.profile),i=e.preferences.map((function(t){return jn.fromJson(t)}));return new t(e.id,n,i)}}]),t}(),Nn=function(){function t(e,n,r){i(this,t),this.isInsider=e,this.hasNotificationPreferences=n,this.settings=r}return a(t,[{key:"toString",value:function(){return"<FanProfile isInsider:".concat(this.isInsider,", hasNotificationPreferences:").concat(this.hasNotificationPreferences,">")}}],[{key:"fromJson",value:function(e){if(!e)return null;var n=Un.fromJson(e.settings);return new t(e.isInsider,e.hasNotificationPreferences,n)}}]),t}(),Un=function(){function t(e){i(this,t),this.videoAutoStart=e}return a(t,null,[{key:"fromJson",value:function(e){return e?new t(Ln.fromJson(e.videoAutoStart)):null}}]),t}(),Ln=function(){function t(e){i(this,t),this.value=e}return a(t,null,[{key:"fromJson",value:function(e){return e?new t(e.value):null}}]),t}(),jn=function(){function t(e,n,r){i(this,t),this.id=e,this.metadata=n,this.type=r}return a(t,null,[{key:"fromJson",value:function(e){if(!e)return null;var n=xn.fromJson(e.metaData||e.metadata),i=Rn.fromJson(e.type);return new t(e.id,n,i)}}]),t}(),Rn=function(){function t(e,n,r){i(this,t),this.id=e,this.name=n,this.code=r}return a(t,null,[{key:"fromJson",value:function(e){return e?new t(e.id,e.name,e.code):null}}]),t}(),xn=function(){function t(e,n,r,a){i(this,t),this.sportId=e,this.teamId=n,this.teamInfo=r,this.entry=a}return a(t,[{key:"uid",get:function(){if(this.teamInfo)return this.teamInfo.uid;var t=null;return this.sportId&&(t="s:".concat(this.sportId),this.teamId&&(t="".concat(t,"~t:").concat(this.teamId))),t}}],[{key:"fromJson",value:function(e){if(!e)return null;var n=null;if(e.teamInfo)n=new Hn(e.teamInfo.uid,e.teamInfo.name,e.teamInfo.fullName,e.teamInfo.logoUrl,e.teamInfo.darkLogoUrl,e.teamInfo.scoreboardLogoUrl,e.teamInfo.scoreboardDarkLogoUrl);else if(e.team){var i=e.team,r=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("default")})).map((function(t){return t.href}))[0],a=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("dark")&&-1===t.rel.indexOf("scoreboard")})).map((function(t){return t.href}))[0],s=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("scoreboard")&&-1===t.rel.indexOf("dark")})).map((function(t){return t.href}))[0],o=i.coreData.logos.filter((function(t){return-1!==t.rel.indexOf("scoreboard")&&-1!==t.rel.indexOf("dark")})).map((function(t){return t.href}))[0];n=new Hn(i.uid,i.name,i.text,r,a||r,s||r,o||a||r)}var u=Bn.fromJson(e.entry);return new t(e.sportId,e.teamId,n,u)}}]),t}(),Bn=function(){function t(e){i(this,t),this.groups=e}return a(t,[{key:"isLeagueManager",get:function(){return this.groups.some((function(t){return!0===t.groupManager}))}}],[{key:"fromJson",value:function(e){return e?new t((e.groups||[]).map((function(t){return Fn.fromJson(t)}))):null}}]),t}(),Fn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i(this,t),this.groupManager=e}return a(t,null,[{key:"fromJson",value:function(e){return e?new t(e.groupManager):null}}]),t}(),Hn=function t(e,n,r,a,s,o,u){i(this,t),this.uid=e,this.name=n,this.fullName=r,this.logoUrl=a,this.darkLogoUrl=s,this.scoreboardLogoUrl=o,this.scoreboardDarkLogoUrl=u},zn=function(){function t(){i(this,t),this.serviceUrl="https://web.archive.org/web/20220907123413/https://fan.api.espn.com/apis/v2/fans"}return a(t,[{key:"getFan",value:function(t){var e=lt.platform,n=this.serviceUrl||"https://web.archive.org/web/20220907123413/https://fan.api.espn.com/apis/v2/fans";return T("".concat(n,"/").concat(encodeURIComponent(t),"?prefType=sports&prefType=teams&prefType=fantasy&coreData=logos"),{method:"GET",headers:{"X-Personalization-Source":"espn-watchsdk-js-".concat(e)}}).then((function(t){return t.json()})).then((function(t){return Dn.fromJson(t)}))}}]),t}(),Kn=function(t){u(n,t);var e=h(n);function n(){return i(this,n),e.apply(this,arguments)}return a(n,null,[{key:"getFan",value:function(t){var e=at.shared.getConfiguration("fanApi",{serviceUrl:"https://web.archive.org/web/20220907123413/https://fan.api.espn.com/apis/v2/fans"}).serviceUrl,n=new zn;return n.serviceUrl=e,n.getFan(t)}}]),n}(zn);localStorage.getItem("FanManager.anonSwid")||T("https://web.archive.org/web/20220907123413/https://log.espn.com/log?srvc=sz&silent&returnBody=SWID&responseType=JSON").then((function(t){return t.json()})).then((function(t){var e=t.SWID;e&&localStorage.setItem("FanManager.anonSwid",e)}));var Vn,Gn=function(){function t(){i(this,t)}return a(t,null,[{key:"swid",get:function(){return localStorage.getItem("FanManager.anonSwid")}}]),t}(),qn=function(){function t(){i(this,t)}return a(t,null,[{key:"swid",get:function(){return localStorage.getItem("FanManager.swid")||Gn.swid},set:function(t){if(!t)return localStorage.removeItem("FanManager.swid"),void localStorage.removeItem("FanManager.fan");localStorage.setItem("FanManager.swid",t)}},{key:"fan",get:function(){var t=localStorage.getItem("FanManager.fan");try{return Dn.fromJson(JSON.parse(t))}catch(t){return null}}},{key:"update",value:function(){var e=localStorage.getItem("FanManager.swid");return e?Kn.getFan(e).then((function(t){return localStorage.setItem("FanManager.fan",JSON.stringify(t)),t})):I.resolve(t.fan)}}]),t}(),Jn=function(){function t(t,e,n,i,r,a,s,o,u){this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a,this.rank=s,this.availability=o,this.accessType=u,this.id=t,this.name=e,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a||[],this.rank=s,this.availability=o,this.accessType=u}return t.prototype.getPreferredLogoUrl=function(t){var e=this.images.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.type}))[0],n=this.images.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.type}))[0]||e;return n?"https://web.archive.org/web/20220907123413/https://s.secure.espncdn.com/stitcher/watch/clients/"+t+"-web/providers/"+this.adobeId+".png?height=40&imageType="+n:this.images.filter((function(t){return"DESKTOP"===t.type})).map((function(t){return t.href}))[0]||null},t.prototype.toString=function(){return"<Provider id:"+this.id+", name:"+this.name+", adobeId:"+this.adobeId+">"},t}();!function(t){t.mvpd="mvpd",t.isp="isp",t.tve="tve"}(Vn||(Vn={}));var Yn=Vn,Wn=function(t){this.serviceUrl=t,this.serviceUrl=t};function Qn(t,e){var n=t.tier||99,i=e.tier||99;if(n<i)return-1;if(n>i)return 1;var r=t.rank||9999,a=e.rank||9999;if(r<a)return-1;if(r>a)return 1;var s=t.name.toLowerCase(),o=e.name.toLowerCase();return s<o?-1:s>o?1:0}var Xn={negativebgcolorImage:"COLOR_NEGATIVE",negativebgbwImage:"BW_NEGATIVE",positivebgcolorImage:"COLOR_POSITIVE",positivebgbwImage:"BW_POSITIVE",desktop:"DESKTOP"};function Zn(t,e){if(!t)return null;var n=t.id,i=t.name,r=t.websiteUrl,a=t.adobeId,s=t.logos,o=t.accessType,u=function(t){return Object.keys(t).filter((function(e){return Xn[e]&&!!t[e]})).map((function(e){return{href:t[e].trim(),type:Xn[e]}}))}(s),c=t.countries.filter((function(t){return t.countryCode.toLowerCase()===e.toLowerCase()}))[0],d=c&&c.tier,l=c&&c.rank;return new Jn(n,i,a,d,r,u,l,null,o)}function $n(t,e){return t.rows?t.rows.map((function(t){return Zn(t.data,e)})).sort(Qn):[Zn(t,e)]}var ti={};ti[Yn.mvpd]="adobeId",ti[Yn.isp]="ispId",ti[Yn.tve]="id";var ei,ni=new Wn("https://web.archive.org/web/20220907123413/https://affiliate.api.espn.com/affiliateApi/affiliates?includeProperties=true&rows=1000&apikey=q458c7hcllto16w0wcjytqoxq"),ii=function(){function t(t){this.locationProvider=t||{getCountryCode:function(){return"us"}},this.applicationId=null,this.configuration=ni}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applicationId",{get:function(){return this.applicationId_},set:function(t){this.applicationId_=t},enumerable:!0,configurable:!0}),t.prototype.getProvider=function(t,e,n){return void 0===n&&(n={}),k(this,void 0,void 0,(function(){var i,r,a,s;return C(this,(function(o){switch(o.label){case 0:return i=e||Yn.mvpd,r=ti[i]||"adobeId",n[r]=t,[4,this.getProviders(n)];case 1:if(a=o.sent(),!(s=a[0]))throw new Error("Unable to find provider.");return[2,s]}}))}))},t.prototype.getProviders=function(t){return void 0===t&&(t={}),k(this,void 0,void 0,(function(){var e,n,i,r,a,s,o;return C(this,(function(u){switch(u.label){case 0:e=this.configuration.serviceUrl,n=-1===e.indexOf("?")?"?":"&",i=this.applicationId,r=function(t){return-1!==["PR","GU","VI"].indexOf(t)?"US":t}(this.locationProvider.getCountryCode().toUpperCase()),t.country=r,i&&(t.application=i),a=Object.keys(t).map((function(e){if("id"!==e)return e+"="+encodeURIComponent(t[e])})).join("&"),s=""+e+n+a,t.id&&(o=e.split("?"),s=o[0]+"/"+t.id+"?"+o[1]),u.label=1;case 1:return u.trys.push([1,4,,5]),[4,T(s)];case 2:return[4,u.sent().json()];case 3:return[2,$n(u.sent(),r)];case 4:return u.sent(),[2,[]];case 5:return[2]}}))}))},t.defaultConfiguration=ni,t}(),ri=function(){function t(){i(this,t)}return a(t,[{key:"getCountryCode",value:function(){}}]),t}(),ai=function(t){u(n,t);var e=h(n);function n(){return i(this,n),e.apply(this,arguments)}return a(n,[{key:"getCountryCode",value:function(){return"us"}}]),n}(ri),si=function(t){u(r,t);var e=h(r);function r(t){return i(this,r),e.call(this,t||new ai)}return a(r,[{key:"configuration",get:function(){var t=at.shared.getConfiguration("provider",n({applicationKeyMap:{}},ii.defaultConfiguration));return w.debug("ESPNAffiliateAPI.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){y(c(r.prototype),"configuration",t,this,!0)}},{key:"applicationId",get:function(){var t=function(t){return"US"===t||"GU"===t||"PR"===t||"VI"===t}(this.locationProvider.getCountryCode().toUpperCase())&&"web"===lt.platform?"".concat(lt.partner,"_").concat(lt.platform):"".concat(lt.platform),e=this.configuration.applicationKeyMap||{};return e[t]&&(t=e[t]),w.debug("ESPNAffiliateAPI.getApplicationId ".concat(t)),t},set:function(t){y(c(r.prototype),"applicationId",t,this,!0)}}]),r}(ii),oi=function(){function t(){i(this,t)}return a(t,null,[{key:"getBuilder",value:function(){var t,e=at.shared.getConfiguration("adobeCM",ot);if(!1===e.enabled)return null;var n=lt.platform,i=e.applications&&e.applications[n],r=e.applicationId||i&&i.applicationId,a=(s(t={},F,r),s(t,H,n),s(t,G,""),s(t,J,"false"),s(t,Y,"ESPN"),t);return new Pn("ESPN",r,a).withServiceUrl(e.serviceUrl).withMessages(e.messages||{})}}]),t}(),ui=function(t,e){e.setItem("watchsdk.isp_authenticator.state",JSON.stringify(t))},ci=new function(t){this.userDataServiceUrl=t}("https://web.archive.org/web/20220907123413/https://broadband.espn.com/espn3/auth/watchespn/user"),di=function(){function t(t,e,n){switch(this.partner=t,this.platform=e,this.providerDataSource=null,this.configuration=ci,n){case ye.localStorage:this.storage=localStorage;break;case ye.sessionStorage:this.storage=sessionStorage;break;default:this.storage=localStorage}this.state_={};try{var i=this.storage.getItem("watchsdk.isp_authenticator.state");i||(i=function(t){var e="true"===t.getItem("ISPAuthenticator.isAuthenticated"),n=t.getItem("ISPAuthenticator.authenticatedIdentity"),i=null;try{i=JSON.parse(t.getItem("ISPAuthenticator.authenticatedProvider"))}catch(t){}var r={isAuthenticated:e,authenticatedIdentity:n,authenticatedProvider:i};return t.removeItem("ISPAuthenticator.isAuthenticated"),t.removeItem("ISPAuthenticator.authenticatedIdentity"),t.removeItem("ISPAuthenticator.authenticatedProvider"),r}(this.storage),ui(this.state_,this.storage));var r=JSON.parse(i.toString());r.authenticatedProvider&&(r.authenticatedProvider=ge.fromObject(r.authenticatedProvider)),this.state_=r}catch(t){}}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return"true"===this.state_.isAuthenticated||!0===this.state_.isAuthenticated},set:function(t){this.state_.isAuthenticated=t,ui(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){return this.state_.authenticatedIdentity},set:function(t){if(!t)return delete this.state_.authenticatedIdentity,void ui(this.state_,this.storage);this.state_.authenticatedIdentity=t,ui(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(t){if(!t)return delete this.state_.authenticatedProvider,void ui(this.state_,this.storage);this.state_.authenticatedProvider=t,ui(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preauthorizedResources",{get:function(){return this.isAuthenticated?["espn3"]:[]},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){var t=this,e=this.configuration.userDataServiceUrl;return T(e+"?partner="+this.partner+"&platform="+this.platform).then((function(t){return t.json()})).then((function(n){var i=n.user&&n.user.authentication&&n.user.authentication.isp;if(i){t.isAuthenticated=!0;var r=i.name;return t.providerDataSource?t.providerDataSource.getProvider(r,Yn.isp).then((function(n){var i=n.getPreferredLogoUrl(t.partner);return t.authenticatedProvider=new ge(r,n.name,i,e),!0})).catch((function(){return t.authenticatedProvider=new ge(r,r,null,e),!0})):(t.authenticatedProvider=new ge(r,r,null,e),I.resolve(!0))}return!1}))},t.prototype.authenticate=function(){return I.resolve(!0)},t.prototype.deauthenticate=function(){return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,I.resolve(!0)},t.prototype.checkAuthorization=function(t){var e;if(-1===t.authenticationTypes.indexOf(Ct.isp)||!this.isAuthenticated)return I.resolve(new we(!1,null));var n=((e={})[Pe.CustomDataKey.token]="IA==",e[Pe.CustomDataKey.tokenType]="DEVICE",e),i=new Pe(Ct.isp,this.authenticatedProvider,this.authenticatedIdentity,n),r=new we(!0,i);return I.resolve(r)},t.defaultConfiguration=ci,t}(),li=function(t){u(n,t);var e=h(n);function n(){return i(this,n),e.apply(this,arguments)}return a(n,[{key:"configuration",get:function(){var t=at.shared.getConfiguration("authorization",di.defaultConfiguration);return w.debug("ISPAuthenticator.getConfiguration ".concat(JSON.stringify(t))),t},set:function(t){y(c(n.prototype),"configuration",t,this,!0)}}]),n}(di),hi=function(t){u(n,t);var e=h(n);function n(t,r){var a;i(this,n),(a=e.call(this)).partner=lt.partner,a.platform=lt.platform,a.apiKey=lt.apiKey,a.deviceId=lt.deviceId;var s=new si(t),o={deviceId:a.deviceId,deviceType:lt.platform},u=new hn(a.partner,a.platform,"ESPN",o,{production:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyZGJmZWM4My03OWE1LTQyNzEtYTVmZC04NTZjYTMxMjRjNjMiLCJuYmYiOjE1NDAyMTI3NjEsImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjEyNzYxfQ.yaK3r4AI2uLVvsyN1GLzqzgzRlxMPtasSaiYYBV0wIstqih5tvjTmeoLmi8Xy9Kp_U7Md-bOffwiyK3srHkpUkhhwXLH2x6RPjmS1tPmhaG7-3LBcHTf2ySPvXhVf7cN4ngldawK4tdtLtsw6rF_JoZE2yaC6XbS2F51nXSFEDDnOQWIHEQRG3aYAj-38P2CLGf7g-Yfhbp5cKXeksHHQ90u3eOO4WH0EAjc9oO47h33U8KMEXxJbvjV5J8Va2G2fQSgLDZ013NBI3kQnE313qgqQh2feQILkyCENpB7g-TVBreAjOaH1fU471htSoGGYepcAXv-UDtpgitDiLy7CQ",staging:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhMmRjNjgyMC1kZGNkLTQ4NGEtOTdlNS0xZjJiZmQzOGI4YzgiLCJuYmYiOjE1NDAyMjIwNTksImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjIyMDU5fQ.YgX4ecGCgLCaZS7uwRQYZ8UR5EwT7GIl-glFbwU122bO1JYZSmbIX8YJSfmYth_scyeg-15BYWNftV9lOcmCe8VwIsQMJMIZKaF8qSIj5OfuTOBpNZNBpDAp5dC3zG7Zp1xLe3z-T0Y18-0BGj2yhGcJxBz4gtLXQ30Bw0LEIJ89nXCQaXFTq9N6zhDzMfkFJNnSNEvEmvcQqB4bFPIqn2is8427oQDU4D0XYvvTtx9eb5hmzKc9MbBG-8KRBA62BqdHomA5UA4kBYJKpe-8B2hO07Adi2bZoo5wP_VLNAnAxANWNXaGQYHMDjHDrHbbvuKHBudHgKxAuKpIdC7UrA"});u.providerDataSource=s;var c="web"===a.platform?ye.sessionStorage:ye.localStorage,d=new li(a.partner,a.platform,c);d.providerDataSource=s;var l=new Mn;a.authenticators[Ct.mvpd]=u,a.authenticators[Ct.isp]=d,a.authenticators[Ct.open]=l,a.authorizers[Ct.mvpd]=u,a.authorizers[Ct.isp]=d,a.authorizers[Ct.open]=l,a.concurrencyMonitorBuilder=oi.getBuilder();var h={apiKey:a.apiKey,serviceUrl:kn.defaultServiceUrl},p=at.shared.getConfiguration("shield",h),f=new kn(p.apiKey),v=function(){var t={apiKey:a.apiKey,serviceUrl:kn.defaultServiceUrl},e=at.shared.getConfiguration("shield",t);f.apiKey=e.apiKey,f.serviceUrl=e.serviceUrl};v();var y=new Cn(f);a.playbackSessionFactories[Ot.shield]=y;var g=new wn(a.partner,a.platform),m=new An(g);a.playbackSessionFactories[Ot.startSession]=m;var b=new mn;return a.playbackSessionFactories[Ot.none]=b,a.drmSupport=r,at.shared.on(rt,(function(){var t=at.shared.getConfiguration("adobeCM");v();var e=new Cn(f);a.playbackSessionFactories[Ot.shield]=e,a.concurrencyMonitorBuilder=a.concurrencyMonitorBuilder||oi.getBuilder(),a.concurrencyMonitorBuilder=a.concurrencyMonitorBuilder.withServiceUrl(t.serviceUrl)})),a}return a(n,[{key:"drmSupport",set:function(t){var e=this;Object.keys(this.playbackSessionFactories).map((function(t){return e.playbackSessionFactories[t]})).forEach((function(e){"drmSupport"in e&&(e.drmSupport=t)}))}},{key:"initPlaybackSession",value:function(t,e){var i=qn.swid||Gn.swid;(arguments.length<=3?void 0:arguments[3])&&Object.keys(gn).map((function(t){return gn[t]})).indexOf(arguments.length<=3?void 0:arguments[3])&&(this.drmSupport=arguments.length<=3?void 0:arguments[3]);var r=new Ue;return r.swid=i,r.platform=this.platform,r.merge(e),f(c(n.prototype),"initPlaybackSession",this).call(this,t,r)}},{key:"advertisingId",get:function(){var t=localStorage.getItem("AuthenticationManager.advertisingId");return t||(t=fe&&fe.device.advertisingId,this.advertisingId=t),t},set:function(t){localStorage.setItem("AuthenticationManager.advertisingId",t)}}]),n}(On);!function(t){t[t.all=0]="all",t[t.linearPlayback=1]="linearPlayback"}(ei||(ei={}));var pi,fi=ei;!function(t){t.linear="linear",t.event="event"}(pi||(pi={}));var vi,yi=pi;!function(t){t.stitchedPreroll="stitchedPreroll"}(vi||(vi={}));var gi,mi=vi;!function(t){t.live="live",t.onDemand="onDemand"}(gi||(gi={}));var bi,Pi=gi;!function(t){t.nielsen="nielsen",t.comscore="comscore",t.conviva="conviva",t.heartbeats="heartbeats"}(bi||(bi={}));var wi,Ai=bi;!function(t){t.shortform="shortform",t.longform="longform"}(wi||(wi={}));var Ii,Ti=wi;!function(t){t.audio="audio",t.video="video"}(Ii||(Ii={}));var Si,_i=Ii;!function(t){t.pluto="pluto",t.graphQL="graphQL",t.cfa="cfa"}(Si||(Si={}));var Ei,ki=Si;!function(t){t.open="OPEN",t.direct="DIRECT",t.mvpd="MVPD",t.isp="ISP",t.none="NONE"}(Ei||(Ei={}));var Ci,Oi=Ei;!function(t){t.none="none",t.startSession="startSession",t.bam="bam",t.shield="shield",t.entitlement="entitlement"}(Ci||(Ci={}));var Mi=Ci,Di=function(){function t(t,e,n,i,r,a,s,o){this.url=t,this.type=e,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return t.fromObject=function(e){if(!e)return null;var n=e.url,i=e.type,r=e.hasEspnId3Heartbeats,a=e.hasNielsenWatermarks,s=e.hasPassThroughAds,o=e.commercialReplacement,u=e.startSessionUrl,c=e.variant;return new t(n,Mi[i],r,a,s,o,u,c)},t}(),Ni=function(){function t(t,e,n,i){this.id=t,this.type=e,this.name=n,this.resource=i}return t.fromObject=function(e){if(!e)return null;var n=yi[e.type];return new t(e.id,n,e.name,e.resource)},t}(),Ui=function(){function t(t){this.url=t}return t.fromObject=function(e){return e&&e.url?new t(e.url):null},t}(),Li=function(){function t(t){this.name=t}return Object.defineProperty(t.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),t.fromObject=function(e){return e?new t(e.name):null},t}(),ji=function(){function t(t,e,n,i,r){this.id=t,this.title=e,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=fi.all,this.images=[],this.type=_i.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(t.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===yi.linear},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLive",{get:function(){return this.streamType===Pi.live},enumerable:!1,configurable:!0}),t.fromObject=function(e){var n=Di.fromObject(e.source),i=new t(e.id,e.title,e.duration,e.language,n);return i.authenticationTypes=e.authenticationTypes,i.description=e.description,i.images=(e.images||[]).map((function(t){return Ui.fromObject(t)})),i.mrss=e.mrss,i.network=Ni.fromObject(e.network),i.seekInSeconds=e.seekInSeconds,i.streamType=Pi[e.streamType],i.supportedMediaCommands=e.supportedMediaCommands,i.tracking=e.tracking,i.references=e.references,i.packages=(e.packages||[]).map((function(t){return Li.fromObject(t)})),i.type=_i[e.type],i.entityType=Ti[e.entityType],i.isSyndicatable=e.isSyndicatable,i.brand=e.brand,i.adUnitId=e.adUnitId,i.cues=e.cues,i.show=e.show,i.adTarget=e.adTarget,i},t.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},t}();var Ri,xi=function(){function t(t){var e=function(t){var e=t.split("?")[1],n={};if(e)for(var i=e.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(t);if(this.original=t,this.id=e.videoID||e.playID||e.clip||e.externalId,t.match("sportscenter")){this.gameId=e.playGameID,this.channel=e.playChannel,this.simulcastAiringId=e.simulcastAiringId;var n=parseInt(e.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=e.eventId}this.source=e["x-source"],e.videoID?this.entityType=Ti.shortform:this.entityType=Ti.longform,this.type=_i.video}return t.prototype.toString=function(t){return t==ki.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},t.identifierStringForNetwork=function(t,e){return(e||ki.graphQL)==ki.graphQL?"sportscenter://x-callback-url/showWatchStream?playChannel="+t:"natgeo://playVideo?videoID="+t},t}();function Bi(t,e,n,i){if(!e)return{};var r,a,s,o=null;t===Ri.natGeo?o=function(t){if(!t)return{};var e={},n=t.id,i=t.title,r=t.duration;return e.c_video_id_code=n,e.c_a_media_airdate="unknown",e.c_a_media_daypart="daytime",e.c_a_media_digitaldate="unknown",e.c_a_media_episode="none",e.c_a_media_feed="natgeo live",e.c_a_media_format="vod",e.c_a_media_genre="none",e.c_a_media_network="natgeo",e.c_a_media_originator="natgeo",e.c_a_media_pass_auth="none",e.c_a_media_pass_mvpd="none",e.c_a_media_rating="none",e.c_a_media_season="none",e.c_a_media_show=i,e.c_a_media_streamtype=Ii.video,e.c_a_media_length=r,e}(e):(r=function(t,e,n){if(!t)return{};var i=t.duration,r=t.id,a=t.league,s=t.name,o=t.network,u=t.program,c=t.sport,d=t.startDateTime,l=t.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=l&&l.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",e===Ti.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(u&&u.code||"")+(c&&c.code||""),d){var f=new Date(d);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=l&&l.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return e===Ti.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(e,n,i),a=function(t,e){if(!t)return{};var n=t.id,i=t.duration,r=t.name,a=t.league,s=t.startDateTime,o=t.network,u=t.sport,c=t.status,d=t.tracking,l={};if(e===Ti.longform)l.ns_st_cl=0,l.ns_st_ct="vc",!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?(l.ns_st_cl=i,l.ns_st_ct="vc12",l.ns_st_pr="VOD",l.ns_st_ep=r):(l.ns_st_cl=0,l.ns_st_ct="vc13",l.ns_st_pr=r,l.ns_st_ep="*null"),l.c3="WATCHESPNLIVE",l.c6=a&&a.name?a||"No league":u&&u.code||"No Sport";else{l.ns_st_cl=i,l.ns_st_ct="vc11",l.ns_st_pr="VOD",l.ns_st_ep=r;var h=d||{},p=h.sportName,f=h.leagueName;l.c3="vod",l.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(l.ns_st_ti="*null",l.ns_st_ia="*null",l.ns_st_ce="*null",l.ns_st_ci=n,s){var v=new Date(s);l.ns_st_ddt=v.toDateString(),l.ns_st_tdt=v.toDateString()}return l.ns_st_st=o?o.id:"*null",l.ns_st_en="*null",l.ns_st_cn="1",l.ns_st_pn="1",l.ns_st_tp="1",l.ns_st_pu="ESPN",l.ns_st_cu="none",l.ns_st_ad="0",l.ns_st_ge="Sports",l}(e,n),s=function(t,e,n){if(!t)return{};var i=t.name,r=t.id,a=t.airingId,s=t.eventId,o=t.duration,u=t.network,c=t.status,d=t.sport,l=t.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),u&&(h.network=u.id),e===Ti.shortform?h.assetType="clip":!c||"live"!==c.toLowerCase()&&"over"!==c.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return u&&u.type===yi.linear&&"live"===h.assetType&&(p=u.id),h.sport=d&&d.name||"Not Applicable",h.league=l&&l.name||"Not Applicable",h.appBrand=Ri.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(e,n,i),o=function(t,e){if(!t)return{};var n=t.duration,i=t.airingId,r=t.network,a=t.status,s=t.sport,o=t.league,u=t.name,c=t.program,d=t.startDateTime,l=t.tracking,h=t.originalPublishDate,p=t.expirationDate,f=t.lastModifiedDate,v=t.ad,y=t.coverageType,g=t.brands,m={};if(m.ContentDuration=n,e===Ti.longform){if(m.CMSID=l&&l.name||u,m.isFullEpisode="y",i&&(m.AiringID=i),r&&(m.NetworkName=r.id,m.Channel=r.id),a&&(m.VideoType="REPLAY"===a?"replay":"live"),m.Sport=s&&s.name||"Not Applicable",m.SportCode=s&&s.code||"Not Applicable",m.League=o&&o.name||"Not Applicable",c&&c.code&&c.categoryCode?m.ProgramCode=c.categoryCode+c.code:m.ProgramCode="Not Applicable",m.IsStudio=c&&c.isStudio||"Not Applicable",d){var b=new Date(d);m.AirDate=b.toDateString(),m.AirTime=b.toTimeString()}if(Array.isArray(g)&&g.length){var P=g[0],w=P.id,A=P.name,I=P.type;m["a.media.asset"]=w,m["a.media.show"]=A,m["a.media.genre"]=I}}else if(e===Ti.shortform){if(m.isFullEpisode="n",m.VideoType="vod",m.Sport=l&&l.sportName||"Not Applicable",m.League=l&&l.leagueName||"Not Applicable",m.ShowCode=v&&v.bundle||"Not Applicable",l&&l.name&&(m.CMSID=l.name),h){b=new Date(h);m.PublishDate=b.toISOString().substring(0,10),m.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);m.ExpirationDate=b.toISOString()}if(f){b=new Date(f);m.DateLastModified=b.toISOString()}y&&(m.VideoTypeDetail=y)}return m}(e,n));var u={};return u[Ai.nielsen]=r,u[Ai.comscore]=a,u[Ai.conviva]=s,u[Ai.heartbeats]=o,u}function Fi(t,e,n){return t.sort((function(t,e){var n="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2,i="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(t,n){var i=t.network&&t.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=e.indexOf(i),s=e.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(t,e){var i=t.language===n?0:1,r=e.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(t){t.abc="abc",t.abcNews="abcnews",t.abcNewsLive="abcnewslive",t.abcOtv="abcotv",t.disney="dch",t.disneyJr="djr",t.disneyXD="dxd",t.disneyNow="dnow",t.espn="espn",t.espnFantasy="espnFantasy",t.oscar="oscar",t.freeform="ff",t.foxLatam="foxlatam",t.fxNow="fxnow",t.fx="fx",t.fxm="fxm",t.fxx="fxx",t.natGeoTV="natgeotv",t.natGeo="natgeo",t.natGeoWild="natgeowild",t.natgeoBrasil="natgeobrasil",t.unknown="000"}(Ri||(Ri={}));var Hi=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],zi=function(t,e,n,i){t==ki.graphQL?(this.serviceUrl=e||"https://web.archive.org/web/20220907123413/https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||Hi):t==ki.cfa&&(this.serviceUrl=e||"https://web.archive.org/web/20220907123413/https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock")},Ki=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!1,configurable:!0}),t.prototype.getMediaItems=function(e,n){return k(this,void 0,void 0,(function(){return C(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return k(this,void 0,void 0,(function(){var r,a,s,o,u,c;return C(this,(function(d){switch(d.label){case 0:return r=e.map((function(t){return new xi(t)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,I.all(r.map((function(e){return t.getPromiseMediaItems(e,a,s,n)})))];case 1:return u=d.sent(),(c=u.filter((function(t){return!(t instanceof Error)&&t instanceof ji}))).length?[2,Fi(c,o,navigator.language)]:[2,null]}}))}))},t.getPromiseMediaItems=function(e,n,i,r){return k(this,void 0,void 0,(function(){var a,s,o,u,c,d,l,h,p,f,v,y;return C(this,(function(g){switch(g.label){case 0:a=function(t,e,n,i){var r="",a="",s="",o=i||"US";return t.entityType===Ti.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+t.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",t.id?a='id:"'+t.id+'"':t.channel?(r="airings",a='networks:["'+t.channel+'"],type:LIVE'):t.gameId&&(r="airings",a='eventId:"'+(t.eventId||t.gameId)+'"')),e+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(e,n,i,r.countryCode),g.label=1;case 1:return g.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,g.sent().json()];case 3:if(s=g.sent(),o=s.data.airing,(u=s.data.airings)&&(c=e.simulcastAiringId?function(t){return t.simulcastAiringId===e.simulcastAiringId}:function(){return!0},o=u.filter(c)[0]),d=s.data.VOD,!(l=o||d))throw new Error("No results found.");if(h=function(t,e,n){var i=t.id,r=t.name,a=t.description,s=t.duration,o=t.image,u=t.eventId,c=t.requiresLinearPlayback,d=t.authTypes,l=t.source,h=t.prerollSource,p=t.packages,f=t.language,v=t.mrss,y=t.seekInSeconds,g=t.tracking,m=t.simulcastAiringId,b=t.network,P=t.status,w=t.cerebroId,A=t.syndicatable,I=P&&("LIVE"===P.toUpperCase()||"OVER"===P.toUpperCase())?Pi.live:Pi.onDemand,T=function(t){switch(t){case"NONE":return Mi.none;case"START_SESSION":return Mi.startSession;case"BAM":return Mi.bam;case"SHIELD":return Mi.shield}}(l.authorizationType),S=new Di(l.url,T,l.hasEspnId3Heartbeats,l.hasNielsenWatermarks,l.hasPassThroughAds,l.commercialReplacement,l.startSessionUrl);n&&n.sourceVariant===mi.stitchedPreroll&&h&&((S=new Di(h.url,Mi.none)).variant=mi.stitchedPreroll);var _=c?fi.linearPlayback:fi.all,E=g&&g.trackingId||i,k=new ji(i,r,s,f,S);if(k.authenticationTypes=d.map((function(t){switch(t){case"DIRECT":return Oi.direct;case"OPEN":return Oi.open;case"MVPD":return Oi.mvpd;case"ISP":return Oi.isp;default:return Oi.none}})),k.description=a,k.isSyndicatable=A,o&&o.url&&k.images.push(new Ui(o.url)),k.mrss=v,b){var C="linear"===b.type?yi.linear:yi.event;k.network=new Ni(b.id,C,b.name,b.adobeResource)}return k.seekInSeconds=y,k.streamType=I,k.supportedMediaCommands=_,k.brand=k.brand?k.brand:"espn",k.tracking=Bi(k.brand,t,e,S),k.references={eventId:u,simulcastAiringId:m,trackingId:E,cerebroId:w},k.type=_i.video,k.entityType=e,k.apiSource=ki.graphQL,k.packages=(p||[]).map((function(t){return new Li(t.name)})),k}(l,e.entityType,r),e.resumeTime&&(h.seekInSeconds=e.resumeTime),!h.source.url){if(p="OVER"===l.status.toUpperCase(),f=l.network&&l.network.type===yi.linear,v=l.network&&l.network.id,p&&f&&v)return[2,t.retryGetMediaItems(v,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return y=g.sent(),w.warn("Failed to retrieve MediaItem from GraphQL: "+y),[2,null];case 5:return[2]}}))}))},t.retryGetMediaItems=function(e,n,i,r){return k(this,void 0,void 0,(function(){var a,s,o,u;return C(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),a=xi.identifierStringForNetwork(e,ki.graphQL),s=new xi(a),[4,t.getPromiseMediaItems(s,n,i,r)];case 1:if((o=c.sent())&&o instanceof ji==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+e);case 2:return u=c.sent(),w.warn("MediaItem is over and retry failed: "+u),[2,null];case 3:return[2]}}))}))},t.defaultConfiguration=new zi(ki.graphQL),t}();var Vi,Gi=function(){function t(){this.configuration_=t.defaultConfiguration}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!1,configurable:!0}),t.prototype.getMediaItems=function(e,n){return k(this,void 0,void 0,(function(){return C(this,(function(i){switch(i.label){case 0:return[4,t.fetchMediaItems(e,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},t.fetchMediaItems=function(e,n,i){return k(this,void 0,void 0,(function(){var n,r;return C(this,(function(a){switch(a.label){case 0:return n=e.map((function(t){return new xi(t)})),r=i.serviceUrl,[4,I.all(n.map((function(e){return t.getPromiseMediaItem(e,r)})))];case 1:return[2,a.sent().filter((function(t){return!(t instanceof Error)&&t instanceof ji}))]}}))}))},t.getPromiseMediaItem=function(t,e){return k(this,void 0,void 0,(function(){var n,i,r;return C(this,(function(a){switch(a.label){case 0:n=e.replace("videoID",t.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(t){var e=t.id,n=t.title,i=t.description,r=t.duration,a=t.source,s=t.type,o=t.entityType,u=t.streamType,c=t.authenticationTypes,d=t.language,l=t.network,h=t.brand,p=t.images,f=o,v=a.type,y=new Di(a.url,v),g=new ji(e,n,r,d,y);return g.authenticationTypes=c.map((function(t){switch(t){case"DIRECT":return Oi.direct;case"OPEN":return Oi.open;case"MVPD":return Oi.mvpd;case"ISP":return Oi.isp;default:return Oi.none}})),g.description=i,l&&(g.network=new Ni(l.id,l.type,l.name,l.resource)),g.streamType=u,g.brand=h,g.tracking=Bi(g.brand,t,f,y),g.images=p,g.type=s,g.entityType=f,g.apiSource=ki.cfa,g}(i)];case 4:return r=a.sent(),w.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},t.defaultConfiguration=new zi(ki.cfa),t}(),qi=function(){function t(){}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!1,configurable:!0}),t.prototype.getMediaItems=function(t,e){return k(this,void 0,void 0,(function(){var n,i;return C(this,(function(r){switch(r.label){case 0:return n=e||{sourceVariant:null},t[0].match("natgeo")?((i=new Gi).configuration=this.configuration||i.configuration,[4,i.getMediaItems(t,n)]):[3,2];case 1:return[2,r.sent()];case 2:return(i=new Ki).configuration=this.configuration||i.configuration,[4,i.getMediaItems(t,n)];case 3:return[2,r.sent()]}}))}))},t}(),Ji=function(){function t(t,e){this.mediaItem=t,this.mediaItemDataSource=e}return t.prototype.start=function(){var t=this;this.mediaItem.isLinear&&this.mediaItem.isLive&&(this.intervalId=setInterval((function(){t.checkProgramChange()}),6e4))},t.prototype.stop=function(){this.intervalId&&clearInterval(this.intervalId)},t.prototype.checkProgramChange=function(){var t=this;if(this.mediaItem&&this.mediaItemDataSource){var e=this.mediaItem.network&&this.mediaItem.network.id;if(e){var n=this.mediaItem.apiSource?this.mediaItem.apiSource==ki.graphQL?ki.graphQL:ki.cfa:ki.graphQL,i=xi.identifierStringForNetwork(e,n);this.mediaItemDataSource.getMediaItems([i],{}).then((function(e){var n=Array.isArray(e)&&e[0];n&&(t.mediaItem.id!==n.id&&t.mediaItem.references.simulcastAiringId!==n.references.simulcastAiringId&&(t.mediaItem=n,t.onProgramChange(n)))}))}}},t.prototype.onProgramChange=function(t){},t}();!function(t){t.willStartPlaying="atv.player.willStartPlaying",t.didStopPlaying="atv.player.didStopPlaying",t.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",t.playerStateChanged="atv.player.playerStateChanged",t.playerTimeDidChange="atv.player.playerTimeDidChange"}(Vi||(Vi={}));var Yi,Wi,Qi=Vi;!function(t){t.priv="PRIV",t.txxx="TXXX"}(Yi||(Yi={})),function(t){t.program="PROGRAM",t.commercial="COMMERCIAL",t.slate="SLATE"}(Wi||(Wi={}));var Xi,Zi=function(t,e,n){void 0===t&&(t="com.espn.authnet.heartbeat"),void 0===e&&(e="com.espn.authnet.transition"),void 0===n&&(n="www.nielsen.com"),this.heartbeat=t,this.transition=e,this.nielsenWatermark=n},$i=function(t,e,n){this.tag=t,this.owner=e,this.dataValue=n};!function(t){t.start="start",t.playing="playing",t.pause="pause",t.seeking="seeking",t.stalled="stalled",t.stop="stop",t.timedMetadata="timedMetadata",t.currentTime="currentTime"}(Xi||(Xi={}));var tr,er=Xi,nr=function(){function t(t,e){this.certificateUrl=e,this.requests=[],this.bindSecureKeyDelivery(t||atv.secureKeyDelivery||{})}return t.prototype.bindSecureKeyDelivery=function(t){t.fetchCertificate=this.fetchCertificate.bind(this),t.fetchAssetID=this.fetchAssetID.bind(this),t.fetchKeys=this.fetchKeys.bind(this),t.cancelAllRequests=this.cancelAllRequests.bind(this)},t.prototype.fetchCertificate=function(t,e){var n=this;w.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",t);var i=this.certificateUrl;if(i){var r=new XMLHttpRequest;r.open("GET",i),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var t=r.responseDataAsBase64;w.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",t),e.success(t)}else e.failure(r.status);n.requests.splice(n.requests.indexOf(r),1)}},this.requests.push(r),r.send(null)}else e.failure("invalid certificate url")},t.prototype.fetchAssetID=function(t,e){var n=/[?&]c=([^&]+)&*/.exec(t);if(!n||n.length<2)e.failure("Error parsing assetId "+t);else{var i=n[1];w.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",t,i),e.success(i,!1)}},t.prototype.fetchKeys=function(t,e,n){var i=this,r=t.replace("skd://","https://"),a=JSON.stringify({spc:e});w.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",r);var s=new XMLHttpRequest;s.open("POST",r),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){if(4===s.readyState){if(200===s.status)try{var t=JSON.parse(s.responseText).ckc;n.success(t)}catch(t){n.failure("invalid JSON")}else n.failure(s.status);i.requests.splice(i.requests.indexOf(s),1)}},this.requests.push(s),s.send(a)},t.prototype.cancelAllRequests=function(){w.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.requests.forEach((function(t){t.abort&&t.abort()})),this.requests=[]},t}();(function(t){function e(e,n,i){var r=t.call(this)||this;if(!n)throw new Error("bus must be supplied");return r.bus=n,r.secureKeyDelivery=new nr(i),r.bindEventListeners(),r}_(e,t),e.prototype.bindEventListeners=function(){var t=this;this.bus.on(Qi.willStartPlaying,(function(){atv.player.observeTimedMetadataKeys(),t.emit(er.start)})),this.bus.on(Qi.playerStateChanged,(function(e,n){switch(w.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",e,n),e){case atv.player.states.FastForwarding:t.emit(er.seeking,n);break;case atv.player.states.Loading:t.emit(er.stalled,n);break;case atv.player.states.Paused:t.emit(er.pause,n);break;case atv.player.states.Playing:t.emit(er.playing,n);break;case atv.player.states.Rewinding:t.emit(er.seeking,n)}})),this.bus.on(Qi.onTimedMetadataChanged,(function(e){var n=e.key,i=e.extraAttributes.info,r=e.dataValue,a=r&&U.stringify(N.parse(r))||"";a.replace("\0",""),t.emit(er.timedMetadata,new $i(n,i,a))})),this.bus.on(Qi.didStopPlaying,(function(){t.emit(er.stop),t.cleanup()})),this.bus.on(Qi.playerTimeDidChange,(function(e){t.emit(er.currentTime,e)}))},Object.defineProperty(e.prototype,"playbackConfig",{set:function(t){if(t){var e=t.licenseUrl;w.debug("AtvlPlayerAdaptor setPlaybackConfig",e,t.protectionSystem),e&&(this.secureKeyDelivery.certificateUrl=e)}},enumerable:!1,configurable:!0}),e.prototype.stop=function(t){var e=t.message;atv.player.stopWithReason("Video Playback Has Stopped",e)},e.prototype.cleanup=function(){this.bus.off(Qi.willStartPlaying),this.bus.off(Qi.onTimedMetadataChanged),this.bus.off(Qi.didStopPlaying)}})(et),function(t){function e(e,n){var i=t.call(this)||this;return e?(i.nativePlayer=e,i.bus=e.getEventBus(),i.constants=n,i.id3MetadataOwner=new Zi,i.bindEventListeners(),i):i}_(e,t),e.prototype.bindEventListeners=function(){var t=this;this.bus.subscribe(this.constants.Events.Player.ID3,(function(e){void 0===e&&(e={});var n=e.sample?e.sample.data:e,i=n instanceof Uint8Array?String.fromCharCode.apply(String,M(n)):n,r=["PRIV","TXXX"].find((function(t){return i.includes(t)}))||null,a=Object.keys(t.id3MetadataOwner).map((function(e){return t.id3MetadataOwner[e]})).find((function(t){return i.includes(t)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new $i(r,a,s);t.emit(er.timedMetadata,o)})),this.alreadyStarted=!1,this.bus.subscribe(this.constants.Events.Player.PLAYING,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),t.alreadyStarted?t.emit(er.playing):(t.emit(er.start),t.emit(er.playing),t.alreadyStarted=!0)})),this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,(function(e){var n=e/1e3;t.emit(er.currentTime,n)})),this.bus.subscribe(this.constants.Events.Player.PAUSE,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.PAUSE"),t.emit(er.pause)})),this.bus.subscribe(this.constants.Events.Player.SEEKING,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING"),t.emit(er.seeking)})),this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),t.emit(er.stalled)})),this.bus.subscribe(this.constants.Events.Player.BUFFERING_END,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_END"),t.emit(er.playing)})),this.bus.subscribe(this.constants.Events.Player.COMPLETE,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),t.emit(er.stop),t.cleanup()}))},e.prototype.stop=function(t){t&&w.warn("BAMTizenPlayerAdaptor.stop",t.message),this.nativePlayer.stop(),this.cleanup()},e.prototype.cleanup=function(){this.alreadyStarted=!1,this.bus.unsubscribe(this.constants.Events.Player.ID3,this),this.bus.unsubscribe(this.constants.Events.Player.PLAYING,this),this.bus.unsubscribe(this.constants.Events.Player.TIME_UPDATE,this),this.bus.unsubscribe(this.constants.Events.Player.PAUSE,this),this.bus.unsubscribe(this.constants.Events.Player.SEEKING,this),this.bus.unsubscribe(this.constants.Events.Player.BUFFERING_START,this),this.bus.unsubscribe(this.constants.Events.Player.COMPLETE,this)}}(et),function(t){function e(e){var n=t.call(this)||this;return e?(n.nativePlayer=e,n.id3MetadataOwner=new Zi,n.bindEventListeners(),n):n}_(e,t),e.prototype.bindEventListeners=function(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)},e.prototype.loadCompleteHandler=function(t){w.debug("ChromecastPlayerAdaptor: PLAYER_LOAD_COMPLETE",t),this.emit(er.start)},e.prototype.id3Handler=function(t){var e=this;if(w.debug("ChromecastPlayerAdaptor._id3Handler",t),t.detail&&(t.segmentData=t.detail),t.segmentData){var n=String.fromCharCode.apply(String,M(t.segmentData));w.trace("ChromecastPlayerAdaptor._id3Handler",n);var i=["PRIV","TXXX"].find((function(t){return n.includes(t)}))||null,r=Object.keys(this.id3MetadataOwner).map((function(t){return e.id3MetadataOwner[t]})).find((function(t){return n.includes(t)}))||null,a=r?n.substring(n.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):null,s=new $i(i,r,a);w.trace("ChromecastPlayerAdaptor._id3Handler","tag:",i,"owner:",r,"dataValue:",a),this.emit(er.timedMetadata,s)}},e.prototype.timeUpdateHandler=function(t){var e=t.currentMediaTime;this.emit(er.currentTime,e)},e.prototype.playingHandler=function(t){var e=t.currentMediaTime;this.emit(er.playing,e)},e.prototype.pauseHandler=function(t){var e=t.currentMediaTime;this.emit(er.pause,e)},e.prototype.mediaFinishedHandler=function(t){w.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",t),this.emit(er.stop),this.cleanup()},e.prototype.stop=function(t){t&&w.warn("ChromecastPlayerAdaptor.stop",t.message)},e.prototype.cleanup=function(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))}}(et),function(t){function e(e){var n=t.call(this)||this;return n.nativePlayer=e,n.bindEventListeners(),n}_(e,t),e.prototype.bindEventListeners=function(){var t=this;this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeek=this.onSeek.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeek),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeUpdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.textTracks.onaddtrack=function(e){var n=e.track;n&&"metadata"===n.kind&&n.addEventListener("cuechange",(function(e){var n=e.target;if(n&&"metadata"===n.kind){for(var i=[],r=0;r<n.activeCues.length;r++){var a=n.activeCues[r];i.push(a.value)}i.map((function(e){var n=e.key,i=e.info,r=e.data;r instanceof ArrayBuffer&&(r=String.fromCharCode.apply(null,new Uint8Array(r)));var a=new $i(n,i,r);w.trace("HTML5PlayerAdaptor timedMetadata",a),t.emit(er.timedMetadata,a)}))}}))}):w.error("Native Player wasn't passed to HTML5PlayerAdaptor")},e.prototype.onPlay=function(t){this.emit(er.start,t.timeStamp)},e.prototype.onPause=function(){this.emit(er.pause)},e.prototype.onSeek=function(){this.emit(er.seeking)},e.prototype.onError=function(){this.emit(er.stop),this.cleanup()},e.prototype.onCurrentTime=function(t){this.emit(er.currentTime,t.timeStamp)},e.prototype.onStalled=function(t){this.emit(er.stalled,t.timeStamp)},e.prototype.stop=function(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(er.stop),this.cleanup()},e.prototype.cleanup=function(){this.nativePlayer.removeEventListener("play",this.onPlay),this.nativePlayer.removeEventListener("pause",this.onPause),this.nativePlayer.removeEventListener("error",this.onError),this.nativePlayer.removeEventListener("seeking",this.onSeek),this.nativePlayer.removeEventListener("stalled",this.onStalled),this.nativePlayer.removeEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.removeEventListener("ended",this.stop)}}(et);!function(t){t.opened="opened",t.playing="playing",t.ended="ended",t.timedMetadata="timedMetadata",t.error="error",t.timeUpdate="timeUpdate",t.stalled="stalled",t.paused="paused",t.seeking="seeking"}(tr||(tr={}));var ir,rr=tr,ar=(function(t){function e(e,n){var i=t.call(this)||this;if(!e)throw new Error("nativePlayer must be supplied");return i.nativePlayer=e,i.bus=n,i.bindEventListeners(),i}_(e,t),e.prototype.bindEventListeners=function(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on(rr.opened,this.onOpened),this.bus.on(rr.playing,this.onPlaying),this.bus.on(rr.paused,this.onPaused),this.bus.on(rr.timedMetadata,this.onTimedMetadata),this.bus.on(rr.ended,this.onEnded),this.bus.on(rr.error,this.onError),this.bus.on(rr.timeUpdate,this.onTimeUpdate),this.bus.on(rr.stalled,this.onStalled),this.bus.on(rr.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)},e.prototype.onSeeking=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onSeeking",t),this.emit(er.seeking,t)},e.prototype.onStalled=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onStalled",t),this.emit(er.stalled,t)},e.prototype.onTimeUpdate=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onTimeUpdate",t),this.emit(er.currentTime,t)},e.prototype.onError=function(t){w.debug("TrilithiumPlayerAdaptor.onError",t),this.emit(er.stop),this.cleanup()},e.prototype.onEnded=function(){this.emit(er.stop),this.cleanup()},e.prototype.onTimedMetadata=function(t,e,n){var i=e,r=n.toString(),a=U.stringify(N.parse(n.toString("base64"))),s=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;w.debug("TrilithiumPlayerAdaptor.onTimedMetadata "+i+" "+r+" "+s);var o=new $i(i,r,s);this.emit(er.timedMetadata,o)},e.prototype.onOpened=function(t){t&&(w.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(er.start))},e.prototype.onPlaying=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onPlaying",t),this.emit(er.playing,t)},e.prototype.onPaused=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onPaused",t),this.emit(er.pause,t)},e.prototype.stop=function(t){t&&w.warn("TrilithiumPlayerAdaptor.stop",t.message)},e.prototype.cleanup=function(){this.bus&&(this.bus.off(rr.opened),this.bus.off(rr.playing),this.bus.off(rr.timedMetadata),this.bus.off(rr.ended),this.bus.off(rr.error),this.bus.off(rr.timeUpdate),this.bus.off(rr.stalled))}}(et),6),sr=7,or=11,ur=12,cr=(function(t){function e(e){var n=t.call(this)||this;return n.nativePlayer=e,n.id3MetadataOwner=new Zi,n}_(e,t),e.prototype.onTimedMetaData=function(t){var e=this,n=t.data,i=String.fromCharCode.apply(null,n),r=["PRIV","TXXX"].find((function(t){return i.includes(t)}))||null,a=Object.keys(this.id3MetadataOwner).map((function(t){return e.id3MetadataOwner[t]})).find((function(t){return i.includes(t)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new $i(r,a,s);w.trace("AampUvePlayerAdapter timedMetadata",o),this.emit(er.timedMetadata,o)},e.prototype.onPlaybackStateChanged=function(t){switch(t.state){case ar:this.emit(er.pause);break;case sr:this.emit(er.seeking);break;case ur:case or:this.emit(er.stop),this.cleanup()}},e.prototype.onPlay=function(){this.emit(er.start)},e.prototype.onCurrentTime=function(t){this.emit(er.currentTime,t.positionMiliseconds)},e.prototype.onError=function(){this.emit(er.stop),this.cleanup()},e.prototype.stop=function(){this.emit(er.stop),this.cleanup()},e.prototype.cleanup=function(){}}(et),function(){function t(t,e,n){var i=this;this.adobeConcurrencyBuilder=n,this.session=t,this.playerAdaptor=e,this.adobeConcurrencyBuilder&&this.initConcurrencyMonitor(),this.initProgramChangeMonitor(),this.playerAdaptor.on(er.start,(function(){w.debug("PlaybackManager.start"),i.programChangeMonitor.start()})),this.playerAdaptor.on(er.stop,(function(){w.debug("PlaybackManager.stop"),i.cleanup()}))}return t.prototype.initConcurrencyMonitor=function(){var t=this,e=this.session,n=e.concurrencyMonitorSessionId,i=this.adobeConcurrencyBuilder.withSession(e).build();i&&(e.concurrencyMonitorSessionId&&i.startWithSession(n),i.onError=function(e,n){t.playerAdaptor.stop(e),t.onStop(e),n&&t.onDeauthenticate(Oi.mvpd)},this.adobeConcurrencyMonitor=i)},t.prototype.initProgramChangeMonitor=function(){var t=this,e=new qi,n=new Ji(this.session.mediaItem,e);n.onProgramChange=function(e){var n=t.session.token,i=e.mrss;if(n){var r=t.shield;r?r.getAsset(e.id,n,"GATEKEEPER",i,{}).then((function(n){n&&(t.session.mediaItem=e,t.session.token=n.gatekeeperToken,t.nielsenTrackingManager&&(t.nielsenTrackingManager.mediaItem=e),t.onUpdatedMediaItem(e))})).catch((function(e){t.playerAdaptor.stop(e),t.onStop(e)})):w.warn("shield support not configured")}else w.warn("token missing. skipping program change re-auth.")},this.programChangeMonitor=n},t.prototype.cleanup=function(){w.debug("PlaybackManager.cleanup"),this.playerAdaptor.off(er.start),this.playerAdaptor.off(er.stop),this.adobeConcurrencyMonitor&&this.adobeConcurrencyMonitor.stop(),this.programChangeMonitor&&this.programChangeMonitor.stop(),this.nielsenTrackingManager&&this.nielsenTrackingManager.stop()},t.prototype.onDeauthenticate=function(t){},t.prototype.onUpdatedMediaItem=function(t){},t.prototype.onStop=function(t){},t}()),dr=function(t){u(n,t);var e=h(n);function n(t,r,a,s){var o;i(this,n);var u=lt.apiKey;(o=e.call(this,t,r,a)).nielsenTrackingManager=s;var c=new kn,d=function(){var t={apiKey:u,serviceUrl:kn.defaultServiceUrl},e=at.shared.getConfiguration("shield",t);c.apiKey=e.apiKey,c.serviceUrl=e.serviceUrl};return d(),at.shared.on(rt,d),o.shield=c,o}return n}(cr);!function(t){t.willStartPlaying="atv.player.willStartPlaying",t.didStopPlaying="atv.player.didStopPlaying",t.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",t.playerStateChanged="atv.player.playerStateChanged",t.playerTimeDidChange="atv.player.playerTimeDidChange"}(ir||(ir={}));var lr,hr,pr=ir;!function(t){t.priv="PRIV",t.txxx="TXXX"}(lr||(lr={})),function(t){t.program="PROGRAM",t.commercial="COMMERCIAL",t.slate="SLATE"}(hr||(hr={}));var fr,vr=function(t,e,n){void 0===t&&(t="com.espn.authnet.heartbeat"),void 0===e&&(e="com.espn.authnet.transition"),void 0===n&&(n="www.nielsen.com"),this.heartbeat=t,this.transition=e,this.nielsenWatermark=n},yr=function(){function t(t,e){this.type=t,this.id=e}return t.prototype.isContent=function(){return this.type!==hr.slate&&this.type!==hr.commercial},t}(),gr=function(t,e,n){this.tag=t,this.owner=e,this.dataValue=n};!function(t){t.start="start",t.playing="playing",t.pause="pause",t.seeking="seeking",t.stalled="stalled",t.stop="stop",t.timedMetadata="timedMetadata",t.currentTime="currentTime",t.loadedMetadata="loadedMetadata"}(fr||(fr={}));var mr,br=fr,Pr=function(){function t(t,e){this.certificateUrl=e,this.requests=[],this.bindSecureKeyDelivery(t||atv.secureKeyDelivery||{})}return t.prototype.bindSecureKeyDelivery=function(t){t.fetchCertificate=this.fetchCertificate.bind(this),t.fetchAssetID=this.fetchAssetID.bind(this),t.fetchKeys=this.fetchKeys.bind(this),t.cancelAllRequests=this.cancelAllRequests.bind(this)},t.prototype.fetchCertificate=function(t,e){var n=this;w.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",t);var i=this.certificateUrl;if(i){var r=new XMLHttpRequest;r.open("GET",i),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var t=r.responseDataAsBase64;w.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",t),e.success(t)}else e.failure(r.status);n.requests.splice(n.requests.indexOf(r),1)}},this.requests.push(r),r.send(null)}else e.failure("invalid certificate url")},t.prototype.fetchAssetID=function(t,e){var n=/[?&]c=([^&]+)&*/.exec(t);if(!n||n.length<2)e.failure("Error parsing assetId "+t);else{var i=n[1];w.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",t,i),e.success(i,!1)}},t.prototype.fetchKeys=function(t,e,n){var i=this,r=t.replace("skd://","https://"),a=JSON.stringify({spc:e});w.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",r);var s=new XMLHttpRequest;s.open("POST",r),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){if(4===s.readyState){if(200===s.status)try{var t=JSON.parse(s.responseText).ckc;n.success(t)}catch(t){n.failure("invalid JSON")}else n.failure(s.status);i.requests.splice(i.requests.indexOf(s),1)}},this.requests.push(s),s.send(a)},t.prototype.cancelAllRequests=function(){w.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.requests.forEach((function(t){t.abort&&t.abort()})),this.requests=[]},t}(),wr=function(t){function e(e,n,i){var r=t.call(this)||this;if(!n)throw new Error("bus must be supplied");return r.bus=n,r.secureKeyDelivery=new Pr(i),r.bindEventListeners(),r}return _(e,t),e.prototype.bindEventListeners=function(){var t=this;this.bus.on(pr.willStartPlaying,(function(){atv.player.observeTimedMetadataKeys(),t.emit(br.start)})),this.bus.on(pr.playerStateChanged,(function(e,n){switch(w.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",e,n),e){case atv.player.states.FastForwarding:t.emit(br.seeking,n);break;case atv.player.states.Loading:t.emit(br.stalled,n);break;case atv.player.states.Paused:t.emit(br.pause,n);break;case atv.player.states.Playing:t.emit(br.playing,n);break;case atv.player.states.Rewinding:t.emit(br.seeking,n)}})),this.bus.on(pr.onTimedMetadataChanged,(function(e){var n=e.key,i=e.extraAttributes.info,r=e.dataValue,a=r&&U.stringify(N.parse(r))||"";a.replace("\0",""),t.emit(br.timedMetadata,new gr(n,i,a))})),this.bus.on(pr.didStopPlaying,(function(){t.emit(br.stop),t.cleanup()})),this.bus.on(pr.playerTimeDidChange,(function(e){t.emit(br.currentTime,e)}))},Object.defineProperty(e.prototype,"playbackConfig",{set:function(t){if(t){var e=t.licenseUrl;w.debug("AtvlPlayerAdaptor setPlaybackConfig",e,t.protectionSystem),e&&(this.secureKeyDelivery.certificateUrl=e)}},enumerable:!1,configurable:!0}),e.prototype.stop=function(t){var e=t.message;atv.player.stopWithReason("Video Playback Has Stopped",e)},e.prototype.cleanup=function(){this.bus.off(pr.willStartPlaying),this.bus.off(pr.onTimedMetadataChanged),this.bus.off(pr.didStopPlaying)},e}(et),Ar=function(t){function e(e,n){var i=t.call(this)||this;return e?(i.nativePlayer=e,i.bus=e.getEventBus(),i.constants=n,i.id3MetadataOwner=new vr,i.unsubscribers=[],i.bindEventListeners(),i):i}return _(e,t),e.prototype.bindEventListeners=function(){var t=this;this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.ID3,this,(function(e){void 0===e&&(e={});var n=e.sample?e.sample.data:e,i=n instanceof Uint8Array?String.fromCharCode.apply(String,M(n)):n,r=["PRIV","TXXX"].find((function(t){return i.includes(t)}))||null,a=Object.keys(t.id3MetadataOwner).map((function(e){return t.id3MetadataOwner[e]})).find((function(t){return i.includes(t)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new gr(r,a,s);t.emit(br.timedMetadata,o)}))),this.alreadyStarted=!1,this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PLAYING,this,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),t.alreadyStarted?t.emit(br.playing):(t.emit(br.start),t.emit(br.playing),t.alreadyStarted=!0)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,this,(function(e){var n=e/1e3;t.emit(br.currentTime,n)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PAUSE,this,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.PAUSE"),t.emit(br.pause)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.SEEKING,this,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING"),t.emit(br.seeking)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,this,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),t.emit(br.stalled)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_END,this,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_END"),t.emit(br.playing)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.COMPLETE,this,(function(){w.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),t.emit(br.stop),t.cleanup()})))},e.prototype.stop=function(t){t&&w.warn("BAMTizenPlayerAdaptor.stop",t.message),this.nativePlayer.stop(),this.cleanup()},e.prototype.cleanup=function(){this.alreadyStarted=!1,this.unsubscribers.forEach((function(t){return"function"==typeof t&&t()})),this.unsubscribers=[]},e}(et),Ir=function(t){function e(e){var n=t.call(this)||this;return e?(n.nativePlayer=e,n.id3MetadataOwner=new vr,n.bindEventListeners(),n):n}return _(e,t),e.prototype.bindEventListeners=function(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)},e.prototype.loadCompleteHandler=function(t){w.debug("ChromecastPlayerAdaptor: PLAYER_LOAD_COMPLETE",t),this.emit(br.start)},e.prototype.id3Handler=function(t){var e=this;if(w.debug("ChromecastPlayerAdaptor._id3Handler",t),t.detail&&(t.segmentData=t.detail),t.segmentData){var n=String.fromCharCode.apply(String,M(t.segmentData));w.trace("ChromecastPlayerAdaptor._id3Handler",n);var i=["PRIV","TXXX"].find((function(t){return n.includes(t)}))||null,r=Object.keys(this.id3MetadataOwner).map((function(t){return e.id3MetadataOwner[t]})).find((function(t){return n.includes(t)}))||null,a=r?n.substring(n.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):null,s=new gr(i,r,a);w.trace("ChromecastPlayerAdaptor._id3Handler","tag:",i,"owner:",r,"dataValue:",a),this.emit(br.timedMetadata,s)}},e.prototype.timeUpdateHandler=function(t){var e=t.currentMediaTime;this.emit(br.currentTime,e)},e.prototype.playingHandler=function(t){var e=t.currentMediaTime;this.emit(br.playing,e)},e.prototype.pauseHandler=function(t){var e=t.currentMediaTime;this.emit(br.pause,e)},e.prototype.mediaFinishedHandler=function(t){w.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",t),this.emit(br.stop),this.cleanup()},e.prototype.stop=function(t){t&&w.warn("ChromecastPlayerAdaptor.stop",t.message)},e.prototype.cleanup=function(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))},e}(et),Tr=function(t){function e(e){var n=t.call(this)||this;return n.nativePlayer=e,n.bindEventListeners(),n}return _(e,t),e.prototype.bindEventListeners=function(){var t=this;this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeek=this.onSeek.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.onLoadedMetadata=this.onLoadedMetadata.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeek),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.addEventListener("loadedmetadata",this.onLoadedMetadata),this.nativePlayer.textTracks.onaddtrack=function(e){var n=e.track;n&&"metadata"===n.kind&&n.addEventListener("cuechange",(function(e){var n=e.target;if(n&&"metadata"===n.kind){for(var i=[],r=0;r<n.activeCues.length;r++){var a=n.activeCues[r];i.push(a.value)}i.map((function(e){var n=e.key,i=e.info,r=e.data;r instanceof ArrayBuffer&&(r=String.fromCharCode.apply(null,new Uint8Array(r)));var a=new gr(n,i,r);w.trace("HTML5PlayerAdaptor timedMetadata",a),t.emit(br.timedMetadata,a)}))}}))}):w.error("Native Player wasn't passed to HTML5PlayerAdaptor")},e.prototype.onPlay=function(t){this.emit(br.start,t.timeStamp)},e.prototype.onPause=function(t){this.emit(br.pause,t.timeStamp)},e.prototype.onSeek=function(t){this.emit(br.seeking,t.timeStamp)},e.prototype.onError=function(){this.emit(br.stop),this.cleanup()},e.prototype.onCurrentTime=function(t){this.emit(br.currentTime,t.timeStamp)},e.prototype.onStalled=function(t){this.emit(br.stalled,t.timeStamp)},e.prototype.onLoadedMetadata=function(){var t=this.nativePlayer;this.emit(br.loadedMetadata,{duration:t.duration,videoWidth:t.videoWidth,videoHeight:t.videoHeight})},e.prototype.stop=function(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(br.stop),this.cleanup()},e.prototype.cleanup=function(){this.nativePlayer.removeEventListener("play",this.onPlay),this.nativePlayer.removeEventListener("pause",this.onPause),this.nativePlayer.removeEventListener("error",this.onError),this.nativePlayer.removeEventListener("seeking",this.onSeek),this.nativePlayer.removeEventListener("stalled",this.onStalled),this.nativePlayer.removeEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.removeEventListener("ended",this.stop),this.nativePlayer.removeEventListener("loadedmetadata",this.onLoadedMetadata)},e}(et);!function(t){t.opened="opened",t.playing="playing",t.ended="ended",t.timedMetadata="timedMetadata",t.error="error",t.timeUpdate="timeUpdate",t.stalled="stalled",t.paused="paused",t.seeking="seeking"}(mr||(mr={}));var Sr,_r=mr,Er=function(t){function e(e,n){var i=t.call(this)||this;if(!e)throw new Error("nativePlayer must be supplied");return i.nativePlayer=e,i.bus=n,i.bindEventListeners(),i}return _(e,t),e.prototype.bindEventListeners=function(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on(_r.opened,this.onOpened),this.bus.on(_r.playing,this.onPlaying),this.bus.on(_r.paused,this.onPaused),this.bus.on(_r.timedMetadata,this.onTimedMetadata),this.bus.on(_r.ended,this.onEnded),this.bus.on(_r.error,this.onError),this.bus.on(_r.timeUpdate,this.onTimeUpdate),this.bus.on(_r.stalled,this.onStalled),this.bus.on(_r.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)},e.prototype.onSeeking=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onSeeking",t),this.emit(br.seeking,t)},e.prototype.onStalled=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onStalled",t),this.emit(br.stalled,t)},e.prototype.onTimeUpdate=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onTimeUpdate",t),this.emit(br.currentTime,t)},e.prototype.onError=function(t){w.debug("TrilithiumPlayerAdaptor.onError",t),this.emit(br.stop),this.cleanup()},e.prototype.onEnded=function(){this.emit(br.stop),this.cleanup()},e.prototype.onTimedMetadata=function(t,e,n){var i=e,r=n.toString(),a=U.stringify(N.parse(n.toString("base64"))),s=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;w.debug("TrilithiumPlayerAdaptor.onTimedMetadata "+i+" "+r+" "+s);var o=new gr(i,r,s);this.emit(br.timedMetadata,o)},e.prototype.onOpened=function(t){t&&(w.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(br.start))},e.prototype.onPlaying=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onPlaying",t),this.emit(br.playing,t)},e.prototype.onPaused=function(){var t=this.nativePlayer.currentTime;w.debug("TrilithiumPlayerAdaptor.onPaused",t),this.emit(br.pause,t)},e.prototype.stop=function(t){t&&w.warn("TrilithiumPlayerAdaptor.stop",t.message)},e.prototype.cleanup=function(){this.bus&&(this.bus.off(_r.opened),this.bus.off(_r.playing),this.bus.off(_r.timedMetadata),this.bus.off(_r.ended),this.bus.off(_r.error),this.bus.off(_r.timeUpdate),this.bus.off(_r.stalled))},e}(et),kr=6,Cr=7,Or=11,Mr=12,Dr=(function(t){function e(e){var n=t.call(this)||this;return n.nativePlayer=e,n.id3MetadataOwner=new vr,n}_(e,t),e.prototype.onTimedMetaData=function(t){var e=this,n=t.data,i=String.fromCharCode.apply(null,n),r=["PRIV","TXXX"].find((function(t){return i.includes(t)}))||null,a=Object.keys(this.id3MetadataOwner).map((function(t){return e.id3MetadataOwner[t]})).find((function(t){return i.includes(t)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new gr(r,a,s);w.trace("AampUvePlayerAdapter timedMetadata",o),this.emit(br.timedMetadata,o)},e.prototype.onPlaybackStateChanged=function(t){switch(t.state){case kr:this.emit(br.pause);break;case Cr:this.emit(br.seeking);break;case Mr:case Or:this.emit(br.stop),this.cleanup()}},e.prototype.onPlay=function(){this.emit(br.start)},e.prototype.onCurrentTime=function(t){this.emit(br.currentTime,t.positionMiliseconds)},e.prototype.onError=function(){this.emit(br.stop),this.cleanup()},e.prototype.stop=function(){this.emit(br.stop),this.cleanup()},e.prototype.cleanup=function(){}}(et),new function(t,e){void 0===e&&(e="entitlements"),this.serviceUrl=t,this.entitlementsPath=e}("https://web.archive.org/web/20220907123413/https://tve.dtci.technology","entitlements"));!function(t){t.badToken="badToken",t.other="other"}(Sr||(Sr={}));var Nr=function(){function t(t,e){void 0===e&&(e="entitlements"),this.serviceUrl=t,this.entitlementsPath=e}return t.prototype.getEntitlements=function(t){return k(this,void 0,void 0,(function(){var e,n,i,r,a;return C(this,(function(s){switch(s.label){case 0:e=this.serviceUrl+"/"+this.entitlementsPath,n={user_token:t},i=Object.keys(n).map((function(t){return t+"="+encodeURIComponent(n[t])})).join("&"),r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:i},s.label=1;case 1:return s.trys.push([1,4,,5]),[4,T(e,r)];case 2:return[4,s.sent().json()];case 3:return[2,s.sent()];case 4:return a=s.sent(),console.error("Error retrieving Entitlements from DTCITVEntitlementAPI: "+a),[3,5];case 5:return[2]}}))}))},t.prototype.logout=function(t,e,n){return k(this,void 0,void 0,(function(){var i,r,a,s,o;return C(this,(function(u){switch(u.label){case 0:i=this.serviceUrl+"/affiliates/"+t+"/logout",r={user_token:e},n&&(r.redirect_uri=n),a=Object.keys(r).map((function(t){return t+"="+encodeURIComponent(r[t])})).join("&"),s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:a},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,T(i,s)];case 2:return u.sent(),[2,!0];case 3:return o=u.sent(),console.error("Error logging out of affiliate account DTCITVEntitlementAPI: "+o),[2,!1];case 4:return[2]}}))}))},t.prototype.tokenIsValid=function(t){try{var e=function(t){var e=t.split("."),n=U.stringify(N.parse(e[1]));return JSON.parse(n)}(t);if(!e.exp)return!0;var n=new Date;return!(new Date(1e3*e.exp)<n)}catch(t){return!1}},t}(),Ur=function(t,e){e.setItem("watchsdk.tve_authenticator.state",JSON.stringify(t))},Lr=function(t){u(n,t);var e=h(n);function n(t,r){var a;return i(this,n),(a=e.call(this,t,r)).providerDataSource=new si(r),a}return n}(function(){function t(t,e){this.identityTokenProvider=t,this.locationProvider=e,this.authenticationUrl="https://web.archive.org/web/20220907123413/https://www.espn.com/watch/auth",this.edition="espn-nl-nl",this.storage=localStorage,this.tveAPI=new Nr(Dr.serviceUrl,Dr.entitlementsPath),this.delegate=null,this.providerDataSource=null,window.displayProviderDialog=this.displayProviderDialog.bind(this);try{var n=this.storage.getItem("watchsdk.tve_authenticator.state"),i=JSON.parse(n);this.state_=i||{}}catch(t){}}return Object.defineProperty(t.prototype,"configuration",{get:function(){return this.configuration_},set:function(t){this.configuration_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAuthenticated",{get:function(){return this.state_.isAuthenticated},set:function(t){this.state_.isAuthenticated=t,Ur(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedIdentity",{get:function(){var t,e;return null===(e=null===(t=this.state_.entitlements)||void 0===t?void 0:t.accounts[0])||void 0===e?void 0:e.id},set:function(t){this.state_.authenticatedIdentity=t,Ur(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(t){if(!t)return delete this.state_.authenticatedProvider,void Ur(this.state_,this.storage);this.state_.authenticatedProvider=t,Ur(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"entitlements",{get:function(){return this.state_.entitlements},set:function(t){if(!t)return delete this.state_.entitlements,void Ur(this.state_,this.storage);this.state_.entitlements=t,Ur(this.state_,this.storage)},enumerable:!0,configurable:!0}),t.prototype.checkAuthentication=function(){return k(this,void 0,void 0,(function(){var t,e,n,i=this;return C(this,(function(r){switch(r.label){case 0:return w.debug("TVEAuthenticator.checkAuthentication"),(t=this.identityTokenProvider.getIdentityToken())?(e=this,[4,this.tveAPI.getEntitlements(t)]):[2,I.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:return e.entitlements=r.sent(),this.entitlements?(n=this.entitlements.accounts[0])?(this.isAuthenticated=!(!t||!n),this.authenticatedProvider=new ge(n.affiliate.id,n.affiliate.name,null,null),this.providerDataSource?[2,this.providerDataSource.getProvider(n.affiliate.id,Yn.mvpd).then((function(t){var e=t&&t.images||[],r=e.filter((function(t){return"COLOR_NEGATIVE"===t.type})).map((function(t){return t.href}))[0],a=e.filter((function(t){return"BW_NEGATIVE"===t.type})).map((function(t){return t.href}))[0]||r||e.map((function(t){return t.href}))[0];return i.authenticatedProvider=new ge(t.adobeId||n.affiliate.id,n.affiliate.name,a,t.websiteUrl),i.isAuthenticated})).catch((function(){return i.isAuthenticated}))]:[2,I.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,I.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,I.reject(new Error("TVEAuthenticator.NotEntitled"))])}}))}))},t.prototype.authenticate=function(t){var e=this,n=this.providerId,i=this.accessType,r=this.edition,a=t&&t.redirectUrl||window.location.href,s=this.identityTokenProvider.getIdentityToken();return new I((function(t){var o;if(e.resolveAuthenticate_=function(e){t(e)},!n)return e.redirectUrl=a,e.displayProviderDialog(),I.resolve(!1);var u=null===(o=e.locationProvider.getCountryCode())||void 0===o?void 0:o.toLowerCase(),c={mvpd:n,redirectUrl:a,country:u};r&&(c["edition-view"]=r),i&&(c.accessType=i);var d=Object.keys(c).map((function(t){return t+"="+encodeURIComponent(c[t])})).join("&"),l=-1===e.authenticationUrl.indexOf("?")?"?":"&",h=""+e.authenticationUrl+l+d;s&&(h=h+"#oneIdToken="+s),window.location.href=h}))},t.prototype.deauthenticate=function(){var t=this.entitlements.accounts[0].affiliate.id,e=this.identityTokenProvider.getIdentityToken();return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.entitlements=null,e?this.tveAPI.logout(t,e,null).catch((function(){return!0})):I.resolve(!0)},t.prototype.checkAuthorization=function(){return k(this,void 0,void 0,(function(){var t,e,n,i,r,a;return C(this,(function(s){switch(s.label){case 0:return(t=this.identityTokenProvider.getIdentityToken())?this.isAuthenticated?this.entitlements&&this.tveAPI.tokenIsValid(this.entitlements.token)?[3,2]:(e=this,[4,this.tveAPI.getEntitlements(t)]):[2,I.reject(new Error("TVEAuthenticator.AuthenticationRequired"))]:[2,I.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:e.entitlements=s.sent(),s.label=2;case 2:return this.entitlements&&this.tveAPI.tokenIsValid(this.entitlements.token)?((a={})[Pe.CustomDataKey.token]=this.entitlements.token,a[Pe.CustomDataKey.tokenType]="JWT",n=a,i=new Pe(Ct.mvpd,this.authenticatedProvider,this.authenticatedIdentity,n),r=new we(!0,i),[2,I.resolve(r)]):[2,I.reject(new Error("TVEAuthenticator.NotEntitled"))]}}))}))},t.prototype.displayProviderDialog=function(){var t=this;w.debug("TVEAuthenticator.displayProviderDialog"),this.providerDataSource&&this.providerDataSource.getProviders().then((function(e){t.delegate&&t.delegate.selectProvider&&t.delegate.selectProvider(e)}))},t.prototype.setProvider=function(t,e){var n=this;w.debug("TVEAuthenticator.setProvider"),this.providerId=t,this.accessType=e,this.authenticate({redirectUrl:this.redirectUrl}).then((function(){n.resolveAuthenticate_&&(n.resolveAuthenticate_(n.isAuthenticated),n.resolveAuthenticate_=null)}))},t.defaultConfiguration=Dr,t}()),jr=function(t){u(n,t);var e=h(n);function n(){return i(this,n),e.call(this)}return n}(tt),Rr=function(){function t(e,n){i(this,t),this.playerAdaptor=e,this.mediaItem=n,this._currentContentType=null,this._currentAdId=null,this._lastHeartbeatTime=null,this._initialHeartbeatTimer=null,this._heartbeatTimer=null,this._currentPlayerTime=0,this._initialPlayerTime=null,this._isPlaying=!1,this._handleStart=this._handleStart.bind(this),this.playerAdaptor.on(br.start,this._handleStart),this._handlePlaying=this._handlePlaying.bind(this),this.playerAdaptor.on(br.playing,this._handlePlaying),this._handlePaused=this._handlePaused.bind(this),this.playerAdaptor.on(br.pause,this._handlePaused),this.playerAdaptor.on(br.stalled,this._handlePaused),this.playerAdaptor.on(br.seeking,this._handlePaused),this._handlePlayerCurrentTime=this._handlePlayerCurrentTime.bind(this),this.playerAdaptor.on(br.currentTime,this._handlePlayerCurrentTime),this._handleTimedMetadata=this._handleTimedMetadata.bind(this),this.playerAdaptor.on(br.timedMetadata,this._handleTimedMetadata),this._handleStop=this._handleStop.bind(this),this.playerAdaptor.on(br.stop,this._handleStop)}return a(t,[{key:"currentContentType",get:function(){return this._currentContentType},set:function(t){if(this._currentContentType!==t){var e=this._currentContentType;this._currentContentType=t;var n=this._currentPlayerTime;e||(n=this._initialPlayerTime||0),this.onContentTypeChanged&&this.onContentTypeChanged(t,e,n,this._currentAdId)}}},{key:"onContentTypeChanged",value:function(t,e,n,i){}},{key:"stop",value:function(){this.playerAdaptor.off(br.start),this.playerAdaptor.off(br.playing),this.playerAdaptor.off(br.pause),this.playerAdaptor.off(br.stalled),this.playerAdaptor.off(br.seeking),this.playerAdaptor.off(br.timedMetadata),this.playerAdaptor.off(br.currentTime),this.playerAdaptor.off(br.stop)}},{key:"_handleStart",value:function(){if(w.debug("AdBreakMonitor._handleStart"),!0!==this.mediaItem.source.hasEspnId3Heartbeats)return w.debug("AdBreakMonitor._handleStart hasEspnId3Heartbeats !== true, setting currentContentType to content.",this._currentPlayerTime,this._initialPlayerTime,this.mediaItem.source.hasEspnId3Heartbeats),void(this.currentContentType=t.ContentType.content);this._scheduleInitialHeartbeatTimer()}},{key:"_handlePlaying",value:function(){this._isPlaying=!0}},{key:"_handlePaused",value:function(){this._isPlaying=!1}},{key:"_handleTimedMetadata",value:function(t){if(!0===this.mediaItem.source.hasEspnId3Heartbeats&&t.tag===lr.priv&&t.owner===vr.heartbeat){w.debug("AdBreakMonitor._handleTimedMetadata",JSON.stringify(t));var e=function(t){var e;try{e=JSON.parse(t.dataValue)}catch(t){return null}return e.length?e.map((function(t){return new yr(t.type,t.id)})):null}(t);e&&this._handleHeartbeats(e)}}},{key:"_handlePlayerCurrentTime",value:function(t){var e=Math.floor(t);null===this._initialPlayerTime&&(this._initialPlayerTime=e),this._currentPlayerTime=e}},{key:"_handleStop",value:function(){this._invalidateInitialHeartbeatTimer(),this._invalidateHeartbeatTimer()}},{key:"_handleHeartbeats",value:function(e){w.debug("AdBreakMonitor._handleHeartbeats",JSON.stringify(e)),this._invalidateInitialHeartbeatTimer(),this._lastHeartbeatTime=Date.now();var n=e.every((function(t){return t.isContent}))?t.ContentType.content:t.ContentType.ad;n===t.ContentType.ad&&(this._currentAdId=function(t){return t.find((function(t){return t.type===hr.commercial&&null!==t.id}))||null}(e)),this.currentContentType=n,this._scheduleHeartbeatTimer()}},{key:"_scheduleInitialHeartbeatTimer",value:function(){var t=this;w.debug("AdBreakMonitor._scheduleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),this._initialHeartbeatTimer=setInterval((function(){t._handleInitialHeartbeatTimer()}),15e3)}},{key:"_invalidateInitialHeartbeatTimer",value:function(){this._initialHeartbeatTimer&&(clearInterval(this._initialHeartbeatTimer),this._initialHeartbeatTimer=null)}},{key:"_handleInitialHeartbeatTimer",value:function(){if(w.debug("AdBreakMonitor._handleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),!1!==this._isPlaying){if(!this.currentContentType){var e=t.ContentType.ad;this._currentAdId="1",this.currentContentType=e}}else this._scheduleInitialHeartbeatTimer()}},{key:"_scheduleHeartbeatTimer",value:function(){var t=this;this._invalidateHeartbeatTimer(),this._heartbeatTimer=setInterval((function(){t._handleHeartbeatTimer()}),1e4)}},{key:"_invalidateHeartbeatTimer",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:"_handleHeartbeatTimer",value:function(){var e=Date.now();if(w.debug("AdBreakMonitor._handleHeartbeatTimer"),!1!==this._isPlaying){if(this._lastHeartbeatTime&&e-this._lastHeartbeatTime>2e4){w.debug("AdBreakMonitor._handleHeartbeatTimer [now - this._lastHeartbeatTime]: ",e-this._lastHeartbeatTime);var n=t.ContentType.ad;this._currentAdId="1",this.currentContentType=n}this._scheduleHeartbeatTimer()}else this._scheduleHeartbeatTimer()}}]),t}();Rr.ContentType={ad:"ad",content:"content"};var xr={production:"PROD",testing:"TESTING"},Br={};Br[xr.production]="https://web.archive.org/web/20220907123413/https://cloudapi.imrworldwide.com/nmapi/v2",Br[xr.testing]="https://web.archive.org/web/20220907123413/https://sandbox-cloudapi.imrworldwide.com/nmapi/v2";var Fr=function(){function t(e,n,r,a,s){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:xr.production;i(this,t);var u=e instanceof t.Configuration||e===Object(e)?e:new t.Configuration(e,n,r,a,s,o);w.debug("NielsenCloudAPIClient.constructor",JSON.stringify(u)),this.configuration=u,this.sessionId=Z()}return a(t,[{key:"configuration",get:function(){return this._configuration},set:function(t){t&&(this.appId=t.appId,this.devInfo={devId:!1===t.isOptOut?t.deviceId:"",apn:t.appName,apv:"".concat(t.appVersion),uoo:"".concat(t.isOptOut)},this.env=t.environment,this._configuration=t)}},{key:"sendEvent",value:function(t,e,n,i,r){var a={devInfo:this.devInfo,metadata:{},event:t,position:isNaN(e)||null===e?"".concat(e):"".concat(Math.floor(e)),type:n,utc:"".concat(Date.now())};i&&(a.metadata.content=i.tracking[wt.nielsen]),n===Rr.ContentType.ad&&(a.metadata.ad=r);var s="".concat(Br[this.env],"/").concat(this.appId,"/").concat(this.sessionId,"/a?b=").concat(encodeURIComponent(JSON.stringify(a)));w.debug("NielsenCloudAPIClient.sendEvent url:",s),w.debug("NielsenCloudAPIClient.sendEvent payload:",JSON.stringify(a)),T(s).then((function(t){w.debug("NielsenCloudAPIClient.sendEvent response.status: ".concat(t.status))})).catch((function(t){w.warn("NielsenCloudAPIClient.sendEvent response.error: ".concat(t&&t.message))}))}},{key:"closeSession",value:function(){this.sendEvent(t.EventType.delete,"","",null,null)}}]),t}();Fr.AssetType={content:"content",ad:"ad"},Fr.EventType={playhead:"playhead",complete:"complete",delete:"delete"},Fr.Environment=xr,Fr.Configuration=function t(e,n,r,a,s,o){i(this,t),this.appId=e,this.appName=n,this.appVersion=r,this.deviceId=a,this.isOptOut=s,this.environment=o};var Hr=function(){function t(e,n,r){var a=this;i(this,t),this.cloudAPIClient=e,this.playerAdaptor=n;var s=he.fromObject(r)||r;if(s.entityType===It.airing){this.mediaItem=s,this.currentPlayerTime=null,this.lastContentBeaconTime=null,this._isPlayerPlaying=!1,this.playerAdaptor.on(br.playing,(function(t){if(w.debug("NielsenTrackingManager PlayerAdaptorEvent.playing"),t){var e=Math.floor(t);a.currentPlayerTime=e}a.isPlayerPlaying=!0})),this.playerAdaptor.on(br.seeking,(function(){w.debug("NielsenTrackingManager PlayerAdaptorEvent.seeking"),a.isPlayerPlaying=!1})),this.playerAdaptor.on(br.pause,(function(){w.debug("NielsenTrackingManager PlayerAdaptorEvent.pause"),a.isPlayerPlaying=!1})),this.playerAdaptor.on(br.currentTime,(function(t){var e=Math.floor(t);a.currentPlayerTime=e;var n=a.currentContentType;if(n&&a.isPlayerPlaying){var i=e-a.currentContentStartTime;0!==i&&i%10==0&&e!==a.lastContentBeaconTime&&e>a.lastContentBeaconTime&&(a.lastContentBeaconTime=e,w.debug("NielsenTrackingManager PlayerAdaptorEvent.currentTime sending playhead 10 second beacon",e),a._sendPlayheadEvent(n,e))}})),this.playerAdaptor.on(br.stop,(function(){a.stop()})),this.currentContentType=null,this.currentContentStartTime=0,this.totalAdTime=0,this.currentAdInfo=null;var o=new Rr(n,r);o.onContentTypeChanged=function(t,e,n){if(w.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged from",e,"to",t),e){w.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead before contentType change");var i=a._getPlayheadPosition(e,n,!0);a.cloudAPIClient.sendEvent(Fr.EventType.playhead,i,e,a.mediaItem,a.currentAdInfo)}w.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead after contentType change");var r=e&&!a.mediaItem.isLive?0:a._getPlayheadPosition(t,n),s=t===Rr.ContentType.ad?{assetid:"1",type:0===r?"preroll":"midroll"}:null;a.cloudAPIClient.sendEvent(Fr.EventType.playhead,r,t,a.mediaItem,s),a.currentContentType=t,a.currentContentStartTime=n,a.currentAdInfo=s,a.lastContentBeaconTime=n},this.adBreakMonitor=o}}return a(t,[{key:"mediaItem",get:function(){return this._mediaItem},set:function(t){if(this._mediaItem){this._sendPlayheadEventForCurrentPlayerTimeAndContentType();var e=this._getPlayheadPosition(Rr.ContentType.content,this.currentPlayerTime);w.debug("NielsenTrackingManager setMediaItem sending complete"),this.cloudAPIClient.sendEvent(Fr.EventType.complete,e,Fr.AssetType.content,this._mediaItem)}this._mediaItem=t,this.adBreakMonitor&&(this.adBreakMonitor.mediaItem=t)}},{key:"isPlayerPlaying",get:function(){return this._isPlayerPlaying},set:function(t){t!==this._isPlayerPlaying&&(this._isPlayerPlaying=t,this._sendPlayheadEventForCurrentPlayerTimeAndContentType())}},{key:"stop",value:function(){this.playerAdaptor.off(br.currentTime),this.playerAdaptor.off(br.stop),this.adBreakMonitor&&this.adBreakMonitor.stop(),this.mediaItem=null}},{key:"_getPlayheadPosition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.mediaItem.isLive)return Math.floor(Date.now()/1e3);if(t===Rr.ContentType.ad){if(n){var i=e-this.currentContentStartTime;return this.totalAdTime+=i,i}return 0}return e-this.totalAdTime}},{key:"_sendPlayheadEventForCurrentPlayerTimeAndContentType",value:function(){var t=this.currentPlayerTime,e=this.currentContentType;e&&t!==this.lastContentBeaconTime&&t>this.lastContentBeaconTime&&(this.lastContentBeaconTime=t,w.debug("NielsenTrackingManager _sendPlayheadEventForCurrentPlayerTimeAndContentType sending playhead beacon",t),this._sendPlayheadEvent(e,t))}},{key:"_sendPlayheadEvent",value:function(t,e){var n=e-this.currentContentStartTime,i=t!==Rr.ContentType.ad||this.mediaItem.isLive?this._getPlayheadPosition(t,e):n,r=t===Rr.ContentType.ad?this.currentAdInfo:null;this.cloudAPIClient.sendEvent(Fr.EventType.playhead,i,t,this.mediaItem,r)}}]),t}(),zr=function(){function t(t,e){this.delegate=t,this.config=e,this.didFirstPlay=!1,this.didFirstPlayOfContent=!1}return t.prototype.setMediaItem=function(t){this.mediaItem=t,this.didFirstPlayOfContent=!1},t.prototype.firstPlay=function(t){this.didFirstPlay=!0},t.prototype.firstPlayOfContent=function(t){this.didFirstPlayOfContent=!0},t.prototype.play=function(t){this.didFirstPlay||this.firstPlay(t),this.didFirstPlayOfContent||this.firstPlayOfContent(t)},t.prototype.loadedMetadata=function(t){},t.prototype.pause=function(t){},t.prototype.complete=function(t){},t.prototype.seek=function(t){},t.prototype.release=function(t){},t.prototype.progressChange=function(t){},t.prototype.buffer=function(t){},t.prototype.error=function(t){},t.prototype.adBreakStart=function(t){},t.prototype.adBreakEnd=function(t){},t.prototype.dispose=function(){this.delegate=null,this.config=null,this.mediaItem=null},t}(),Kr={PLAY:br.start,PLAYING:br.playing,PAUSE:br.pause,COMPLETE:"complete",LOADED_METADATA:"loadedMetadata",SEEK:"seeked",RELEASE:"dispose",PROGRESS_CHANGE:br.currentTime,BUFFER:"buffer",ERROR:"error",AD_BREAK_START:"adBreakStart",AD_BREAK_END:"adBreakEnd"};function Vr(t){return t&&"object"==typeof t&&"timeStamp"in t?t.timeStamp:parseInt(t,10)}var Gr=function(){function t(t,e,n){this.playerAdaptor=t,this.plugins=[],this.config=n,this.play=this.play.bind(this),this.playing=this.playing.bind(this),this.loadedMetadata=this.loadedMetadata.bind(this),this.pause=this.pause.bind(this),this.complete=this.complete.bind(this),this.seek=this.seek.bind(this),this.release=this.release.bind(this),this.progressChange=this.progressChange.bind(this),this.buffer=this.buffer.bind(this),this.error=this.error.bind(this),this.adBreakStart=this.adBreakStart.bind(this),this.adBreakEnd=this.adBreakEnd.bind(this),this.addPlugins(e),this.bindEventListeners()}return t.prototype.setMediaItem=function(t){this.callOnPlugins("setMediaItem",t)},t.prototype.addPlugins=function(t){var e=this;t&&t.length&&t.forEach((function(t){return e.addPlugin(t)}))},t.prototype.addPlugin=function(t){var e;e=t instanceof zr||t.delegate?t:new t(this.playerAdaptor,this.config),this.plugins.push(e)},t.prototype.play=function(t){this.callOnPlugins("play",Vr(t))},t.prototype.playing=function(t){this.callOnPlugins("playing",Vr(t))},t.prototype.pause=function(t){this.callOnPlugins("pause",Vr(t))},t.prototype.complete=function(t){this.callOnPlugins("complete",Vr(t))},t.prototype.loadedMetadata=function(t){this.callOnPlugins("loadedMetadata",t)},t.prototype.seek=function(t){this.callOnPlugins("seek",Vr(t))},t.prototype.release=function(t){this.callOnPlugins("release",Vr(t))},t.prototype.progressChange=function(t){this.callOnPlugins("progressChange",Vr(t))},t.prototype.buffer=function(t){this.callOnPlugins("buffer",Vr(t))},t.prototype.error=function(t){this.callOnPlugins("error",Vr(t))},t.prototype.adBreakStart=function(t){this.callOnPlugins("adBreakStart",Vr(t))},t.prototype.adBreakEnd=function(t){this.callOnPlugins("adBreakEnd",Vr(t))},t.prototype.bindEventListeners=function(){this.playerAdaptor.on(Kr.PLAY,this.play),this.playerAdaptor.on(Kr.PLAYING,this.playing),this.playerAdaptor.on(Kr.PAUSE,this.pause),this.playerAdaptor.on(Kr.COMPLETE,this.complete),this.playerAdaptor.on(Kr.LOADED_METADATA,this.loadedMetadata),this.playerAdaptor.on(Kr.SEEK,this.seek),this.playerAdaptor.on(Kr.RELEASE,this.release),this.playerAdaptor.on(Kr.PROGRESS_CHANGE,this.progressChange),this.playerAdaptor.on(Kr.BUFFER,this.buffer),this.playerAdaptor.on(Kr.ERROR,this.error),this.playerAdaptor.on(Kr.AD_BREAK_START,this.adBreakStart),this.playerAdaptor.on(Kr.AD_BREAK_END,this.adBreakEnd)},t.prototype.unbindEventListeners=function(){this.playerAdaptor.off(Kr.PLAY,this.play),this.playerAdaptor.off(Kr.PLAYING,this.playing),this.playerAdaptor.off(Kr.PAUSE,this.pause),this.playerAdaptor.off(Kr.COMPLETE,this.complete),this.playerAdaptor.off(Kr.LOADED_METADATA,this.loadedMetadata),this.playerAdaptor.off(Kr.SEEK,this.seek),this.playerAdaptor.off(Kr.RELEASE,this.release),this.playerAdaptor.off(Kr.PROGRESS_CHANGE,this.progressChange),this.playerAdaptor.off(Kr.BUFFER,this.buffer),this.playerAdaptor.off(Kr.ERROR,this.error),this.playerAdaptor.off(Kr.AD_BREAK_START,this.adBreakStart),this.playerAdaptor.off(Kr.AD_BREAK_END,this.adBreakEnd)},t.prototype.callOnPlugins=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.plugins.forEach((function(n){if("function"==typeof n[t])try{n[t].apply(n,e)}catch(t){w.error(t)}}))},t.prototype.dispose=function(){this.unbindEventListeners(),this.plugins.forEach((function(t){return t.dispose()})),this.plugins=null,this.playerAdaptor=null,this.config=null},t}();const qr={callback:(...t)=>{w.trace(t)}};var Jr;(Jr=t.QueueMode||(t.QueueMode={})).first="first",Jr.last="last",Jr.all="all";const Yr={maxAttempts:3,persistSession:!0,retryTimeout:6e4,SESSION_KEY_PREFIX:"ResilientRemoteStorage",queueMode:t.QueueMode.all};const Wr={Accept:"application/json","Cache-Control":"no-cache","Content-Type":"application/json",Pragma:"no-cache"},Qr={swid:null,bu:null,contentSource:null,s2:null,source:null,endpointTemplate:"https://web.archive.org/web/20220907123413/https://fan.core.api.espn.com/apis/v2/progress/{{SWID}}/{{BUSINESS_UNIT}}/{{CONTENT_SOURCE}}/{{CONTENT_ID}}",completePercentThreshold:97,fetchCredentials:"include"},Xr={espn:0,marvel:2},Zr={espn:{longform:0}};var $r,ta,ea,na;!function(t){t.willStartPlaying="atv.player.willStartPlaying",t.didStopPlaying="atv.player.didStopPlaying",t.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",t.playerStateChanged="atv.player.playerStateChanged",t.playerTimeDidChange="atv.player.playerTimeDidChange"}($r||($r={})),function(t){t.priv="PRIV",t.txxx="TXXX"}(ta||(ta={})),function(t){t.program="PROGRAM",t.commercial="COMMERCIAL",t.slate="SLATE"}(ea||(ea={})),function(t){t.start="start",t.playing="playing",t.pause="pause",t.seeking="seeking",t.stalled="stalled",t.stop="stop",t.timedMetadata="timedMetadata",t.currentTime="currentTime",t.loadedMetadata="loadedMetadata"}(na||(na={}));var ia,ra=na;!function(t){t.opened="opened",t.playing="playing",t.ended="ended",t.timedMetadata="timedMetadata",t.error="error",t.timeUpdate="timeUpdate",t.stalled="stalled",t.paused="paused",t.seeking="seeking"}(ia||(ia={}));ra.start,ra.playing,ra.pause,ra.currentTime;const aa={interval:15e3,debounce:250,minimumProgressBeforeTrack:30},sa=()=>{};t.AdobeConcurrencyMonitorBuilder=Pn,t.AdvertisingInfo=Ue,t.AtvlPlayerAdaptor=wr,t.AtvlPlayerEvent=pr,t.AtvlPlayerEventBus=jr,t.AuthenticationManager=hi,t.AuthenticationType=Ct,t.BAMTizenPlayerAdaptor=Ar,t.BootstrappedESPNAffiliateAPI=si,t.CallbackStorage=class{constructor(t){this.config=Object.assign(Object.assign({},qr),t)}setMediaItem(t){this.mediaItem=t,this.videoId=String(t.id),this.sourceId=this.config.sourceId}saveProgress(t,e){const{config:{callback:n},videoId:i,sourceId:r,mediaItem:a}=this;return I.resolve().then(()=>n(i,t,r,e,a))}dispose(){this.config=null,this.mediaItem=null}},t.ChromecastPlayerAdaptor=Ir,t.Client=lt,t.DRMKeySystem=yn,t.DRMSupport=gn,t.DTCITVEntitlementAPI=Nr,t.DomesticLocationProvider=ai,t.DrmSupport=gn,t.FanManager=qn,t.FuseStorage=class extends class{constructor(t){var e;this.failedAttempts=0,this.maxAttempts=NaN,this.paused=!1,this.queuedFetchArgs=[],this.waitForResume_=null,this.resumeTimeout_=null,this.retryTimestamp_=NaN,this.config=Object.assign(Object.assign({},Yr),t);const{config:{maxAttempts:n,persistSession:i,SESSION_KEY_PREFIX:r,queueMode:a}}=this,s=null===(e=null==this?void 0:this.constructor)||void 0===e?void 0:e.name;this.queueMode=a,this.maxAttempts=n,this.storageKey=`${r}${s?"-"+s:""}`,i&&this.persistSession()}persistSession(){let t;try{const e=sessionStorage.getItem(this.storageKey);t=JSON.parse(e)}catch(t){}if(t){const{failedAttempts:e,retryTimestamp_:n,queuedFetchArgs:i}=t;if(this.queuedFetchArgs=i,this.failedAttempts=e,this.failedAttempts>=this.maxAttempts&&n>0){const t=Math.max(n-+new Date,0);this.pauseFetching(t),i&&i.length&&this.drainQueueWhenResumed()}}try{this.saveSession=this.saveSession.bind(this),window.addEventListener("beforeunload",this.saveSession)}catch(t){}}clearSession(){try{sessionStorage.setItem(this.storageKey,"")}catch(t){}}pauseFetching(t){const e=t||this.config.retryTimeout;this.waitForResume_||(this.retryTimestamp_=+new Date+e,this.waitForResume_=new I(t=>{this.resumeTimeout_=setTimeout(()=>{this.waitForResume_=null,this.failedAttempts=0,this.retryTimestamp_=NaN,t(!0)},e)}))}drainQueueWhenResumed(){return this.waitForResume_.then(()=>{const{queuedFetchArgs:t}=this;return this.queuedFetchArgs=[],I.all(t.map(({url:t,params:e},n)=>new I(i=>{setTimeout(()=>{this.resilientFetch(t,e).then(i).catch(i)},10*n)})))})}resilientFetch(e,n){return new I(i=>{if(this.waitForResume_){const r={url:e,params:n};return this.queueMode===t.QueueMode.all?this.queuedFetchArgs.push(r):(this.queueMode===t.QueueMode.first&&!this.queuedFetchArgs.length||this.queueMode===t.QueueMode.last)&&(this.queuedFetchArgs[0]=r),this.drainQueueWhenResumed().then(i)}T(e,n).then(t=>t&&"ok"in t&&!t.ok?I.reject(new Error("Endpoint failed to save progress")):(this.failedAttempts=0,t)).then(i).catch(t=>(this.failedAttempts+=1,this.failedAttempts>=this.maxAttempts&&this.pauseFetching(),w.error(t),this.resilientFetch(e,n).then(i)))})}saveSession(){if(this.config.persistSession)try{sessionStorage.setItem(this.storageKey,JSON.stringify({queuedFetchArgs:this.queuedFetchArgs||[],retryTimestamp_:this.retryTimestamp_||NaN,failedAttempts:this.failedAttempts}))}catch(t){}}dispose(){this.config.persistSession&&this.saveSession(),clearTimeout(this.resumeTimeout_),this.config=null}}{constructor(t,e){super(Object.assign(Object.assign({},Qr),t)),this.fan=e,this.handleFuseResponse=this.handleFuseResponse.bind(this)}setMediaItem(t){var e;const{config:{contentSource:n,bu:i,s2:r,swid:a,source:s,fetchCredentials:o},fan:u}=this,{id:c,brand:d,entityType:l}=t;this.mediaItem=t,this.contentId=String(c),this.businessUnit=null!==i?i:Xr[d],this.contentSource=null!==n?n:null===(e=null==Zr?void 0:Zr[d])||void 0===e?void 0:e[l],this.swid=null!==a?a:null==u?void 0:u.id,this.s2=r,this.source=s,this.fetchCredentials=o,this.updateApiEndpoint_()}updateApiEndpoint_(){const{config:{endpointTemplate:t},swid:e,businessUnit:n,contentSource:i,contentId:r}=this;let a=t;e&&"{"===e[0]&&(a=a.replace("{{SWID}}",encodeURIComponent(e))),null!==n&&(a=a.replace("{{BUSINESS_UNIT}}",n)),null!==i&&(a=a.replace("{{CONTENT_SOURCE}}",i)),r&&(a=a.replace("{{CONTENT_ID}}",r)),this.apiEndpoint=a}computeCompleted(t,e,n){const{config:{completePercentThreshold:i}}=this;return e>=i}hideProgress(t,e){return this.updateProgress(t,e,!0)}saveProgress(t,e){return this.updateProgress(t,e,!1)}updateProgress(t,e,n){var i,r;const{apiEndpoint:a,businessUnit:s,contentId:o,contentSource:u,mediaItem:c,s2:d,source:l,swid:h}=this,p=null===(r=null===(i=null==c?void 0:c.tracking)||void 0===i?void 0:i.heartbeats)||void 0===r?void 0:r["a.media.asset"],f=[];-1!==String(a).indexOf("{{")&&f.push("Missing required metadata, cannot determine endpoint");const v={id:h,bu:s,contentId:o,contentSource:u,complete:this.computeCompleted(t,e,c),progress:t,seriesId:p,source:l,hidden:n};for(const t in v){const e=v[t];null==e&&f.push(`Required payload param '${t}' not set`)}if(f.length)return I.reject(new Error(f.map(t=>t).join("\n")));let y=Wr,{fetchCredentials:g}=this;return d&&(y=Object.assign(Object.assign({},y),{Cookie:"espn_s2="+d}),g="omit"),this.fetch(a,{method:"PUT",mode:"cors",cache:"no-cache",credentials:g,headers:y,body:JSON.stringify(v)}).then(t=>(null==t?void 0:t.json)&&t.json()).then(this.handleFuseResponse)}fetch(t,e){return this.resilientFetch(t,e)}handleFuseResponse(t){return t}dispose(){this.config=null,this.mediaItem=null}},t.HTML5PlayerAdaptor=Tr,t.LocationProvider=ri,t.MediaItemAPI=pe,t.MediaItemAuthenticationType=Ct,t.MediaItemSourceType=Ot,t.MediaItemTrackingType=wt,t.NielsenCloudAPIClient=Fr,t.NielsenTrackingManager=Hr,t.PlaybackConfig=pn,t.PlaybackCoordinator=cr,t.PlaybackManager=dr,t.PlayerEventBus=jr,t.PlayerPlugin=zr,t.PlayerPluginManager=Gr,t.ProgressTracker=class extends class{constructor(t,e){this.delegate=t,this.config=e,this.didFirstPlay=!1,this.didFirstPlayOfContent=!1}setMediaItem(t){this.mediaItem=t,this.didFirstPlayOfContent=!1}firstPlay(t){this.didFirstPlay=!0}firstPlayOfContent(t){this.didFirstPlayOfContent=!0}play(t){this.didFirstPlay||this.firstPlay(t),this.didFirstPlayOfContent||this.firstPlayOfContent(t)}loadedMetadata(t){}pause(t){}complete(t){}seek(t){}release(t){}progressChange(t){}buffer(t){}error(t){}adBreakStart(t){}adBreakEnd(t){}dispose(){this.delegate=null,this.config=null,this.mediaItem=null}}{constructor(t,e){super(t,Object.assign(Object.assign({},aa),e)),this.debouncedSaveProgress_=sa,this.throttledSaveProgress_=sa,this.contentDuration=NaN,this.storages=[],this.activeStorages=[],this.doDebouncedSaveProgress_=function(t,e,n,i){let r;return function(...a){const s=n&&!r;clearTimeout(r),r=setTimeout(()=>{r=null,n||t.apply(i,a)},e),s&&t.apply(i,a)}}(this.saveProgress,this.config.debounce,!1,this),this.doThrottledSaveProgress_=function(t,e,n){let i;return function(...r){i||(t.apply(n,r),i=!0,setTimeout(()=>{i=!1},e))}}(this.doDebouncedSaveProgress_,this.config.interval,this),this.progressChange=sa}setMediaItem(t){super.setMediaItem(t),this.contentDuration=NaN,this.pauseTracking(),this.selectStorages_()}setStorage(t,e){this.storages.push({storage:t,rule:e}),this.mediaItem&&this.selectStorages_()}selectStorages_(){const{storages:t,mediaItem:e}=this,n=t.length,i=[];for(let r=0;r<n;r++){const{storage:n,rule:a}=t[r];a(n,e)&&(n.setMediaItem(e),i.push(n))}this.activeStorages=i}firstPlayOfContent(t){super.firstPlayOfContent(t),0===this.config.minimumProgressBeforeTrack&&this.resumeTracking()}loadedMetadata(t){const e=null==t?void 0:t.duration;e&&this.setContentDuration(e)}setContentDuration(t){this.contentDuration=t}play(t){super.play(t),this.debouncedSaveProgress_(t)}pause(t){this.debouncedSaveProgress_(t)}complete(t){this.debouncedSaveProgress_(t,!0)}seek(t){this.debouncedSaveProgress_(t)}release(t){this.debouncedSaveProgress_(t)}pausedProgressChange(t){const{config:{minimumProgressBeforeTrack:e},didFirstPlayOfContent:n}=this;0!==e&&t>=e&&n&&(this.resumeTracking(),this.debouncedSaveProgress_(t))}resumedProgressChange(t){this.throttledSaveProgress_(t)}buffer(t){this.debouncedSaveProgress_(t)}adBreakStart(t){this.debouncedSaveProgress_(t),this.pauseTracking()}adBreakEnd(t){this.resumeTracking(),this.debouncedSaveProgress_(t)}pauseTracking(){this.debouncedSaveProgress_=this.throttledSaveProgress_=sa,this.progressChange=this.pausedProgressChange}resumeTracking(){this.debouncedSaveProgress_=this.doDebouncedSaveProgress_,this.throttledSaveProgress_=this.doThrottledSaveProgress_,this.progressChange=this.resumedProgressChange}saveProgress(t,e){const{mediaItem:n,activeStorages:i,contentDuration:r}=this,a=r||(null==n?void 0:n.duration);if(t>-1&&i.length){let n,r;r=!0===e?100:a>0&&t>=0?parseFloat(String(t))/parseFloat(String(a))*100:NaN,n=i.length?I.all(i.map(e=>new I(n=>{let i;try{i=e.saveProgress(t,r).then(n)}catch(t){w.error(t),i=I.resolve()}return i}))):I.reject("No storages available"),n.catch(t=>{w.error(t)})}}dispose(){super.dispose(),this.storages.forEach(({storage:t})=>t.dispose()),this.storages=[],this.activeStorages=[],this.mediaItem=null,this.throttledSaveProgress_=null,this.debouncedSaveProgress_=null}},t.ShieldAPI=kn,t.TVEAuthenticator=Lr,t.TokenAuthenticator=Qe,t.TrilithiumPlayerAdaptor=Er,t.TrilithiumPlayerEvent=_r,t.log=A,t.uuid=Z,Object.defineProperty(t,"__esModule",{value:!0})}));


}
/*
     FILE ARCHIVED ON 12:34:13 Sep 07, 2022 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 01:16:42 Jul 19, 2023.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  captures_list: 73.044
  exclusion.robots: 0.061
  exclusion.robots.policy: 0.054
  cdx.remote: 0.054
  esindex: 0.008
  LoadShardBlock: 44.196 (3)
  PetaboxLoader3.datanode: 149.563 (5)
  load_resource: 283.353 (2)
  PetaboxLoader3.resolve: 150.345 (2)
*/